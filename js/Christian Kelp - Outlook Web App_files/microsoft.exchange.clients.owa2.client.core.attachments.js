try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.$1KD=function(n,t,i,r){_at.$1KD.initializeBase(this);this.$6B=n;this.$1dN=t;this.$3W=i;this.$ND=r};_at.$1KD.prototype={$1dN:null,$3W:null,$ND:null,$6B:null,$3LQ:null,$6au:function(n){var t=new _g.$1KE(this.$2Y);n.$65R(this.$6B,this.$1dN,this.$3W,this.$ND,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){try{_a.$4.$1q(n,"result");this.$3LQ=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.$$cctor=function(){_a.$v.get_$P().$q(AttachmentsComponent)};AttachmentsComponent.prototype={$2ki:function(n,t,i){if(t.get_$8q()){var f=this;n.$q(_at.$Zo,function(){var t=_bc.$Sq.isInstanceOfType(_g.$1R.$1M)?_g.$1R.$1M:null;return new _at.$4f(n.$1(_a.$35),t?t.get_$4y().get_$2JH():null,t?t.get_$AQU():null)}).$1J()}else{var e=this;n.$q(_at.$Zo,function(){return new _at.$1Wt}).$1J()}var r=this;n.$q(IAttachmentViewModelFactory,function(){return new _at.$1IM(n.$1(IInferenceTracker),n.$1(_y.$R),n.$1(_at.$Zo),n.$1(_a.$b),n.$1(_a.$35),n.$32(IAttachmentProviderItemViewModelFactory),n.$1(_a.$1J),n.$32(IAttachmentPreviewViewModelFactory),n.$32(IItemStoreGetterFactory),n.$1(IUriFileAttachmentViewModelFactory),n.$3I(ISmimeCommandFactory),n.$1(_a.$KW),n.$1(_g.$Q).get_$21l())}).$1J();var u=this;n.$q(_at.$1Gz,function(){return new _at.$1Gz(n.$1(_a.$Sl),n.$1(_a.$2c),n.$1(IInferenceTracker),n.$1(_a.$1J),n.$32(IAttachmentPreviewViewModelFactory),n.$32(IItemStoreGetterFactory),n.$3I(ISmimeCommandFactory),n.$1(_a.$KW),n.$1(_g.$Q).get_$21l(),n.$1(_a.$35))}).$2V(IUriFileAttachmentViewModelFactory).$1J()},$Bjd:function(){return null}};_at.$fg=function(n){_at.$fg.initializeBase(this,[n])};_at.$fg.prototype={$1Jc:null,$3Ft:260,$3Fs:50,$7QJ:!1,$Cq:function(){_b.$Lz.prototype.$Cq.call(this);this.$7QJ&&this.$1xG(this.$O)},$1xG:function(n){var t={};t.height="";t.width="";t.top="";t[_fc.$2H.get_$Sg()]="";var r=n;if(_at.$fg.$1sk){r=window.document.createElement("img");r.src=n.src}var f=r.naturalHeight;f||(f=r.height);var u=r.naturalWidth;u||(u=r.width);var s=.2;var y=1;var p=0;var g=1;if(this.$1Jc&&this.$1Jc.get_$9()>=4)if(this.$1Jc.get_$D(0)<this.$1Jc.get_$D(2)&&this.$1Jc.get_$D(1)<this.$1Jc.get_$D(3)){var v=255;s=this.$1Jc.get_$D(0)/v;y=this.$1Jc.get_$D(2)/v}else _js.Trace.logWarning(_a.$0.$1n,"Something wrong with the salient region, Top={0}, Left={1}, Bottom={2}, Right={3}",this.$1Jc.get_$D(0),this.$1Jc.get_$D(1),this.$1Jc.get_$D(2),this.$1Jc.get_$D(3));else _js.Trace.logWarning(_a.$0.$1n,"Using default value since we don't get salient regions");var e=u*(g-p);var o=f*(y-s);var k=e/o;var d=this.$3Ft/this.$3Fs;var i;var c=0,l=0;if(k>d){i=this.$3Fs/o;c=Math.round((e*i-this.$3Ft)*.5)}else{i=this.$3Ft/e;l=Math.round((o*i-this.$3Fs)*.5)}var a=Math.round(u*i);var h=Math.round(f*i);var b=(Math.round(p*a)+c)*-1;var w=(Math.round(h*s)+l)*-1;t.width=a.toString()+"px";t.height=h.toString()+"px";t.top=w.toString()+"px";t[_fc.$2H.get_$Sg()]=b.toString()+"px";this.$O.style.cssText="width: "+t.width+"; "+"height"+": "+t.height+"; "+"top"+": "+t.top+"; "+_fc.$2H.get_$Sg()+": "+t[_fc.$2H.get_$Sg()]+"; "+"position"+": "+"absolute"+";"}};_at.$57=function(n){this.$$d_$6WL=Function.createDelegate(this,this.$6WL);this.$$d_$81p=Function.createDelegate(this,this.$81p);this.$$d_$F37=Function.createDelegate(this,this.$F37);this.$$d_$F38=Function.createDelegate(this,this.$F38);this.$$d_$Bx3=Function.createDelegate(this,this.$Bx3);_at.$57.initializeBase(this,[n]);this.set_$Bo("about:blank");this.set_$g(-1);this.get_$S().load(this.$$d_$Bx3)};_at.$57.prototype={$1VA:null,$ZS:null,$CJ:0,$58b:!1,$2I:null,$sJ:0,$4RU:null,$4du:!1,$5qh:null,get_$97:function(){return this.$w(_at.$57.$5y8)},set_$97:function(n){this.$R(_at.$57.$5y8,n);return n},get_$FZ:function(){return this.$w(_at.$57.$74u)},set_$FZ:function(n){this.$R(_at.$57.$74u,n);return n},set_$2r:function(n){n||(this.$CJ=-1);this.$R(_at.$57.$2Sy,n);return n},get_$4nu:function(){return this.$w(_at.$57.$6Eu)},set_$4nu:function(n){this.$R(_at.$57.$6Eu,n);return n},get_$3ka:function(){return this.$w(_at.$57.$5qi)},set_$3ka:function(n){this.$R(_at.$57.$5qi,n);return n},set_$AEr:function(n){if(this.$5qh===n)return n;this.$5qh=n;this.$4("UploadAndShareAttachmentCommand");return n},get_$5qj:function(){return this.$w(_at.$57.$7aO)},set_$5qj:function(n){this.$R(_at.$57.$7aO,n);return n},set_$Lc:function(n){this.$2I=n;this.$4("Error");return n},set_$389:function(n){this.$sJ=n;this.$4("AttachmentError");return n},set_$5m5:function(n){this.$4RU=n;this.$4("SuccessResponse");return n},$8H:function(){_js.$C.prototype.$8H.call(this);this.$R(_at.$57.$5qi,new _C(this.$$d_$F38,_at.$57.$L));this.set_$AEr(new _C(this.$$d_$F37,_at.$57.$L))},$Bx3:function(n){if(this.$CJ){if(this.$CJ===2){_js.Trace.logInfo(_at.$57.$L,"Response received.");var t="";try{t=this.get_$S()[0].contentWindow.document.body.innerText}catch(u){if(!(_a.UserAgent.getInstance().$EV&&u.number===-2146828218)){_js.Trace.logException(_at.$57.$L,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.$58b)_js.$A.$o(t)&&this.$71C(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.$Cq.$BwR(t,this.get_$97(),this.get_$FZ(),_g.$1R.$1M,function(n){_js.Trace.logInfo(_at.$57.$L,"HandleCreateAttachmentResponse completed.");r.$71C(n,null,0)},function(n,t){_js.Trace.logInfo(_at.$57.$L,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.get_$97().get_$Cn()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.$6r.$8Sy(t)||_at.$6r.$3zj(n);i.$71C(null,f,r)})}}}else{_js.Trace.logInfo(_at.$57.$L,"Initializing.");this.$CJ=1;this.$C3z();_js.$D.get_$P().$2W(_at.$57.$L,"ExecuteOpenFilePicker",this.$$d_$81p,0)}},$71C:function(n,t,i){this.set_$5m5(n);this.set_$Lc(t);this.set_$389(i);this.$CJ=3;this.get_$5qj().$11();this.$4du=!1},$C3z:function(){var n=this.get_$S()[0];n.contentWindow.document.body.innerHTML="";this.$1VA=n.contentWindow.document.createElement("form");this.$1VA.method="POST";this.$1VA.encType="multipart/form-data";this.$1VA.encoding="multipart/form-data";this.$AKv(this.$1VA);this.$ZS=$(n.contentWindow.document.createElement("input"));this.$ZS.attr("type","file");this.$ZS.attr("name","fileInput");var t=this;this.$ZS.change(function(n){t.$6WL()});_a.UserAgent.getInstance().$EV&&this.$ZS[0].attachEvent("onchange",this.$$d_$6WL);this.$1VA.appendChild(this.$ZS[0])},$AKv:function(n){this.get_$S()[0].contentWindow.document.body.appendChild(n)},$6WL:function(){if(!this.$4du){this.$4du=!0;var n=this.$ZS[0].value;if(!_js.$A.$o(n)){this.get_$97().set_$1w(this.$EuR(n));this.get_$4nu().$11()}}},$EuR:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},$81p:function(){this.$ZS[0].click()},$F38:function(){this.$58b=!1;this.$1VA.action=_g.$3e.get_$7j7();this.$81i()},$F37:function(){this.$58b=!0;this.$1VA.action=_g.$3e.get_$AQY();this.$36b("subscriptionId",this.get_$k().get_$WW());this.$81i()},$81i:function(){_js.Trace.logInfo(_at.$57.$L,"Uploading attachment via form submit.");this.$36b("parentItemId",this.get_$FZ().Id);this.$36b("parentChangeKey",this.get_$FZ().ChangeKey);this.$36b("isInline",this.get_$97().get_$Cn().toString());this.$36b("cancellationId",this.get_$k().get_$194());this.$36b(_a.$2A.$1rd(),_a.$2A.$26b());this.$1VA.submit();this.$CJ=2},$36b:function(n,t){var i=$(this.$1VA.ownerDocument.createElement("input"));i.attr("type","hidden");i.attr("name",n);i.val(t);this.$1VA.appendChild(i[0])}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.$1cn=function(){};_at.$1cn.registerInterface("_at.$1cn");_at.$6E=function(n,t){this.$Cu=n||_at.$6E.$BtD();this.$3gq=t;this.$1UH=this.$3gq?this.$Cu.DirectFileAccessOnPublicComputersEnabled:this.$Cu.DirectFileAccessOnPrivateComputersEnabled;if(this.$1UH){this.$6Ex=_at.$6E.$7ut(this.$Cu.BlockedFileTypes,this.$Cu.ForceSaveFileTypes,this.$Cu.AllowedFileTypes);this.$6x5=_at.$6E.$7ut(this.$Cu.BlockedMimeTypes,this.$Cu.ForceSaveMimeTypes,this.$Cu.AllowedMimeTypes)}this.$76l=_at.$6E.$Acd(this.$Cu.ActionForUnknownFileAndMIMETypes)};_at.$6E.get_$P=function(){_at.$6E.$1M||(_at.$6E.$1M=new _at.$6E(_g.$Q.get_$P().get_$21l(),_g.$Q.get_$P().get_$EgR()));return _at.$6E.$1M};_at.$6E.$Acd=function(n){var t;try{t=_js.$1S.$CE(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.$6E.$8Vq=function(n,t){return n[t]||0};_at.$6E.$7ut=function(n,t,i){var r={};_at.$6E.$5uS(r,i,3);_at.$6E.$5uS(r,t,2);_at.$6E.$5uS(r,n,1);return r};_at.$6E.$5uS=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.$6E.$BtD=function(){var n=new _g.$Vg;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"ForceWebReadyDocumentViewingFirstOnPublicComputers":false,"ForceWebReadyDocumentViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPrivateComputersEnabled":true,"WebReadyDocumentViewingForAllSupportedTypes":false,"WebReadyFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"],"WebReadyDocumentViewingSupportedFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyDocumentViewingSupportedMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"]}')};_at.$6E.$3F8=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.$6E.prototype={$3gq:!1,$1UH:!1,$76l:0,$Cu:null,$6Ex:null,$6x5:null,$4ya:function(n,t,i,r){$B(i)&&(i=!0);$B(n)||(n=n.toLowerCase());var e;e=this.$1UH?this.$Blh(n,t):1;var f=!1;var u=!1;var s=!1;var o=!1;if(i&&!r){this.$CFa(n)&&(u=!0);this.$CEg(n,t)&&(f=!0);s=this.$CA5(this.$3gq,u,f);u&&this.$Cu.WacEditableFileTypes&&n&&(o=_at.$6E.$3F8(this.$Cu.WacEditableFileTypes,n))}return new _at.$1IJ(this.$1UH,e,u,f,s,o)},$Blh:function(n,t){var r=_at.$6E.$8Vq(this.$6Ex,n);if(r===1)return 1;var i=_at.$6E.$8Vq(this.$6x5,t);return i===1?1:r===2||i===2?2:r===3||i===3?3:this.$76l},$CFa:function(n){var t=this.$3gq?this.$Cu.WacViewingOnPublicComputersEnabled:this.$Cu.WacViewingOnPrivateComputersEnabled;return t&&this.$F4m(n)},$CEg:function(n,t){var i=this.$3gq?this.$Cu.WebReadyDocumentViewingOnPublicComputersEnabled:this.$Cu.WebReadyDocumentViewingOnPrivateComputersEnabled;return i&&this.$Eo8(n,t)},$CA5:function(n,t,i){return!t&&!i?!1:n?t?this.$Cu.ForceWacViewingFirstOnPublicComputers:this.$Cu.ForceWebReadyDocumentViewingFirstOnPublicComputers:t?this.$Cu.ForceWacViewingFirstOnPrivateComputers:this.$Cu.ForceWebReadyDocumentViewingFirstOnPrivateComputers},$F4m:function(n){return _at.$6E.$3F8(this.$Cu.WacViewableFileTypes,n)},$Eo8:function(n,t){if(_js.$A.$o(n)){if(!_js.$A.$o(t))return this.$Cu.WebReadyDocumentViewingForAllSupportedTypes?_at.$6E.$3F8(this.$Cu.WebReadyDocumentViewingSupportedMimeTypes,t):_at.$6E.$3F8(this.$Cu.WebReadyMimeTypes,t)}else return this.$Cu.WebReadyDocumentViewingForAllSupportedTypes?_at.$6E.$3F8(this.$Cu.WebReadyDocumentViewingSupportedFileTypes,n):_at.$6E.$3F8(this.$Cu.WebReadyFileTypes,n);return!1}};_at.$1IJ=function(n,t,i,r,u,f){!n;this.$1UH=n;this.$1Ss=t;this.$35X=i;this.$1dR=r;this.$3Fj=u;this.$35i=f};_at.$1IJ.prototype={$1Ss:0,$1UH:!1,$3Fj:!1,$35X:!1,$1dR:!1,$35i:!1,get_$59O:function(){return this.$1dR||this.$35X},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, Stellent: {3}, ForceBrowserView: {4}, WacEdit: {5}",this.$1Ss,this.$1UH,this.$35X,this.$1dR,this.$3Fj,this.$35i)}};_at.$10A=function(){this.$2jH=new FileReader};_at.$10A.prototype={$2jH:null,$6Dc:null,get_$Lc:function(){return this.$2jH.error},get_$3Ef:function(){return this.$6Dc},get_$4i:function(){return this.$2jH.result},set_$9QO:function(n){this.$2jH.onloadend=n;return n},$9ap:function(n){if(_h.$178.isInstanceOfType(n)){var i=n;this.$2jH.readAsDataURL(i.$3o8)}else if(_h.$KI.isInstanceOfType(n)){var t=n;this.$2jH.readAsDataURL(t.$2jG)}},$4J5:function(n,t,i,r){var u=this;this.set_$9QO(function(){if(!u.get_$Lc()&&u.get_$4i()){var f=u.get_$4i().indexOf(",");var n=u.get_$4i().substring(f+1,u.get_$4i().length);_js.Trace.logInfo(r,"No error - Reading the file.");u.get_$4i().substring(0,f).indexOf("base64")!==-1?t(n):t(_a.$66.$KX(n))}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",u.get_$Lc());i()}});try{this.$9ap(n)}catch(f){this.$6Dc=f;_a.UserAgent.getInstance().$YT&&f.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",f.message):_js.Trace.logWarning(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+f.message);i()}}};_at.$19G=function(){};_at.$19G.prototype={$65x:function(){return new _at.$10A}};_at.$1JP=function(n){_at.$1JP.initializeBase(this);this.$zs=n};_at.$1JP.prototype={$zs:null,$6au:function(n){var t=new _g.$1JQ(this.$2Y);n.$4dC(this.$zs,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){n?t():i(null)}};_at.$Cq=function(n,t,i,r,u,f,e){_at.$Cq.initializeBase(this);this.$pU=n;this.$1x=t;this.$IF=i;this.$zs=r;this.$4QX=f;this.$1m8=e;this.$CV=u};_at.$Cq.$BwR=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.$Cq.$L,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.set_$6K(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.set_$8A(e.Size||0);t.set_$Kz(e.ContentType);t.get_$Cn()&&t.set_$TH(e.ContentId);u(o)}}else{_js.Trace.logError(_at.$Cq.$L,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.$Cq.$L,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_js.Trace.logError(_at.$Cq.$L,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.$Cq.$9Yv=function(n,t,i,r){if(!n.IsCancelled&&r){t.set_$6K(n.Attachments[0].AttachmentId);t.get_$Cn()&&t.set_$TH(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.set_$8A(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}};_at.$Cq.prototype={$pU:0,$1x:null,$IF:null,$Cr:null,$zs:null,$4QX:0,$1m8:0,$CV:null,$Bsv:function(){if(this.$2I||!this.$6J||!this.$6J.response){_js.Trace.logInfo(_at.$Cq.$L,"No success response because there's an error, or action is not complete.  Error: {0}",this.$2I);return null}return this.$6J.response.result},$6au:function(n){this.$Cr=this.$vq();if(this.$zs){var t=new _g.$1KC(this.$2Y);t.explicitLogonUser=this.$CV;t.clientStoreItem=this.$pU;t.isQueued=!1;t.palContext=new _g.$wL(!1);n.$65Q(this.$Cr,t,this.$$d_$732,this.$$d_$1Iy)}else{var i=new _g.$18H(this.$2Y);i.explicitLogonUser=this.$CV;i.clientStoreItem=this.$pU;i.isQueued=!1;i.palContext=new _g.$wL(!1);n.$2L2(this.$Cr,i,this.$$d_$732,this.$$d_$1Iy)}},$yV:function(n){this.$9Yw(n)},$9Yw:function(n){_at.$Cq.$9Yv(n,this.$1x,this.$IF,this.$1m8<=this.$4QX+1)},$vq:function(){var i=new _g.$1b(this.$IF.Id);i.ChangeKey=this.$IF.ChangeKey;var t=this.$1x.$3zK();var n=new _g.$RB(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.$zs;if(this.$1m8!==1){n.SliceNumber=this.$4QX;n.TotalSlices=this.$1m8}return new _g.$RA(this.get_$7Q(),n)}};_at.$1KF=function(n,t,i,r,u){_at.$1KF.initializeBase(this,[n,t,i,r,u,0,1]);var f=t.$M6;this.$68S=f};_at.$1KF.prototype={$68S:null,$6au:function(n){var u=this.$vq();var t=new _g.$18H(this.$2Y);t.explicitLogonUser=this.$CV;t.clientStoreItem=this.$pU;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.$wL(!0);t.dataFile=this.$68S.$Ul();n.$2L2(u,t,this.$$d_$732,this.$$d_$1Iy)},$yV:function(n){this.$9Yw(n)}};_at.$1Kq=function(n,t,i){_at.$1Kq.initializeBase(this);this.$pU=n;this.$1x=t;this.$IF=i;this.$DZ=t.get_$6K()||t.get_$cU()};_at.$1Kq.prototype={$pU:0,$1x:null,$DZ:null,$IF:null,$yV:function(n){this.$IF.Id=n.RootItemId.RootItemId;this.$IF.ChangeKey=n.RootItemId.RootItemChangeKey;this.$1x.get_$cU()&&this.$1x.set_$6K(this.$1x.get_$cU())},$6au:function(n){var r=new _g.$RH;r.ClientSupportsIrm=!0;var i=new _g.$1Kr(this.$2Y);i.itemContexts=new Array(1);var t=new _g.$1Ks;t.clientStoreItem=this.$pU;t.parentItemId=new _g.$1b(this.$IF.Id);t.parentItemId.ChangeKey=this.$IF.ChangeKey;r.AttachmentIds=[new _g.$Ck(this.$DZ.Id)];var u=new _g.$Wj(this.get_$7Q());u.Body=r;i.itemContexts[0]=t;n.$2lU(u,i,this.$$d_$732,this.$$d_$1Iy)}};_at.$iV=function(n,t){_at.$iV.initializeBase(this);this.$3Dm=_a.$8.$1g(_at.$iV.$L,"DownloadAttachment",!0);this.$DZ=n;this.$AZ=t};_at.$iV.prototype={$DZ:null,$3Bv:null,$3Dm:null,$AZ:!1,$6au:function(n){var i=new _g.$1Mx(this.$2Y);var t=new _g.$Xz(this.get_$7Q());t.Body.AttachmentIds=[new _g.$Ck(this.$DZ)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.$k.get_$CFl();if(this.$AZ){t.Header.ManagementRole=new _g.$MU;t.Header.ManagementRole.UserRoles=["MailboxSearch"]}n.$6Rq(t,i,this.$$d_$732,this.$$d_$1Iy)},$yV:function(n){var u=n.Attachments.length;if(u!==1){var f=String.format("GetAttachment response length = {0}",u);_a.$8.$1I(this.$3Dm,"DownloadAttachment",f);_js.Trace.logWarning(_a.$0.$1n,f);return}var e=n.Attachments[0];if(!e){var t="GetAttachment response contained null attachment";_a.$8.$1I(this.$3Dm,"DownloadAttachment",t);_js.Trace.logWarning(_a.$0.$1n,t);return}var i=_a.$19.$CS(_g.$7e,e);this.$3Bv=i.get_$D();if(!this.$3Bv){var r="GetAttachment response contained null item";_a.$8.$1I(this.$3Dm,"DownloadAttachment",r);_js.Trace.logWarning(_a.$0.$1n,r);return}_js.Trace.logInfo(_a.$0.$1n,"GetAttachment succeeded for '{0}' on '{1}'",i.get_$1w(),this.$3Bv.get_$3t());_a.$8.$1I(this.$3Dm,"DownloadAttachment")}};_at.$1Mw=function(n,t){_at.$1Mw.initializeBase(this);this.$2B=n;this.$1x=t;this.$DZ=t.get_$6K()||t.get_$cU();if(!_g.$56.isInstanceOfType(t)&&!_g.$7e.isInstanceOfType(t)&&!_g.$7W.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.$1Mw.prototype={$2B:null,$1x:null,$DZ:null,$9OI:function(){if(_g.$56.isInstanceOfType(this.$1x)){var n=this.$1x;if(_a.$1QG.isInstanceOfType(n.$M6)){var u=n.$M6;var r=new _at.$19G;var f=r.$65x();var t=this,i=this;f.$4J5(u,function(i){n.set_$Cg(t.$6Gg(i));t.$Qa(null)},function(){var t=String.format("Unable to read content of file {0}.",n.get_$1w());_js.Trace.logWarning(i.$2B,t);i.$Qa(Error.create(t))},this.$2B);return 1}else return this.$8T9()}else return _g.$7e.isInstanceOfType(this.$1x)?this.$8T9():_h.$1hi.prototype.$9OI.call(this)},$78J:function(n,t,i){var r=this.$1x;if(_js.$A.$o(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.get_$x().Id)));else{r.set_$df(this.$6Gg(n));t()}},$6au:function(n){var t=new _g.$1b(this.$1x.get_$x().Id);n.$6Te(t,null,this.$$d_$732,this.$$d_$1Iy)},$8T9:function(){var t=new XMLHttpRequest;var i=String.format(_g.$7e.isInstanceOfType(this.$1x)?_g.$3e.get_$388():_g.$3e.get_$7j4(),encodeURIComponent(this.$DZ.Id));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.$6Gg(t.responseText);_g.$56.isInstanceOfType(n.$1x)?n.$1x.set_$Cg(r):_g.$7e.isInstanceOfType(n.$1x)&&n.$1x.set_$df(r);n.$Qa(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.$DZ.Id,t.responseText,t.statusText);_js.Trace.logError(n.$2B,i);n.$Qa(Error.create(i))}};t.open("GET",i,!0);_a.$g.$A50(t);t.send(null);return 1},$6Gg:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};var IAttachmentDataProviderMap=function(){};IAttachmentDataProviderMap.registerInterface("IAttachmentDataProviderMap");_at.$1cD=function(){};_at.$1cD.registerInterface("_at.$1cD");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.$Zo=function(){};_at.$Zo.registerInterface("_at.$Zo");_at.$1cG=function(){};_at.$1cG.registerInterface("_at.$1cG");_at.$Aq=function(n,t,i,r,u){this.$ZM=_js.$A.$o(n)?"#":n;this.$ha=t;this.$Mm=i;this.$8Q=r;this.$8l1=u;this.$3d=u?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;_js.Trace.logInfo(_a.$0.$1n,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.$8Q,this.$ha,this.$3d,this.$ZM)};_at.$Aq.get_$8ap=function(){_at.$Aq.$50j||(_at.$Aq.$50j=new _at.$Aq("#",!0,null,!0,!1));return _at.$Aq.$50j};_at.$Aq.$I=function(n,t,i){_a.$4.$a(n,"viewModel");_a.$4.$a(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.$Aq.$AUT(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.$Aq.$7lO(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.$3I.isInstanceOfType(n)){var a=n;a.$uI.get_$1TM()&&(r=!0)}return new _at.$Aq(f,r,u,!1,t)};_at.$Aq.$7lO=function(n,t,i,r){var u=!1;if(_at.$3I.isInstanceOfType(n)){var f=n;u=f.$uI.get_$1TM()}if(!n.$R1.$1UH||u||n.$R1.$3Fj||n.$1x.get_$YW()){i.val=!0;t.val="#";r.val=n.$1CO;return}switch(n.$R1.$1Ss){case 3:i.val=!1;t.val=n.$ZM;r.val=n.$7P6;break;case 2:i.val=!0;r.val=n.$1CO;t.val=n.$ZM;break;case 1:i.val=!0;t.val="#";r.val=n.$1CO;break;case 0:default:i.val=!0;t.val="#";r.val=n.$1CO;break}};_at.$Aq.$AUT=function(n,t,i,r){if(n.$1x.get_$YW()){i.val=!0;t.val="#";r.val=n.$1CO;return}switch(n.get_$IR()){case 5:i.val=!0;t.val="#";r.val=n.$73D;break;case 3:i.val=!0;t.val="#";r.val=n.$2Cq;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.$R1.$1Ss===3?new _C(function(){n.$8x&&n.$8x.$EiH(n)},_a.$0.$1n):n.$1CO;break;default:_at.$Aq.$7lO(n,t,i,r);break}};_at.$Aq.prototype={$ha:!1,$ZM:null,$Mm:null,$3d:null,$8Q:!1,$8l1:!1};_at.$yB=function(n,t,i,r,u){_at.$yB.initializeBase(this,[_at.$yB.$3K5(),"AttachmentUploadDatapoint"]);this.$R("S",n);this.$R("T",t.toString());this.$R("E",i);this.$R("X",r);this.$R("Z",u.toString())};_at.$yB.$3K5=function(){return 1};_at.$1q=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$$d_$6Er=Function.createDelegate(this,this.$6Er);this.$$d_$Axh=Function.createDelegate(this,this.$Axh);this.$$d_$AVJ=Function.createDelegate(this,this.$AVJ);this.$$d_$AVK=Function.createDelegate(this,this.$AVK);this.$$d_$Adw=Function.createDelegate(this,this.$Adw);this.$$d_$3B9=Function.createDelegate(this,this.$3B9);this.$$d_$4gV=Function.createDelegate(this,this.$4gV);this.$$d_$69M=Function.createDelegate(this,this.$69M);this.$$d_$AnJ=Function.createDelegate(this,this.$AnJ);this.$$d_$7jB=Function.createDelegate(this,this.$7jB);this.$$d_$F3C=Function.createDelegate(this,this.$F3C);this.$$d_$Ae1=Function.createDelegate(this,this.$Ae1);this.$$d_$DZm=Function.createDelegate(this,this.$DZm);this.$$d_$2lU=Function.createDelegate(this,this.$2lU);this.$$d_$Dpt=Function.createDelegate(this,this.$Dpt);this.$$d_$WH=Function.createDelegate(this,this.$WH);this.$$d_$5RP=Function.createDelegate(this,this.$5RP);this.$$d_$Ecl=Function.createDelegate(this,this.$Ecl);this.$$d_$4lA=Function.createDelegate(this,this.$4lA);this.$$d_$Yl=Function.createDelegate(this,this.$Yl);this.$6Et=new _at.$19G;_at.$1q.resolveInheritance();this.apcl=this.$n;this.rpcl=this.$1B;_at.$1q.initializeBase(this);this.$2f=f;this.$1C=o;this.$1EM=s;this.$Qb=h;this.$6k=c;this.set_$97(n);this.$H=t;this.set_$DrA(u);this.$19=e;this.$Kf_4=a;this.$l_4=y;this.$5nF=p?p.get_$2a().get_$F61().Enabled:!1;this.$57b=this.$8kn();this.$Tg=_g.$Q.get_$P().get_$4n().get_$2u3()-2;_g.$56.isInstanceOfType(n)&&(this.$10V=n.get_$Cg());u&&(this.$9a=u.get_$1ep());this.$7x=i;this.$AZ=r;this.$Cu=v;this.set_$1Lp(!this.$7x);this.set_$82s(_a.$6K.$nL(n.get_$1w()));this.set_$9XT(_at.$6E.get_$P().$4ya(this.$1Md,this.$1x.get_$Kz(),_y.$7H.$6h8(this.$H,this.$19),this.get_$3Pl()));this.$1x&&this.$1x.get_$6K()&&this.set_$3Yk(this.$R1.get_$59O());this.$4TQ();this.$3kR();this.$ADQ();this.$AEG();this.$5qI();this.$1CO=new _C(this.$$d_$Yl,_at.$1q.$L);this.$243=new _C(this.$$d_$4lA,_at.$1q.$L);this.$7P6=new _C(this.$$d_$Ecl,_at.$1q.$L);this.$73D=new _C(this.$$d_$5RP,_at.$1q.$L);this.$2Cq=new _C(this.$$d_$WH,_at.$1q.$L);this.$6kh=new _C(this.$$d_$Dpt,_at.$1q.$L);if(!this.get_$C87()){this.$Im=new _C(this.$$d_$2lU,_at.$1q.$L);this.$4Fk=new _C(this.$$d_$DZm,_at.$1q.$L);this.$4Fn=new _C(this.$$d_$Ae1,_at.$1q.$L)}this.$VU=new _y.$V6;this.$CI=l;this.$3k9();this.$yd()};_at.$1q.prototype={$1CO:null,$243:null,$7P6:null,$73D:null,$2Cq:null,$Im:null,$4Fk:null,$4Fn:null,$6kh:null,$VU:null,$7x:!1,$AZ:!1,$H:null,$19:null,$l_4:null,$9a:null,$1C:null,$1EM:null,$2f:null,$Tg:0,$1x:null,$ZM:null,$3Q1:!1,$2jw:!1,$4bF:!1,$7aQ:!1,$73B:!1,$R1:null,$8x:null,$46:!1,$ry:!1,$3iD:null,$5lm:null,$1nA:0,$1pf:null,$2No:0,$3kb:null,$DZ:null,$2yM:!1,$a9:!1,$2Jw:!1,$sJ:0,$5xx:null,$jA:!1,$57D:!1,$1Md:null,$3aV:null,$27M:null,$5iK:!1,$5j2:!1,$41u:null,$2fX:null,$L0:null,$43r:!1,$10V:null,$2JI:null,$382:null,$21o:null,$2D3:null,$1hg:!1,$3rS:null,$w3:null,$2G:null,$rM:2,$1Xi:!1,$Qb:null,$6k:null,$4Qa:null,$CI:null,$Kf_4:null,$43J:!1,$j9:!1,$zs:null,$2lD:0,$1m8:1,$3MH:null,$Cu:null,$5nF:!1,$46I:!1,$5Wb:null,$57b:!1,$7TK:function(){_js.Trace.logInfo(_at.$1q.$L,"Starting attachment upload.");var t=this,n=this;_g.$1R.$1M.$4nE("CreateAttachment",this.$$d_$F3C,this.$AiL(),function(n){_js.Trace.logInfo(_at.$1q.$L,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.$1q.$L,"Enqueueing upload attachment failed: {0}",t.message);n.$2j7(1,_at.$6r.$3zj(t),!0);n.$4b3(null)})},add_$1Ix:function(n){this.$36("OnUploadCompleteEvent",n)},remove_$1Ix:function(n){this.$5v("OnUploadCompleteEvent",n)},add_$5RH:function(n){this.$36("OnUploadFailedEvent",n)},remove_$5RH:function(n){this.$5v("OnUploadFailedEvent",n)},add_$1wU:function(n){this.$36("OnDeleteCompleteEvent",n)},remove_$1wU:function(n){this.$5v("OnDeleteCompleteEvent",n)},add_$9No:function(n){this.$36("OnDownloadCompleteEvent",n)},remove_$9No:function(n){this.$5v("OnDownloadCompleteEvent",n)},add_$9MS:function(n){this.$36("OnCancelCompleteEvent",n)},remove_$9MS:function(n){this.$5v("OnCancelCompleteEvent",n)},get_$4QJ:function(){return this.get_$55G()&&this.$5nF},get_$Eru:function(){if(!this.get_$4QJ())return null;if(this.$1x&&!_js.$A.$o(this.$1x.get_$4S9())){var n=this.$1x;if(n)return n.get_$C2V()}return null},set_$CFV:function(n){if(n!==this.$46I){this.$46I=n;this.$4("ShowAttachmentInfo");this.$4("ThumbnailSliceSelected")}return n},get_$Erw:function(){return this.get_$4QJ()&&(this.$46I||this.$1Xi)},get_$Erv:function(){return this.get_$4QJ()&&this.$1Xi},get_$Egs:function(){return!this.get_$4QJ()||this.$46I||this.$1Xi},set_$5xo:function(n){this.$382=n;return n},get_$IR:function(){this.$1nA||(this.$1nA=this.$6Rr());return this.$1nA},get_$97:function(){return this.$1x},set_$97:function(n){var t=this.$1x;if(t!==n){$B(t)||t.remove_$D4(this.$$d_$7jB);this.$1x=n;var i=$B(n);if(!i){n.add_$D4(this.$$d_$7jB);_js.Trace.logInfo(_a.$0.$1n,"Attachment: {0}",n.get_$1w())}this.$8Yt(i?null:n.get_$6K());this.$4("Attachment");this.$4("ReferenceAttachment");this.$4("ReferenceAttachmentProviderTypeInfo");this.$5qI();this.$AEF()}return n},get_$Pd:function(){return this.$57b?this.get_$1ai()?this.get_$1ai().get_$1QC():0:this.$rM},set_$Pd:function(n){this.$57b?this.get_$1ai()&&this.get_$1ai().get_$1QC()!==n&&this.get_$1ai().set_$1QC(n):this.$rM=n;this.$5qI();return n},get_$1ai:function(){return _g.$7g.isInstanceOfType(this.$1x)?this.$1x:null},get_$E04:function(){return this.get_$1ai()&&this.get_$1ai().get_$17K()?String.format(_nbs.NonBootStrings.l_ReferenceLinkShared_Text,_nbs.NonBootStrings.l_OneDriveProviderName_Text):""},get_$6K:function(){return this.$1x&&this.$1x.get_$6K()?this.$1x.get_$6K().Id:null},get_$8lH:function(){return!!this.get_$1ai()&&(this.get_$IR()===1||this.get_$IR()===2)},get_$CDc:function(){return this.get_$8lH()&&this.$19.get_$8q()},set_$2j:function(n){this.$46=n;this.$4("IsSelected");return n},set_$6BZ:function(n){if(this.$ZM!==n){this.$ZM=n;_js.Trace.logInfo(_at.$1q.$L,"Attachment download URL: {0}",this.$ZM);this.$4("DownloadUrl")}return n},set_$CF7:function(n){if(this.$3Q1!==n){this.$3Q1=n;this.$4("IsTriggeredPolicyTip")}return n},set_$1Lp:function(n){this.$2jw=n;this.$3Z("CanDelete","ShowDeleteButton");return n},set_$4bG:function(n){this.$4bF=n;this.$3Z("AttachmentWellPendingRefresh","ShowDeleteButton");return n},get_$4Ph:function(){return this.$2jw||this.$4bF},set_$7aR:function(n){this.$7x||this.get_$61m()||this.set_$1Lp(!n);this.$7aQ=n;this.$4("UploadInProgress");return n},get_$3Yk:function(){return this.$73B},set_$3Yk:function(n){this.$73B=n;this.$4("OpenDocumentInBrowserLinkVisible");return n},set_$9XT:function(n){this.$R1=n;this.$1nA=this.$6Rr();return n},get_$C7G:function(){return this.$8x},set_$DrA:function(n){this.$8x=n;this.$4("ParentWell");return n},get_$mD:function(){return this.$ry},set_$mD:function(n){if(this.$ry!==n){this.$ry=n;this.$8x&&this.$8x.$Bym(this);this.$4("ShouldBeHidden")}return n},set_$75L:function(n){if(this.$2yM!==n){this.$2yM=n;this.$4("PendingNonHtml5Upload")}return n},get_$4PS:function(){return this.$5iK},set_$4PS:function(n){if(this.$5iK!==n){this.$5iK=n;this.$4("ShouldSizeBeHidden")}return n},get_$A1N:function(){return!this.$1x||!this.$1x.get_$6K()||!this.get_$2ko()||!this.get_$2ko().$1Y.get_$9()},get_$45m:function(){return!1},get_$9VK:function(){return!1},set_$7R4:function(n){if(this.$5j2!==n){this.$5j2=n;this.$4("ShowEditPermissionsInCompose")}return n},set_$82s:function(n){if(this.$1Md!==n){this.$1Md=n;this.$4("FileExtension")}return n},set_$7Tz:function(n){this.$3iD=n;this.$4("SubmitUploadFormCommand");return n},set_$Eor:function(n){this.$5lm=n;this.$4("SubmitUploadAndShareFormCommand");return n},get_$WW:function(){throw Error.notImplemented("This getter must be overridden");},get_$J1:function(){this.$2G||(this.$2G=new _bc.$3p);return this.$2G},get_$738:function(){return this.$1CO},get_$1FE:function(){return this.$Im},set_$6Gp:function(n){this.$1pf=n;_js.Trace.logWarning(_at.$1q.$L,"Attachment form upload error: {0}",this.$1pf);this.$4("FormUploadError");return n},set_$6Go:function(n){this.$2No=n;_js.Trace.logWarning(_at.$1q.$L,"Attachment form upload error code: {0}",this.$2No);this.$4("FormUploadAttachmentError");return n},set_$5qk:function(n){this.$3kb=n;this.$4("UploadSuccessResponse");return n},get_$9LP:function(){return!1},get_$3Yp:function(){return this.$a9},get_$389:function(){return this.$sJ},get_$qV:function(){return this.$27M},set_$qV:function(n){this.$27M=n;return n},get_$wy:function(){var n=_y.$7H.$4wz(this.$1x.get_$6K(),this.$AZ,_g.$3e.get_$8cP());_js.Trace.logInfo(_at.$1q.$L,"Image preview URL: {0}",n);return n},get_$l6:function(){return this.$19.get_$15p()},get_$54j:function(){return this.$19.get_$15o()},get_$3O4:function(){return this.get_$IR()!==2&&this.get_$IR()!==1||this.$1x.get_$Cn()?!1:this.$R1.$1Ss===3},get_$55G:function(){return this.get_$IR()!==2?!1:this.$R1.$1Ss===3},get_$BzV:function(){return this.get_$IR()!==2&&this.get_$IR()!==4},get_$BzX:function(){return!this.$1x.get_$YW()&&(this.get_$IR()===2||this.get_$IR()===1)},get_$6Ya:function(){if(this.$41u)return this.$41u;var n;n=OwaApplication.$Q4&&this.get_$IR()===5?!1:this.get_$39U()?this.get_$IR()===5||!this.get_$4P7()&&(!this.$AZ||this.$AZ&&this.get_$IR()!==3):this.get_$IR()===5||this.$H.get_$T()==="Mouse"&&this.get_$IR()!==3;_js.Trace.logInfo(_at.$1q.$L,"IconLinkViewModel preview = {0}",n);this.$41u=_at.$Aq.$I(this,n,this.$H);return this.$41u},get_$ErV:function(){if(this.$2fX)return this.$2fX;if(this.$H.get_$T()!=="Mouse"){this.$2fX=_at.$Aq.get_$8ap();return this.$2fX}var t=!1;var n=!1;if(this.$1x.get_$YW()){n=_g.$7e.isInstanceOfType(this.$1x);t=n}else switch(this.get_$IR()){case 3:n=!1;t=this.get_$6cO()?!1:!this.$AZ;break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:if(OwaApplication.$Q4){t=!1;n=!1}else n=!0;break;case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.$1q.$L,"TextLinkViewModel is hidden");this.$2fX=_at.$Aq.get_$8ap()}else{_js.Trace.logInfo(_at.$1q.$L,"TextLinkViewModel preview = {0}",t);this.$2fX=_at.$Aq.$I(this,t,this.$H)}return this.$2fX},get_$2ko:function(){if(!this.$L0){var n=new Array(0);this.$L0=new _fm.$1v(n)}return this.$L0},set_$2ko:function(n){this.$L0=n;this.$4("ContextMenu");return n},get_$19C:function(){return this.$H.get_$T()!=="Mouse"},get_$1ep:function(){return this.$9a},get_$41:function(){var n=this.get_$IR();switch(n){case 4:return _nbs.NonBootStrings.l_BlockedContent_Text;case 1:case 2:return _nbs.NonBootStrings.l_ClickForPreview_Text;case 6:case 3:return this.$1x.get_$1w();case 5:return OwaApplication.$Q4?this.$1x.get_$1w():_nbs.NonBootStrings.l_ClickForPreview_Text;default:break}return""},set_$55O:function(n){if(this.$43r!==n){this.$43r=n;this.$3kR()}return n},get_$1hU:function(){return this.$jA},set_$1hU:function(n){if(this.$jA!==n){this.$jA=n;this.$4("IsDeleted")}return n},set_$nZ:function(n){this.$j9!==n&&(this.$j9=n);return n},set_$8hW:function(n){if(this.$43J!==n){this.$43J=n;this.$4("IsCancelling")}return n},get_$2mO:function(){_a.$4.$Fo(this.get_$IR()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.$1x.get_$IR()},get_$6cO:function(){return!!this.$1C&&(this.$1C.get_$2a().get_$7yo().Enabled||this.$1C.get_$2a().get_$9Iy().Enabled)},get_$C9k:function(){return!!this.$1C&&!!this.$Cu&&this.$1C.get_$2a().get_$38C().Enabled&&this.$Cu.AttachmentDataProviderAvailable},get_$39U:function(){return this.get_$6cO()&&this.$H.get_$T()!=="TouchNarrow"&&(this.$R1.$35X||this.get_$IR()===1||this.get_$IR()===2)&&!this.get_$3Pl()&&!this.get_$CDc()&&!this.$19.get_$dJ()},get_$4P7:function(){return this.$19.get_$dJ()||this.$19.get_$KH()||this.$H.get_$T()==="TouchNarrow"||!this.$7x&&this.$H.get_$T()==="TouchWide"},set_$AQh:function(n){if(this.$2JI!==n){this.$2JI=n;this.$4("AttachmentPreviewViewModel")}return n},get_$1OU:function(){return this.$1hg},set_$1OU:function(n){this.$1hg=n;n&&this.set_$3Yk(!1);return n},set_$57M:function(n){this.$1Xi=n;this.$4("IsOpenedInLightBox");this.$4("ShowAttachmentInfo");this.$4("ThumbnailSliceSelected");this.$4("ThumbnailSliceOpenedInLightBox");this.$4("IsComposedInLightBox");this.get_$6bt()&&this.set_$1Lp(!1);return n},get_$6bt:function(){_js.Trace.logInfo(_a.$0.$1D,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.$8x,this.$1Xi,this.$8x.get_$H5(),this.$R1.$35i,this.$1x?this.$1x.get_$1w():"null",this.$1Xi&&!this.$8x.get_$H5()&&this.$R1.$35i);return this.$8x?this.$1Xi&&!this.$8x.get_$H5()&&this.$R1.$35i:!1},get_$194:function(){!this.$zs&&this.get_$61m()&&(this.$zs=(+new Date).toString());return this.$zs},get_$61m:function(){var n=!!this.$1C&&this.$1C.get_$2a().get_$9Iy().Enabled;return!n||this.$19.get_$8q()||this.$19.get_$4b6()?!1:!this.$8x.get_$ew()||!!this.$Kf_4&&this.$Kf_4.$27r(this.$8x.get_$ew(),"AttachmentUploadCancellation")},get_$61V:function(){var n=!!this.$1x.get_$6K();var i=n?this.$1x.get_$6K().Id:null;var t=i?_bc.$9w.$8ha(i):!1;var r=this.$R1.$1Ss===1;_js.Trace.logInfo(_at.$1q.$L,"UpdateDownloadUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.$R1.toString());return n&&!r&&!t&&!this.$1x.get_$28Q()},get_$C87:function(){return!this.$8x},get_$AWB:function(){_js.Trace.logInfo(_at.$1q.$L,"Attachment class: {0}",this.$1nA);var n;switch(this.get_$IR()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.$1q.$L,"Embedded item class: {0}",this.get_$2mO());switch(this.get_$2mO()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.$1q.$L,"Can open: {0}",n);return n},get_$3Pl:function(){return this.$1x.get_$YW()||this.$1x.get_$28Q()},$3kR:function(){this.$8x?this.set_$mD(this.$43r||this.$1x.get_$Cn()&&this.$8x.get_$C18()&&!_g.$7g.isInstanceOfType(this.$1x)):this.set_$mD(this.$43r||this.$1x.get_$Cn());this.set_$mD(this.$ry||this.$1x.get_$2sb())},$DZm:function(){_js.Trace.logInfo(_at.$1q.$L,"File selected.");this.set_$55O(!1);this.$8x&&this.$8x.$DZl(this)},$2gp:function(){_js.Trace.logInfo(_at.$1q.$L,"submitting upload to server");this.$a9=!1;if(_g.$56.isInstanceOfType(this.$1x)){var n=this.$1x;this.$AEt(n)}else(_g.$7W.isInstanceOfType(this.$1x)||_g.$7e.isInstanceOfType(this.$1x)||_g.$7g.isInstanceOfType(this.$1x))&&this.$7TK()},$7Ts:function(){_js.Trace.logInfo(_at.$1q.$L,"submitting delete to server");this.$a9=!1;var n=new _at.$1Kq(2,this.$1x,this.$8x.get_$FZ());n.add_$2d(this.$$d_$AnJ);n.add_$4e(this.$$d_$69M);OwaApplication.$2D.$1T(n)},$6T4:function(){var i=this.$1x;var r=i.$M6;var n=this.$6Et.$65x();var t=this;n.set_$9QO(function(){if(n.get_$Lc())_js.Trace.logWarning(_at.$1q.$L,"HTML5 file reader attach failed with error code {0}",n.get_$Lc());else{var r=n.get_$4i().indexOf(",");var i=n.get_$4i().substring(r+1,n.get_$4i().length);t.$10V=n.get_$4i().substring(0,r).indexOf("base64")!==-1?i:_a.$66.$KX(i);t.$Am("OnUploadCompleteEvent",t)}});try{n.$9ap(r)}catch(u){this.$19.get_$15p()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.$1q.$L,"Firefox: failed to read an attachment. Exception: {0}",u.message):_js.Trace.logException(_at.$1q.$L,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},$78u:function(){this.$10V=null;this.$Am("OnDeleteCompleteEvent",this);if(this.$w3){_a.$8.$1I(this.$w3,null,"",null,this.$3C7(1));this.$w3=null}},$7XA:function(){this.$2D3=_a.$8.$1g(_a.$0.$1n,"AttachmentUploadQueue",!0)},$5oH:function(n){if(this.$2D3){_a.$8.$1I(this.$2D3,null,n,null,this.$NO());this.$2D3=null}},$7XB:function(){if(this.$2D3){_a.$8.$1I(this.$2D3,null,null,null,this.$NO());this.$2D3=null}this.$382&&(this.$21o=_a.$8.$1g(_a.$0.$1n,this.$382,!0))},$5oI:function(){if(this.$21o){var n="";this.$a9&&(n=this.$5xx);_a.$8.$1I(this.$21o,null,n,null,this.$NO());var i=this.$21o.get_$1Uj()&1024?+new Date:this.$21o.get_$ay();var t=new _at.$yB(this.$21o.get_$1w(),i-this.$21o.get_$Xs(),n,this.$1Md,this.$1x.get_$8A());_a.$n.$sc.$K1(t);this.$21o=null}},$1p4:function(){_js.Trace.logInfo(_at.$1q.$L,"Getting attachment content from server");this.$a9=!1;var n=new _at.$1Mw(_at.$1q.$L,this.$1x);var i=this;n.add_$4e(function(){i.$Am("OnDownloadCompleteEvent",i);i.set_$3Yk(!1)});var t=this;n.add_$2d(function(){_js.Trace.logWarning(_at.$1q.$L,"Download failed with error: {0}",n.$2I.message);t.$a9=!0;t.$1hg||t.$4gV(n)});OwaApplication.$2D.$1T(n)},$8fo:function(n){if(_g.$7W.isInstanceOfType(this.$1x)||_g.$7e.isInstanceOfType(this.$1x)){_js.Trace.logInfo(_at.$1q.$L,"Uploading item or id attachment.");this.$F3A()}else if(_g.$56.isInstanceOfType(this.$1x)){var t=this.$1x;if(this.$10V){_js.Trace.logInfo(_at.$1q.$L,"Uploading file attachment with pasted image from clipboard.");this.$7Gf(this.$10V)}else if(t.get_$Cg()){_js.Trace.logInfo(_at.$1q.$L,"Uploading file attachment with content.");this.$7Gf(null)}else if(t.get_$Cn()&&_a.$a0.isInstanceOfType(this.$1x.$M6)&&_at.$3I.isInstanceOfType(this)){_js.Trace.logInfo(_at.$1q.$L,"Uploading inline PAL image with content.");this.$AEx()}else if(this.$19.get_$5xz()){_js.Trace.logInfo(_at.$1q.$L,"Uploading HTML5 file attachment.");this.$3MH=t.$M6;this.$AEu()}else{_js.Trace.logInfo(_at.$1q.$L,"Uploading Non-HTML5 file attachment.");this.$AEw()}}else if(_g.$7g.isInstanceOfType(this.$1x)){this.$57D=!0;if(this.$19.get_$5xz()){_js.Trace.logInfo(_at.$1q.$L,"Uploading HTML5 reference attachment.");var i=this.$1x;this.$3MH=i.$M6;this.$AEu()}else{_js.Trace.logInfo(_at.$1q.$L,"Uploading Non-HTML5 reference attachment.");this.$AEw()}}else{_js.Trace.logError(_at.$1q.$L,"Unsupported upload type.");n(null)}},$6Rr:function(){var n=0;if(_g.$56.isInstanceOfType(this.$1x))if(this.$R1.get_$59O())n=3;else if(this.$R1.$1Ss===1)n=4;else{var i,t;(t=_y.$7H.$7QI(this.$1x,i={val:n}),n=i.val,t)||(n=6)}else n=_g.$7e.isInstanceOfType(this.$1x)?5:_g.$7W.isInstanceOfType(this.$1x)?0:4;return n},$4TQ:function(){this.get_$61V()?this.set_$6BZ(_y.$7H.$4wz(this.$1x.get_$6K(),this.$AZ)):this.set_$6BZ(null)},$4gV:function(n){this.$2j7(1,_at.$6r.$2pp(n),!0)},$Adw:function(n){this.$2lD<this.$1m8-1&&!this.$j9&&this.$AEv()},$2j7:function(n,t,i){this.$a9=!0;if(this.$j9)_js.Trace.logInfo(_at.$1q.$L,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.get_$194(),n,t);else{_js.Trace.logWarning(_at.$1q.$L,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.get_$194(),n,t);this.$sJ=n;this.$5xx=t;this.$8x&&this.$8x.$45f(this.$9a)&&this.$8x.$1QT(this,!1)}this.$Am("OnUploadFailedEvent",this)},$3B9:function(n){if(_at.$Cq.isInstanceOfType(n)){var t=n;if(t.$4QX<t.$1m8-1)return}this.$4b3(n)},$ADQ:function(){this.set_$75L(!this.$7x&&this.$19.get_$4b6()&&$B(this.$1x.get_$6K())&&!_g.$7W.isInstanceOfType(this.$1x))},$7jB:function(n,t){if(t==="ContentType"||t==="Name"||t==="AttachmentId"){t==="Name"&&this.set_$82s(_a.$6K.$nL(this.$1x.get_$1w()));if(t==="ContentType"||t==="Name"){this.set_$9XT(_at.$6E.get_$P().$4ya(this.$1Md,this.$1x.get_$Kz(),this.$H.get_$T()==="Mouse"||this.$19.get_$2UF(),this.get_$3Pl()));this.$3kR()}if(t==="AttachmentId"){this.$8Yt(this.$1x.get_$6K());this.$ADQ();this.$AEF()}this.$4TQ()}},$7Gf:function(n){var t=this.$1x;n&&t.set_$Cg(n);this.$EBz(t)},$AEw:function(){this.$3iD.$11()},$Ae1:function(){_js.$A.$o(this.$1pf)||this.$2j7(this.$2No,this.$1pf,!1);this.$4b3(null)},$49:function(n){this.$2G?this.get_$J1().$49(0,n,null):_a.$4A.$49(n,1)},$AEt:function(n){this.$7TK()},$AEx:function(){_js.Trace.logInfo(_at.$1q.$L,"Submitting action for PAL attachment upload.");var n=new _at.$1KF(2,this.$1x,this.$8x.get_$FZ(),this.get_$194(),this.$8x.get_$ew());n.add_$2d(this.$$d_$4gV);n.add_$4e(this.$$d_$3B9);OwaApplication.$2D.$1T(n)},$7x4:function(n){_js.Trace.logInfo(_at.$1q.$L,"Not a PAL file attachment.")},$737:function(){_js.Trace.logWarning(_at.$1q.$L,"Opening attachment with download URL {0}",this.$ZM);if(this.$19.get_$8q())if(this.$l_4.$8G(this.$l_4.get_$Ip())&&this.$l_4.get_$Ip().get_$2MP().get_$2Uj()){_js.Trace.logInfo(_at.$1q.$L,"Launch URL from nativeBridge");this.$l_4.get_$Ip().$2Ui(this.$ZM)}else{_js.Trace.logInfo(_at.$1q.$L,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var t=document.createElement("a");t.href=this.$ZM;var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!1,!1,window.self,0,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,0,null);t.dispatchEvent(n)}else this.$7x?this.$VU.$4Gb(this.$ZM,"_self"):this.$VU.$4Gb(this.$ZM,"_blank")},$9Lr:function(n,t){this.$DZ=t;_js.Trace.logInfo(_at.$1q.$L,"Attachment ID: {0}",this.$DZ?this.$DZ.Id:"null")},$3k9:function(){var n=new _fm.$1v(new Array(0));this.get_$C9k()&&this.get_$1ai()&&!this.$7x&&n.$1Y.$F(new _fm.$e(_u.Strings.l_ContextMenu_ManagePermissions_Text,null,this.$6kh));if(this.get_$IR()===4||this.$R1.$1Ss===2||this.get_$4P7())this.get_$4P7()&&this.get_$39U()&&n.$1Y.$F(new _fm.$e(_nbs.NonBootStrings.l_Preview_Text,null,this.$2Cq));else{var i=this.get_$8lH()?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;var t=this.$19.get_$8q()?_nbs.NonBootStrings.l_OpenInDevice_Text:i;n.$1Y.$F(new _fm.$e(t,null,this.$243))}this.set_$2ko(n)},$Dpt:function(){this.$8x.$Dq1(this)},$EBz:function(n){_js.Trace.logInfo(_at.$1q.$L,"Submitting server action for file attachment with content.");var t=new _at.$Cq(2,n,this.$8x.get_$FZ(),this.get_$194(),this.$8x.get_$ew(),this.$2lD,this.$1m8);t.add_$2d(this.$$d_$4gV);t.add_$2x(this.$$d_$Adw);t.add_$4e(this.$$d_$3B9);OwaApplication.$2D.$1T(t)},set_$79t:function(n){this.$5Wb=n;return n},$2lU:function(){if(!this.$8ZP(0)){_js.Trace.logInfo(_at.$1q.$L,"Deleting attachment.");this.$w3=_a.$8.$1g(_a.$0.$1n,"AttachmentDeleteAttachment",!0);this.set_$1hU(!0);var n="";var i=!!this.$1x.get_$6K()&&!!this.$1x.get_$6K().Id&&!this.$1x.get_$6K().Id.startsWith("smime-");if(i){_js.Trace.logInfo(_at.$1q.$L,"Deleting attachment from server.");this.$8x.$1QT(this,!1);this.$8x.$5Vt(this)}else if(this.$7aQ)if(this.get_$61m())this.$4dC();else{_js.Trace.logError(_at.$1q.$L,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");_a.$8.$1I(this.$w3,null,n="DeleteInProcessAttachment",null,this.$3C7(0));this.$w3=null}else{if(_g.$56.isInstanceOfType(this.$1x)){var t=this.$1x;this.$7x4(t)}else _js.Trace.logInfo(_at.$1q.$L,"Not a file attachment.");this.$8x.$1QT(this,!0);_a.$8.$1I(this.$w3,null,"",null,this.$3C7(0));this.$w3=null;n="DeletedWhileInQueue"}this.$2D3&&this.$5oH(n)}},$4dC:function(){if(!this.$43J){_js.Trace.logInfo(_at.$1q.$L,"Cancel attachment with cancellationId {0}",this.get_$194());this.$2Jw=!1;this.set_$8hW(!0);var n=new _at.$1JP(this.get_$194());n.add_$2x(this.$$d_$AVK);n.add_$2d(this.$$d_$AVJ);OwaApplication.$2D.$1T(n)}},$F3C:function(n,t,i){this.set_$7aR(!0);if(this.$jA){_js.Trace.logInfo(_at.$1q.$L,"Attachment skipped because it's been deleted while it was pending.",this.$1x.get_$1w());t(null);return}var u=n;var r=u.Body.ParentItemId;this.$8x.get_$FZ().Id=r.Id;this.$8x.get_$FZ().ChangeKey=r.ChangeKey;this.$3aV=t;this.$8fo(t)},$AEu:function(){this.$3rS=this.$6Et.$65x();var n=!0;_js.$A.$o(this.$8x.get_$ew())||(n=!!this.$Kf_4&&this.$Kf_4.$27r(this.$8x.get_$ew(),"SlicedAttachments"));if(n&&this.$1C&&this.$1C.get_$2a()&&this.$1C.get_$2a().get_$Dqq().Enabled&&this.get_$194()){this.$2lD=-1;this.$1m8=Math.ceil(this.$3MH.get_$8A()/3145728);this.$AEv()}else this.$3rS.$4J5(this.$3MH,this.$$d_$Axh,this.$$d_$6Er,_at.$1q.$L)},$AEv:function(){var t=this.$3MH;this.$2lD++;var n=3145728*this.$2lD;var r=Math.min(n+3145728,t.get_$8A());var i=t.$2jG.slice(n,r);this.$3rS.$4J5(new _h.$178(i),this.$$d_$Axh,this.$$d_$6Er,_at.$1q.$L)},$6Er:function(){this.$2j7(2,_at.$6r.$BlW(this.$3rS),!1);this.$4b3(null)},$Axh:function(n){n.length/1024>this.$Tg?this.$8x.$Bz8(_g.$7g.isInstanceOfType(this.$1x),this):this.$7Gf(n)},$F3A:function(){_js.Trace.logInfo(_at.$1q.$L,"Submitting action for item or id attachment.");var n=new _at.$Cq(2,this.$1x,this.$8x.get_$FZ(),this.get_$194(),this.$8x.get_$ew(),0,1);n.add_$2d(this.$$d_$4gV);n.add_$4e(this.$$d_$3B9);OwaApplication.$2D.$1T(n)},$AiL:function(){var t=this.$8x.get_$FZ();var n=new _g.$1b(t.Id);n.ChangeKey=t.ChangeKey;var i=new _g.$RB(n);return new _g.$RA(null,i)},$4b3:function(n){var t=this.$a9?_y.$NZ.toString(this.$sJ):"";_js.Trace.logInfo(_at.$1q.$L,"Attachment create completed. Status: {0} CancellationId: {1}",t,this.get_$194());if(!this.$j9){if(this.$3aV){n&&this.set_$5qk(n.$Bsv());this.$3aV(this.$3kb)}this.set_$7aR(!1);this.set_$3Yk(!this.$a9&&this.$R1.get_$59O());this.$3k9();if(_g.$7e.isInstanceOfType(this.$1x)){this.$8x.$1QT(this,!1);this.set_$97(n.$1x);this.$4TQ();this.$8x.$1mm(this)}if(this.$EfQ()){_js.Trace.logInfo(_at.$1q.$L,"Incrementing parent well size.");(!n||this.$8x.$45f(this.$9a))&&this.$8x.$j7(this.$1x.get_$8A());this.$AEG()}}this.$Am("OnUploadCompleteEvent",this)},$EfQ:function(){if(this.$a9||this.$j9)return!1;if(this.$19.get_$4b6()||_g.$7W.isInstanceOfType(this.$1x)||_g.$7g.isInstanceOfType(this.$1x))return!0;if(_g.$56.isInstanceOfType(this.$1x)){var n=this.$1x.$M6;if(_y.$vE.isInstanceOfType(n))return!0;if(_y.$II.isInstanceOfType(n))return n.get_$8ly()}return!1},$AVK:function(n){_js.Trace.logInfo(_at.$1q.$L,"Cancel attachment succeeded with cancellationId {0}",this.get_$194());this.set_$7aR(!1);this.$8x&&this.$8x.$45f(this.$9a)&&this.$8x.$1QT(this,!1);this.$7m8(n)},$AVJ:function(n){_js.Trace.logWarning(_at.$1q.$L,"cancel failed with error: {0} and cancellationId: {1}",n&&n.$2I?n.$2I.message:"N/A",this.get_$194());this.$2Jw=!0;this.$7m8(n)},$7m8:function(n){this.$3aV&&this.$3aV(null);this.set_$8hW(!1);this.set_$nZ(!this.$2Jw);this.$Am("OnCancelCompleteEvent",this);var t=this.$2Jw?_at.$6r.$2pp(n):"";if(this.$w3){_a.$8.$1I(this.$w3,null,t,n?n.$FM():null,this.$3C7(2));this.$w3=null}},$AnJ:function(n){_js.Trace.logWarning(_at.$1q.$L,"delete failed with error: {0}",n.$2I.message);this.$a9=!0;this.set_$1hU(!1);this.$8x.$45f(this.$9a)&&!this.$1hg&&this.$8x.$1mm(this);if(this.$w3){_a.$8.$1I(this.$w3,null,_at.$6r.$2pp(n),n?n.$FM():null,this.$3C7(1));this.$w3=null}},$69M:function(n){this.$Am("OnDeleteCompleteEvent",this);if(this.$w3){_a.$8.$1I(this.$w3,null,"",n?n.$FM():null,this.$3C7(1));this.$w3=null}},$Ecl:function(){_y.$9p.$4PV=this.$H.get_$T()==="Mouse"&&this.$H.get_$Bh()&&!this.get_$45m();this.$2f&&this.$8x&&this.$8x.get_$FZ()&&this.$2f.$5RK(this.$8x.get_$FZ())},$Yl:function(){(this.$7x||this.$1x.get_$6K())&&(this.$8ZP(1)||(this.get_$39U()&&!this.get_$4P7()?this.$WH():this.$4lA()))},$8ZP:function(n){if(this.$4bF&&this.$5Wb){_js.Trace.logInfo(_at.$1q.$L,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.set_$4bG(!1);this.$5Wb(this.$1x,n);return!0}return!1},$4lA:function(){this.get_$6cO()&&(_y.$9p.$4PV=this.$H.get_$T()==="Mouse"&&this.$H.get_$Bh()&&!this.get_$45m());if(this.$1x.get_$6K())if(OwaApplication.$Q4){_js.Trace.logInfo(_at.$1q.$L,"GenericMailMode, always download the attachment.");this.$5ZB()}else if(_g.$7e.isInstanceOfType(this.$1x))this.$5RP();else if(_g.$56.isInstanceOfType(this.$1x))this.$5ZB();else if(_g.$7W.isInstanceOfType(this.$1x)){var n=this.$1x;n.get_$x()?this.$5RP():n.get_$bS()?this.$5RP():this.$5ZB()}else this.$5ZB()},$5RP:function(){if(!this.get_$AWB()){_js.Trace.logInfo(_at.$1q.$L,"Unsupported item.");this.$49(_nbs.NonBootStrings.l_ItemAttachmentNotSupported_Text);return}if(this.$1x.get_$28Q()){var n=this;this.$w9(function(t){t.$ALZ();n.$9UG()})}else this.$9UG()},$9UG:function(){var n={};n.AttachmentItemID=this.$1x.get_$6K().Id;this.$AZ&&(n.IsDiscovery="1");_js.Trace.logInfo(_at.$1q.$L,"Opening item attachment in pop-out window.");this.$H.$A3(IItemAttachmentPopOutFactory,null,n,_bc.$2V.get_$to())},$5ZB:function(){this.$ExK();this.$1x?this.$1x.get_$6K()?_js.Trace.logInfo(_at.$1q.$L,"SafeOpenAttachment: Name={0}, ID={1}",this.$1x.get_$1w(),this.$1x.get_$6K().Id):_js.Trace.logWarning(_at.$1q.$L,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.$1q.$L,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.$1q.$L,"SafeOpenAttachment: Policy={0}",this.$R1.toString());if(this.$R1.$3Fj){_js.Trace.logInfo(_at.$1q.$L,"Attachment policy forces browser viewing.");this.$H.get_$T()==="Mouse"?this.$49(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlert_Text):this.$49(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlertNonMouse_Text);return}if(!this.$R1.$1UH){this.$49(_nbs.NonBootStrings.l_DirectFileAccessDisabled_Text);return}if(this.$R1.$1Ss===1){this.$49(_nbs.NonBootStrings.l_BlockedAlert_Text);return}if(this.get_$3Pl()){var n=this;this.$w9(function(n){n.$E93()});return}if(this.$R1.$1Ss===2){this.$Ei8();return}this.$1x&&this.get_$61V()&&this.$737()},$Ei8:function(){if(this.$H.get_$T()==="Mouse"){_js.Trace.logInfo(_at.$1q.$L,"Attachment policy forces save.");this.$19.get_$E1()?this.$49(_nbs.NonBootStrings.l_IE_ForceSaveAlert_Text):this.$49(_nbs.NonBootStrings.l_Default_ForceSaveAlert_Text)}else{_js.Trace.logInfo(_at.$1q.$L,"Attachment policy forces save, but device doesn't support download.");this.$49(_nbs.NonBootStrings.l_UnsupportedAttachment_Text)}},$WH:function(){if(this.$1x){if(this.$2JI){this.$2JI.$437()&&this.$8x.$4OQ(this.$1x.get_$6K());this.$2JI.$WH();return}if(this.$1EM){var n=this;this.$1EM.$I(function(t){if(!n.$8x){_js.Trace.logError(_a.$0.$1n,"Preview: Parent well is null.");return}n.set_$AQh(t.$I(n,n.$8x.get_$7jG(),n.$Qb,n.$6k));n.$2JI.$437()&&n.$8x.$4OQ(n.$1x.get_$6K());n.$2JI.$WH()})}}},$8Yt:function(n){var t=this.$DZ;t!==n&&this.$9Lr(t,n)},$AEG:function(){this.set_$4PS(this.$2yM||_g.$7W.isInstanceOfType(this.$1x)&&!this.$1x.get_$8A()||_g.$56.isInstanceOfType(this.$1x)&&_y.$vE.isInstanceOfType(this.$1x.$M6)&&!this.$1x.get_$8A()||_g.$56.isInstanceOfType(this.$1x)&&_y.$II.isInstanceOfType(this.$1x.$M6)&&!this.$1x.get_$8A())},$5qI:function(){this.get_$1ai()&&(this.$1x.get_$6K()?this.get_$Pd()===2?this.set_$7R4(!0):this.set_$7R4(!1):this.set_$7R4(!0))},$ExK:function(){if(!this.get_$3Pl()&&this.get_$9LP()){var n=_g.$1R.$1M.$1gy(this.$1x.get_$6K());this.$1x.get_$6K().Id!==n.Id&&this.$1x.set_$6K(n)}},$NO:function(){var n=new _a.$48;n.$5F("S",this.$1x.get_$8A());n.$5F("W",this.$8x.get_$ew()?1:0);n.$5F("C",this.$j9?1:0);n.$C7("E",this.$1Md);return n.toString()},$3C7:function(n){var t=new _a.$48;t.$5F("S",this.$1x.get_$8A());var i="A";_at.$i3.isInstanceOfType(this)?i="C":this.get_$IR()===5?i="T":this.$1x.get_$Cn()&&(i="I");t.$C7("T",i);t.$5F("O",n);t.$5F("W",this.$8x.get_$ew()?1:0);this.$382&&t.$C7("Q",this.$382);t.$C7("E",this.$1Md);return t.toString()},$AEF:function(){this.$4("ShouldAffordanceMenuBeHidden")},$w9:function(n){if(this.get_$3Pl()){_js.Trace.logInfo(_a.$0.$54,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.$CI.$I(function(i){if(!t.$4Qa){_js.Trace.logInfo(_a.$0.$54,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.$4Qa=i.$Ae7();t.$4Qa.$3f(t.$1x)}_js.Trace.logInfo(_a.$0.$54,"[AttachmentViewModel] Executing smime operation.");n(t.$4Qa)})}},$8kn:function(){return!!this.$1C&&this.$1C.get_$2a().get_$9WR().Enabled&&(!this.$8x.get_$ew()||!!this.$Kf_4&&this.$Kf_4.$27r(this.$8x.get_$ew(),"PersistAttachmentPermission"))}};_at.$1IM=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$AGJ=_at.$1q;_a.$4.$a(t,"owaShell");_a.$4.$a(i,"palDownloadManager");_a.$4.$a(r,"userAgent");_a.$4.$a(u,"nativeBridge");_a.$4.$a(s,"itemStoreGetterFactory");this.$2f=n;this.$H=t;this.$uI=i;this.$19=r;this.$l=u;this.$38B=f;this.$93=e;this.$1EM=o;this.$1i3=s;this.$5qm=h;this.$CI=c;this.$Kf=l;this.$Cu=a};_at.$1IM.prototype={$H:null,$19:null,$uI:null,$l:null,$93:null,$1EM:null,$1i3:null,$2f:null,$Kf:null,$38B:null,$3nr:null,$AGJ:null,$5qm:null,$CI:null,$Cu:null,$I:function(n,t,i,r,u,f){if(this.$8h4()&&(_g.$7g.isInstanceOfType(n)||_g.$56.isInstanceOfType(n)&&_y.$II.isInstanceOfType(n.$M6))){if(!this.$3nr&&this.$38B){var e=this;this.$38B.$I(function(n){e.$3nr=n})}_a.$4.$y(this.$3nr,"attachmentProviderItemViewModelFactory");return this.$3nr.$I(n,this.$H,t,i,r,this.$19)}else if(_g.$56.isInstanceOfType(n)&&_y.$vE.isInstanceOfType(n.$M6)){_a.$4.$y(this.$5qm,"uriFileAttachmentViewModelFactory");return this.$5qm.$I(n,this.$H,t,i,r,this.$19)}else return new _at.$3I(n,this.$H,t,i,r,this.$uI,this.$2f,this.$l,this.$19,this.$93,this.$1EM,this.$1i3,u,f,this.$CI,this.$Kf,this.$Cu)},$4gU:function(n,t,i,r,u,f,e){if(this.$8h4()&&this.$38B&&(_g.$7g.isInstanceOfType(n)||_g.$56.isInstanceOfType(n)&&_y.$II.isInstanceOfType(n.$M6))){var o=this;var h=function(f){var e=f.$I(n,o.$H,t,i,r,o.$19);u(e)};this.$38B.$I(h)}else{var s=new _at.$3I(n,this.$H,t,i,r,this.$uI,this.$2f,this.$l,this.$19,this.$93,this.$1EM,this.$1i3,f,e,this.$CI,this.$Kf,this.$Cu);u(s)}},$Adt:function(n,t,i,r,u,f,e){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.$7uc(n,0,new Array(0),t,i,r,u,f,e)},$7uc:function(n,t,i,r,u,f,e,o,s){var h=this;this.$4gU(n[t],r,u,f,function(c){Array.add(i,c);t<n.length-1?h.$7uc(n,t+1,i,r,u,f,e,o,s):e(i)},o,s)},$8h4:function(){return!this.$93||!this.$Cu?!1:this.$93.get_$2a().get_$38C().Enabled&&this.$Cu.AttachmentDataProviderAvailable}};_at.$fo=function(n){this.$3nu=n};_at.$fo.prototype={$3nu:null};_at.$6r=function(){};_at.$6r.$2pp=function(n){var t;if(n){if(_h.$1AG.isInstanceOfType(n)&&(t=n.get_$2Hx())){if(t.responseCode)return t.responseCode;if(t.response){if(t.response.fault){var r=t.response.fault;var i=_at.$6r.$8Sy(r);if(i)return i}if(t.response.statusCode)return _at.$6r.$6Gh(t.response.statusCode)}}if(n.$2I)return _at.$6r.$3zj(n.$2I)}return"UnknownError_Action"};_at.$6r.$3zj=function(n){if(n){var t;if(t=n.responseCode)return t.toString();if(t=n.StackTrace)return _at.$6r.$8Sz(t.toString());if(t=n.ErrorCode)return _at.$6r.$6Gh(t);if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.$6r.$8Sy=function(n){if(n){if(n.ResponseCode)return n.ResponseCode;if(n.StackTrace)return _at.$6r.$8Sz(n.StackTrace);if(n.ErrorCode)return _at.$6r.$6Gh(n.ErrorCode)}return null};_at.$6r.$8Sz=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.$6r.$6Gh=function(n){return"HTTP_"+n};_at.$6r.$BlW=function(n){var i=n.get_$Lc();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.$6r.$6Es.length?_at.$6r.$6Es[t]:_at.$6r.$3zj(i)}return n.get_$3Ef()?_at.$6r.$3zj(n.get_$3Ef()):"UnknownError_FileReader"};_at.$i3=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$Ae0=Function.createDelegate(this,this.$Ae0);this.$$d_$AQB=Function.createDelegate(this,this.$AQB);_at.$i3.initializeBase(this,[n,t,i,r,u,s,f,h,c,l,a,v,y,p,w,h]);this.$QK=e;this.$m=o};_at.$i3.$AcQ=function(n){return n&&n.ResultCode===10?5:1};_at.$i3.prototype={$m:null,$QK:null,$5Wk:function(){var n=_g.$1R.$aD;n?n.$E0r(this.get_$WW(),this.$$d_$AQB,this.get_$Bo()):this.$QK.$2DP(this.get_$WW(),_a.$0.$4F,this.get_$Bo(),this.$$d_$AQB,0)},$AAt:function(){var n=_g.$1R.$aD;n?n.$EwO(this.get_$WW(),this.$$d_$AQB):this.$QK.$35B(this.get_$WW(),this.$$d_$AQB)},$3B9:function(n){this.$AAt();_at.$1q.prototype.$3B9.call(this,n)},$Ae0:function(n){this.$4gV(n);this.$3B9(null)},$AQB:function(n){var i=null;var t=n;i=n?this.$9Z3(t.Response):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.$2j7(_at.$i3.$AcQ(t),i,!0)}else this.$9ZQ(t);this.$3B9(null)},$9ZQ:function(n){},$9Z3:function(n){var r=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var i=n.ResponseMessages.Items[0];this.$1x.set_$8A(i.Attachments[0].Size);_at.$Cq.$9Yv(i,this.$1x,this.$8x.get_$FZ(),!0);if(_g.$7g.isInstanceOfType(this.$1x)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var t=i.Attachments[0];if(t.AttachLongPathName){this.$1x.set_$2j6(t.AttachLongPathName);this.$1x.set_$17K(t.ProviderType);this.$1x.set_$1xI(t.ProviderEndpointUrl);this.$1x.set_$TH(t.ContentId)}if(!$B(t.PermissionType)){this.$1x.set_$1QC(t.PermissionType);this.$5qI()}this.$1x.set_$1w(t.Name)}}else r="The response message received is null";return r}};_at.$15o=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_at.$15o.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,null,null,l,a,v,y])};_at.$15o.$4ph=function(){return"UriFileAttachmentNotification"+(_a.$7.get_$3A().$8w()+_ff.$98.$3aj(0,1e3)).toString()};_at.$15o.prototype={$ND:null,get_$WW:function(){this.$ND||(this.$ND=_at.$15o.$4ph());return this.$ND},set_$WW:function(n){this.$ND=n;return n},get_$Bo:function(){return"UriFileAttachmentViewModel"},get_$61m:function(){return!1},$8fo:function(n){if(_g.$56.isInstanceOfType(this.$1x)&&_y.$vE.isInstanceOfType(this.$1x.$M6)){_js.Trace.logInfo(_a.$0.$4F,"Uploading attachment from URL");var i=this.$1x.$M6;this.$5Wk();var t=new _at.$1KD(this.$8x.get_$FZ(),i.get_$F3K(),i.get_$1w(),this.get_$WW());t.add_$2d(this.$$d_$Ae0);this.$m.$1T(t)}else{_js.Trace.logError(_a.$0.$4F,"Unsupported upload type detected in addFileAttachment");n(null)}},$ADQ:function(){this.set_$75L(!1)}};_at.$1Gz=function(n,t,i,r,u,f,e,o,s,h){this.$QK=n;this.$m=t;this.$2f=i;this.$1C=r;this.$1EM=u;this.$CI=e;this.$Cu=s;this.$l=h};_at.$1Gz.prototype={$QK:null,$m:null,$2f:null,$1C:null,$Kf:null,$1EM:null,$l:null,$CI:null,$Cu:null,$I:function(n,t,i,r,u,f){return new _at.$15o(n,t,i,r,u,f,this.$QK,this.$m,this.$2f,this.$1C,this.$1EM,this.$CI,this.$Kf,this.$Cu,this.$l)}};_at.$1M6=function(n){this.$2B=n;this.$3Qi={};this.$28u=new(_ff.$1E.$$(_at.$Tj))};_at.$1M6.prototype={$2B:null,$3Qi:null,$28u:null,get_$9:function(){return this.$28u.get_$9()},$5l:function(n){_a.$4.$1q(n,"attachmentId");return n in this.$3Qi},$F:function(n){this.$62E(n);if(!this.$5l(n.$DZ)){this.$3lI("FastLookupQueue. Adding {0}",n);this.$28u.$F(n);this.$3Qi[n.$DZ]=""}},$7W:function(n,t){this.$62E(t);if(!this.$5l(t.$DZ)){this.$3lI("FastLookupQueue. InsertAt {0}",t);this.$28u.$1XM(n,t);this.$3Qi[t.$DZ]=""}},$AoG:function(){this.$3lI("FastLookupQueue. DeQueue. Current count {0}",this.get_$9());if(this.get_$9()>0){var n=this.$28u.get_$D(0);this.$3K(n);return n}else return null},$3K:function(n){this.$62E(n);this.$3lI("FastLookupQueue. Remove. Current count {0}",this.get_$9());if(this.$5l(n.$DZ)){this.$3lI("FastLookupQueue. Remove. Found {0}",n);delete this.$3Qi[n.$DZ];for(var i=-1,t=0;t<this.$28u.get_$9();t++)if(this.$28u.get_$D(t).$DZ===n.$DZ){i=t;break}if(i!==-1){this.$28u.$5g(i);this.$3lI("FastLookupQueue. Returning from remove after removal. Current Count {0}",this.get_$9())}}},$62E:function(n){_a.$4.$a(n,"parameter");_a.$4.$a(n.$DZ,"AttachmentId")},$3lI:function(n,t){}};_at.$B2=function(){};_at.$B2.$737=function(n,t,i,r,u,f,e){_a.$4.$a(n,"initNativeBridge");_a.$4.$a(t,"initClientStore");_a.$4.$a(i,"initAttachmentInfoRecord");_a.$4.$1q(r,"initMimeType");_a.$4.$1q(u,"fileName");_a.$4.$a(f,"initOnOpenAttachmentSuccess");_a.$4.$a(e,"initOnOpenAttachmentError");if(_at.$B2.$57O){_js.Trace.logInfo(_at.$B2.$L,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.$B2.$L,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.$B2.$57O=!0;n.get_$Ip().$Dpa(i.DataID,r,u,function(n){_at.$B2.$Dgh(n,i,t,f,e)});t.$8RE(i.AttachmentId,function(n){},null)};_at.$B2.$BlV=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.NonBootStrings.l_UnableToFindActivity_Text;break;case 2:t=_nbs.NonBootStrings.l_DownloadAttachmentAgain_Text;break;default:break}_js.Trace.logInfo(_at.$B2.$L,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.$B2.$Dgh=function(n,t,i,r,u){_at.$B2.$57O=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.$7wt(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.$B2.$L,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.$B2.$L,"OnOpenDocument succeeded");r()}};_at.$4f=function(n,t,i){this.$$d_$DYY=Function.createDelegate(this,this.$DYY);this.$$d_$Dfk=Function.createDelegate(this,this.$Dfk);this.$$d_$9SF=Function.createDelegate(this,this.$9SF);_a.$4.$a(n,"initNativeBridge");var r=t?t.get_$4RB():null;this.$l=n;this.$4eS=i;this.$42=n.get_$74i().$6ed(r);this.$3f(t)};_at.$4f.prototype={$42:!1,$1MN:null,$Vc:null,$1eV:null,$3rH:0,$2m4:null,$l:null,$4eS:null,$Ae:null,get_$1TM:function(){if(!this.$42&&_g.$1R.$1M){var n=_bc.$Sq.isInstanceOfType(_g.$1R.$1M)?_g.$1R.$1M:null;this.$42=this.$l.get_$74i().$6ed(n?n.get_$A6():null);this.$3f(n?n.get_$4y().get_$2JH():null)}return this.$42},$1l:function(n,t){_a.$4.$1q(n,"attachmentId");_a.$4.$a(t,"callbacks");if(this.get_$1TM()){this.$2m4[n]=t;this.$AyV(n,t)}else _js.Trace.logInfo(_at.$4f.$L,"PAL does not support download.")},$2gV:function(n){_a.$4.$1q(n,"attachmentId");this.get_$1TM()&&n in this.$2m4&&delete this.$2m4[n]},$4lA:function(n){_a.$4.$a(n,"parameters");_a.$4.$a(n.$DZ,"AttachmentId");_a.$4.$a(n.$ZM,"DownloadUrl");_js.Trace.logInfo(_at.$4f.$L,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.get_$1TM()){if(!(n.$DZ in this.$2m4))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.$Ef9(n);if(_js.$A.$o(t)){if((!this.$Vc||this.$Vc.$DZ!==n.$DZ)&&!this.$1MN.$5l(n.$DZ)){_js.Trace.logInfo(_at.$4f.$L,"Starting download for {0}",n);if(n.$6dH){this.$1MN.$7W(0,n);if(this.$Vc){this.$7mC();this.$1MN.$7W(1,this.$1eV);this.$2aL(this.$1eV,2)}else{this.$2aL(n,2);this.$5lA()}}else{this.$1MN.$F(n);this.$2aL(n,2);this.$5lA()}}}else this.$4J1(n,t)}},$GO:function(n){_a.$4.$a(n,"parameters");_a.$4.$a(n.$DZ,"AttachmentId");_js.Trace.logInfo(_at.$4f.$L,"Cancel download for parameters {0}",n);if(this.get_$1TM())if(this.$1MN.$5l(n.$DZ)){this.$1MN.$3K(n);_js.Trace.logInfo(_at.$4f.$L,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.$1MN.get_$9());this.$2aL(n,1)}else if(this.$Vc&&this.$Vc.$DZ===n.$DZ){_js.Trace.logInfo(_at.$4f.$L,"Current Download was canceled. {0}",this.$Vc);this.$7mC();this.$2aL(this.$1eV,1)}},$Bwe:function(n){var t=null;switch(n){case 0:break;case 7:break;case 3:t=_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text;break;case 8:break;case 1:case 4:var r=this,i=this;this.$4eS.$AY4(this.$Ae,this.$l,function(){_js.Trace.logInfo(_at.$4f.$L,"Successfully completed CleanAllPalAttachmentInfoAndAttachments")},function(n){_js.Trace.logWarning(_at.$4f.$L,"CleanAllPalAttachmentInfoAndAttachments failed due to error {0}",n)});t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 5:t=_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text;break;case 6:t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 9:t=_nbs.NonBootStrings.l_UnableToDownload_Text;break;case 2:t=_nbs.NonBootStrings.l_UnknownDataIDType_Text;break;default:break}return t},$3f:function(n){if(this.$42){this.$Ae=n;this.$1MN=new _at.$1M6(_at.$4f.$L);this.$2m4={};this.$1eV=null;this.$Vc=null;this.$3rH=0}},$7mC:function(){_js.Trace.logInfo(_at.$4f.$L,"CancelCurrentDownload, canceling the current download");this.$l.get_$1w2().$AVT();this.$1eV=this.$Vc;this.$Vc=null},$5lA:function(){_js.Trace.logInfo(_at.$4f.$L,"Inside StartDownloadInternal");if(this.$1eV)_js.Trace.logInfo(_at.$4f.$L,"Still waiting for the canceled download to get canceled.");else if(this.$Vc)_js.Trace.logInfo(_at.$4f.$L,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.$4f.$L,"StartDownloadInternal, pending items in queue {0}",this.$1MN.get_$9());this.$Vc=this.$1MN.$AoG();this.$3rH=0;if(this.$Vc){_js.Trace.logInfo(_at.$4f.$L,"Starting download {0}",this.$Vc);this.$2aL(this.$Vc,3);var n=this;this.$4eS.$EnQ(this.$Ae,this.$l,this.$$d_$9SF,function(t){_js.Trace.logWarning(_at.$4f.$L,"Scheduled cleanup failed due to error {0}",t);n.$9SF()})}else _js.Trace.logInfo(_at.$4f.$L,"Download queue is empty.")}},$9SF:function(){_js.Trace.logInfo(_at.$4f.$L,"Starting the download now for {0}",this.$Vc);if(this.$1eV){this.$1eV=null;this.$5lA()}else this.$l.get_$1w2().$ArT(this.$Vc.$ZM,1,this.$Vc.$1Md,this.$Vc.$2XT,this.$$d_$Dfk,this.$$d_$DYY)},$Dfk:function(n){if(this.$Vc){this.$3rH+=n;var t=this;this.$4nz(this.$Vc,function(n){n.$9NQ(t.$3rH)})}},$2aL:function(n,t){var i=this;this.$4nz(n,function(n){n.$2xn(t)})},$4J1:function(n,t){var i=this;this.$4nz(n,function(i){_js.Trace.logWarning(_at.$4f.$L,"Raising OnError event with error {0} for attachment {1}",t,n);i.$Tt(t)})},$4nz:function(n,t){var i=this.$2m4[n.$DZ];i&&t(i)},$DYY:function(n,t,i){_js.Trace.logInfo(_at.$4f.$L,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.$Vc);if(this.$1eV)this.$1eV=null;else if(n||t!==200){var f=this.$Bwe(n);_js.$A.$o(f)||this.$4J1(this.$Vc,f);this.$2aL(this.$Vc,1)}else{var r=this.$Vc;var u=new AttachmentInfoRecord(this.$Vc.$DZ,i,this.$Vc.$4bA,_a.$7.get_utcNow().$8w(),this.$Vc.$5SR,0,_a.$7.$B1u(_a.$7.get_utcNow()),!0);var e=this,s=this;this.$Ae.$9gt(u,function(n){_js.Trace.logInfo(_at.$4f.$L,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.$4f.$L,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.$2aL(r,4);var o=this;this.$4nz(r,function(n){_js.Trace.logInfo(_at.$4f.$L,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.$9Ls(u)})}this.$Vc=null;this.$5lA()},$Ef9:function(n){var t=null;if(_bc.$9w.$8ha(n.$DZ)){_js.Trace.logInfo(_at.$4f.$L,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$A.$o(n.$5SR)){_js.Trace.logInfo(_at.$4f.$L,"Attachment is a quick message {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$A.$o(n.$2XT)){_js.Trace.logInfo(_at.$4f.$L,"Attachment does not have content type set. {0}",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(_js.$A.$o(n.$1Md)){_js.Trace.logInfo(_at.$4f.$L,"Attachment does not have a valid file name {0}.",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(this.$1MN.get_$9()===10){_js.Trace.logInfo(_at.$4f.$L,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.NonBootStrings.l_DownloadAttachmentQueueMaxSizeReached_Text,10)}return t},$AyV:function(n,t){if(this.$Vc&&n===this.$Vc.$DZ){_js.Trace.logInfo(_at.$4f.$L,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.$2xn(3)}else if(this.$1MN.$5l(n)){_js.Trace.logInfo(_at.$4f.$L,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.$2xn(2)}else{var r=this,i=this;this.$Ae.$9g7(n,function(i){if(i){_js.Trace.logInfo(_at.$4f.$L,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.$2xn(4);t.$9Ls(i)}else{_js.Trace.logInfo(_at.$4f.$L,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.$2xn(1)}},function(i){_js.Trace.logWarning(_at.$4f.$L,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.$2xn(1)})}}};_at.$Tj=function(){};_at.$Tj.$AiS=function(n){_a.$4.$a(n,"viewModel");_a.$4.$a(n.$ZM,"DownloadUrl should not be empty");var t=null;n.$8x&&n.$8x.get_$FZ()&&(t=n.$8x.get_$FZ().Id);return _at.$Tj.$7u3(n.$1x,n.$1x.get_$1w(),n.$1x.get_$Kz(),n.$ZM,t,!1)};_at.$Tj.$7u3=function(n,t,i,r,u,f){_a.$4.$a(n,"attachment");_a.$4.$a(n.get_$6K(),"attachmentId");_a.$4.$a(r,"downloadUrl");_a.$4.$a(r,"destinationFileName");var e=new _at.$Tj;e.$DZ=n.get_$6K().Id;e.$4bA=n.get_$8A();e.$1Fb=t;e.$1Md=_a.$6K.$nL(e.$1Fb);e.$2XT=i;e.$ZM=_a.Uri.$30C(r);e.$5SR=u;e.$6dH=f;_js.$A.$o(e.$2XT)&&!_a.UserAgent.getInstance().$XA&&(e.$2XT="fakeMimeType");return e};_at.$Tj.prototype={$2XT:null,$1Fb:null,$1Md:null,$DZ:null,$5SR:null,$ZM:null,$4bA:0,$6dH:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.$1Fb,this.$4bA,this.$2XT,this.$DZ)}};_at.$3I=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_at.$3I.initializeBase(this,[n,t,i,r,u,e,s,h,c,a,v,y,p,w,o,h]);_a.$4.$y(f,"palDownloadManager");_a.$4.$y(o,"nativeBridge");_a.$4.$y(l,"itemStoreGetter");this.$uI=f;this.$l=o;this.$1i3=l;this.$Kf=p;this.$1x&&this.$A6A(null,this.$1x.get_$6K())};_at.$3I.prototype={$l:null,$uI:null,$Kf:null,$1i3:null,$5y4:null,$2yA:0,$4H5:null,set_$74h:function(n){this.$2yA=n;this.$4("PALAttachmentDownloadStatus");return n},set_$Dr0:function(n){this.$4H5=n;this.$4("PALAttachmentCurrentDowloadedBytes");return n},get_$9LP:function(){return _at.$1q.prototype.get_$9LP.call(this)||_g.$56.isInstanceOfType(this.$1x)&&_a.$a0.isInstanceOfType(this.$1x.$M6)},get_$39U:function(){var n=_at.$1q.prototype.get_$39U.call(this);if(n&&this.$l&&this.$l.$8G(this.$l.get_$Ip())){var t=this.$l.$2r(_a.$18e,2);_js.Trace.logInfo(_at.$3I.$L,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},get_$9VK:function(){return this.$19.get_$8q()&&this.$7x},get_$7Q0:function(){return this.get_$39U()&&!this.get_$4P7()?!1:this.$uI.get_$1TM()&&this.$7x},get_$uO:function(){return!this.$R1.$1UH||this.$uI.get_$1TM()||this.$R1.$3Fj||this.$1x.get_$YW()?!0:!1},$7Yg:function(){this.$Ewk()},$2xn:function(n){_js.Trace.logInfo(_at.$3I.$L,"Got attachment status {0}",n);this.set_$74h(n)},$9NQ:function(n){this.set_$Dr0(String.format(_nbs.NonBootStrings.l_DownloadAttachmentProgress_Text,this.$7rM(n,1),this.$7rM(this.$1x.get_$8A(),0)))},$Tt:function(n){_js.Trace.logWarning(_at.$3I.$L,"Unable to download attachment with name {0} and error is {1}",this.$1x.get_$1w(),n);this.$49(n)},$9Ls:function(n){_js.Trace.logInfo(_at.$3I.$L,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.$5y4=n},$AEt:function(n){_a.$a0.isInstanceOfType(n.$M6)?n.get_$Cn()?this.$7TK():this.$AEx():_at.$1q.prototype.$AEt.call(this,n)},$7x4:function(n){if(_a.$a0.isInstanceOfType(n.$M6)){_js.Trace.logInfo(_at.$3I.$L,"Deleting file attachment via PAL.");var t=n.$M6;this.$l.get_$2n().$1oq(t.get_$23b())}else _at.$1q.prototype.$7x4.call(this,n)},$737:function(){if(this.$uI.get_$1TM()){_js.Trace.logInfo(_at.$3I.$L,"Will use PAL to open attachment.");this.$DpT()}else _at.$1q.prototype.$737.call(this)},$9Lr:function(n,t){this.$A6A(n,t);_at.$1q.prototype.$9Lr.call(this,n,t)},$DpT:function(){_js.Trace.logInfo(_at.$3I.$L,"OpenAttachmentUsingPAL, download status={0}",this.$2yA);if(!this.$8x.$45f(this.$9a)){_js.Trace.logWarning(_at.$3I.$L,"The context has changed from "+this.$9a+" to "+this.$8x.get_$1ep()+", opening attachment using PAL has been skipped.");return}if(this.$8x.get_$6bu()||!this.$7x){_js.Trace.logInfo(_at.$3I.$L,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.$8x.get_$6bu(),this.$7x);return}this.$F0U();var t=_at.$Tj.$AiS(this);_js.Trace.logInfo(_at.$3I.$L,"PAL attachment download parameters: {0}",t.toString());switch(this.$2yA){case 0:case 1:this.$9NQ(0);_js.Trace.logInfo(_at.$3I.$L,"Starting PAL attachment download.");this.$uI.$4lA(t);break;case 3:case 2:_js.Trace.logInfo(_at.$3I.$L,"Canceling PAL attachment download.");this.$uI.$GO(t);break;case 4:_js.Trace.logInfo(_at.$3I.$L,"PAL attachment download complete.");var n=this;this.$1i3.$I(function(){var i=n.$1i3.get_$1b().$I(_g.$Q.get_$P().get_$1f().get_$HI());_at.$B2.$737(n.$l,i.get_$2JH(),n.$5y4,t.$2XT,t.$1Fb,function(){_js.Trace.logInfo(_at.$3I.$L,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.$3I.$L,"Attachment open failed with errorCode {0}",t);t===2&&n.set_$74h(1);var i=_at.$B2.$BlV(t);n.$49(i)})});break;default:break}},$A6A:function(n,t){if(this.$uI)if(_g.$7e.isInstanceOfType(this.$1x)){_js.Trace.logInfo(_at.$3I.$L,"ItemAttachment for PAL status:Downloaded");this.set_$74h(4)}else if(this.$uI.get_$1TM()){!$B(n)&&n.Id&&this.$uI.$2gV(n.Id);!$B(t)&&t.Id&&this.$uI.$1l(t.Id,this)}},$Ewk:function(){if(this.$uI.get_$1TM()&&this.$1x&&this.$1x.get_$6K()&&!_g.$7e.isInstanceOfType(this.$1x)){_js.Trace.logInfo(_at.$3I.$L,"Unsubscribing for attachment with name {0} and id {1}",this.$1x.get_$1w(),this.$1x.get_$6K());this.$uI.$2gV(this.$1x.get_$6K().Id)}},$7rM:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.Strings.l_SizeWithGigabyteAbbreviation_Text}else if(n>=1048576){r/=1048576;i=_u.Strings.l_SizeWithMegabyteAbbreviation_Text}else if(n>=1024){r/=1024;i=_u.Strings.l_SizeWithKilobyteAbbreviation_Text}else i=_u.Strings.l_SizeWithByteAbbreviation_Text;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},$F0U:function(){if(this.$19.get_$dJ()&&(_js.$A.$1k(this.$1x.get_$Kz())||_at.$3I.$4pm===this.$1x.get_$Kz().toLowerCase())){var t=_a.$6K.$nL(this.$1x.get_$1w());var n;if(_js.$A.$1k(t))n=_at.$3I.$4pm;else{n=_at.$3I.$82M[t.toLowerCase()];_js.$A.$o(n)&&(n=_at.$3I.$4pm)}_js.Trace.logInfo(_at.$3I.$L,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.$1x.get_$1w()||"<NULL>",t||"<NULL>",this.$1x.get_$Kz()||"<NULL>",n);this.$1x.set_$Kz(n)}}};_at.$1Wt=function(){};_at.$1Wt.prototype={get_$1TM:function(){return!1},$1l:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},$2gV:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$4lA:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$GO:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.$sT=function(){};_at.$sT.prototype={$4O:function(n,t){return String.format(_nbs.NonBootStrings.l_AttachmentParenthesisFormat_Text,n)},$7r2:function(n,t){throw Error.notImplemented();}};_at.$1LV=function(){};_at.$1LV.prototype={};_at.$1LV.registerEnum("_at.$1LV",!1);_at.$1I9=function(){};_at.$1I9.prototype={$4O:function(n,t){var r=n;var i=_js.$1S.$1J8(_a.$CP,t.toString());return r!==i},$7r2:function(n,t){throw Error.notImplemented();}};_at.$yE=function(){};_at.$yE.prototype={$4O:function(n,t){var i=n;return!i||!i.$1x?"":i.get_$IR()!==1&&i.get_$IR()!==2?"":_js.$A.$o(i.$1x.get_$4S9())?i.get_$wy():"data:"+i.$1x.get_$A7v()+";base64,"+i.$1x.get_$4S9()},$7r2:function(n,t){throw Error.notImplemented();}};_at.$13N=function(){};_at.$13N.prototype={$4O:function(n,t){var i=n;var r=!0;try{var u=_js.$1S.$1J8(_at.$1LV,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},$7r2:function(n,t){throw Error.notImplemented();}};_at.$1KD.registerClass("_at.$1KD",_h.$1HF.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.$1e2);_at.$fg.registerClass("_at.$fg",_b.$Lz);_at.$57.registerClass("_at.$57",_b.$FH);_at.$6E.registerClass("_at.$6E");_at.$1IJ.registerClass("_at.$1IJ");_at.$10A.registerClass("_at.$10A",null,_at.$1cn);_at.$19G.registerClass("_at.$19G");_at.$1JP.registerClass("_at.$1JP",_h.$1HF.$$(Boolean),_a.$1As);_at.$Cq.registerClass("_at.$Cq",_h.$fu.$$(_g.$KD,_g.$Ve));_at.$1KF.registerClass("_at.$1KF",_at.$Cq);_at.$1Kq.registerClass("_at.$1Kq",_h.$fu.$$(_g.$OC,_g.$Wl));_at.$iV.registerClass("_at.$iV",_h.$fu.$$(_g.$Rd,_g.$Ve));_at.$1Mw.registerClass("_at.$1Mw",_h.$1HF.$$(String));_at.$Aq.registerClass("_at.$Aq");_at.$yB.registerClass("_at.$yB",_a.$AI);_at.$1q.registerClass("_at.$1q",_a.$Ew,_y.$Sb,_js.$1BC);_at.$1IM.registerClass("_at.$1IM",null,IAttachmentViewModelFactory);_at.$fo.registerClass("_at.$fo");_at.$6r.registerClass("_at.$6r");_at.$i3.registerClass("_at.$i3",_at.$1q);_at.$15o.registerClass("_at.$15o",_at.$i3);_at.$1Gz.registerClass("_at.$1Gz",null,IUriFileAttachmentViewModelFactory);_at.$1M6.registerClass("_at.$1M6");_at.$B2.registerClass("_at.$B2");_at.$4f.registerClass("_at.$4f",null,_at.$Zo);_at.$Tj.registerClass("_at.$Tj");_at.$3I.registerClass("_at.$3I",_at.$1q,_at.$1cG);_at.$1Wt.registerClass("_at.$1Wt",null,_at.$Zo);_at.$sT.registerClass("_at.$sT",null,_js.$1RY);_at.$1I9.registerClass("_at.$1I9",null,_js.$1RY);_at.$yE.registerClass("_at.$yE",null,_js.$1RY);_at.$13N.registerClass("_at.$13N",null,_js.$1RY);AttachmentsComponent.$$cctor();_at.$fg.$1sk=_a.UserAgent.getInstance().$EV&&!_a.UserAgent.getInstance().$ez;_at.$57.$5y8=new _H("Attachment",_g.Attachment,_at.$57);_at.$57.$74u=new _H("ParentItemId",_g.$1b,_at.$57);_at.$57.$2Sy=new _H("IsEnabled",Boolean,_at.$57);_at.$57.$6Eu=new _H("FileSelectedCommand",_js.$DE,_at.$57);_at.$57.$5qi=new _H("UploadAttachmentCommand",_js.$DE,_at.$57);_at.$57.$7aO=new _H("UploadCompletedCommand",_js.$DE,_at.$57);_at.$57.$L=_a.$0.$1n;_at.$6E.$1M=null;_at.$Cq.$L=_a.$0.$1n;_at.$iV.$L=_a.$0.$1n;_at.$Aq.$50j=null;_at.$1q.$L=_a.$0.$1n;_at.$6r.$6Es=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.$B2.$L=_a.$0.$1n;_at.$B2.$57O=!1;_at.$4f.$L=_a.$0.$1n;_at.$3I.$L=_a.$0.$1n;_at.$3I.$4pm="application/octet-stream";_at.$3I.$1Pb="application/vnd.ms-excel";_at.$3I.$6y1="application/msword";_at.$3I.$2wd="application/vnd.ms-powerpoint";_at.$3I.$82M={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.$3I.$1Pb,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.$3I.$6y1,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.$3I.$6y1,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.$3I.$2wd,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.$3I.$2wd,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.$3I.$2wd,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.$3I.$2wd,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.$3I.$2wd,".pwz":_at.$3I.$2wd,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.$3I.$1Pb,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.$3I.$1Pb,".xlc":_at.$3I.$1Pb,".xld":_at.$3I.$1Pb,".xlk":_at.$3I.$1Pb,".xll":_at.$3I.$1Pb,".xlm":_at.$3I.$1Pb,".xls":_at.$3I.$1Pb,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.$3I.$1Pb,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.$3I.$1Pb,".xlw":_at.$3I.$1Pb,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
