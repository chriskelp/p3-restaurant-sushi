try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.o365.suiteserviceproxycommon.js'] = (new Date()).getTime();
Type.registerNamespace("O365SuiteServiceProxy");function MsrCryptoUtils(){}MsrCryptoUtils.$AbA=function(n,t,i){try{var f=MsrCryptoUtils.$34Z(n,!0);var r=new O365SuiteServiceProxy.$1LH;r.name="SHA-256";var u=msrCrypto.subtle.digest(r,MsrCryptoUtils.$34r(f));u.oncomplete=function(n){if(MsrCryptoUtils.$2h5(n,i)){var r=MsrCryptoUtils.$6UM(n.target.result);t(msrCrypto.stringToBase64(MsrCryptoUtils.$604(r,!1)))}};u.onerror=function(n){MsrCryptoUtils.$2h5(n,i)&&i(n.target.result)}}catch(e){i(e.toString())}};MsrCryptoUtils.$AuJ=function(n,t,i,r,u){try{var o=String.format('{{ "kty": "oct", "k": "{0}", "extractable": true }}',MsrCryptoUtils.$7jn(n));var s=MsrCryptoUtils.$34Z(o,!1);var e=new O365SuiteServiceProxy.$16H;e.name="AES-CBC";var f=msrCrypto.subtle.importKey("jwk",MsrCryptoUtils.$34r(s),e,!0,[]);f.oncomplete=function(n){try{var s=n.target.result;var h=MsrCryptoUtils.$34Z(msrCrypto.base64ToString(t),!1);var o=MsrCryptoUtils.$34Z(i,!0);var f=new O365SuiteServiceProxy.$18y;f.iv=MsrCryptoUtils.$34r(h);f.name="AES-CBC";var e=msrCrypto.subtle.encrypt(f,s,MsrCryptoUtils.$34r(o));e.oncomplete=function(n){try{if(MsrCryptoUtils.$2h5(n,u)){var t=MsrCryptoUtils.$6UM(n.target.result);r(msrCrypto.stringToBase64(MsrCryptoUtils.$604(t,!1)))}}catch(i){u(i.toString())}};e.onerror=function(n){MsrCryptoUtils.$2h5(n,u)&&u(n.target.result)}}catch(c){u(c.toString())}};f.onerror=function(n){MsrCryptoUtils.$2h5(n,u)&&u(n.target.result)}}catch(h){u(h.toString())}};MsrCryptoUtils.$AmL=function(n,t,i,r,u){try{var o=String.format('{{ "kty": "oct", "k": "{0}", "extractable": true }}',MsrCryptoUtils.$7jn(n));var s=MsrCryptoUtils.$34Z(o,!1);var e=new O365SuiteServiceProxy.$16H;e.name="AES-CBC";var f=msrCrypto.subtle.importKey("jwk",MsrCryptoUtils.$34r(s),e,!0,[]);f.oncomplete=function(n){try{var s=n.target.result;var h=MsrCryptoUtils.$34Z(msrCrypto.base64ToString(t),!1);var o=MsrCryptoUtils.$34Z(msrCrypto.base64ToString(i),!1);var f=new O365SuiteServiceProxy.$18y;f.iv=MsrCryptoUtils.$34r(h);f.name="AES-CBC";var e=msrCrypto.subtle.decrypt(f,s,MsrCryptoUtils.$34r(o));e.oncomplete=function(n){try{if(MsrCryptoUtils.$2h5(n,u)){var t=MsrCryptoUtils.$6UM(n.target.result);r(MsrCryptoUtils.$604(t,!0))}}catch(i){u(i.toString())}};e.onerror=function(n){MsrCryptoUtils.$2h5(n,u)&&u(n.target.result)}}catch(c){u(c.toString())}};f.onerror=function(n){MsrCryptoUtils.$2h5(n,u)&&u(n.target.result)}}catch(h){u(h.toString())}};MsrCryptoUtils.$34Z=function(n,t){n=t?encodeURI(n):n;for(var r=new Array(n.length),i=0;i<r.length;i++)r[i]=n.charCodeAt(i);return r};MsrCryptoUtils.$604=function(n,t){for(var r="",i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return t?decodeURI(r):r};MsrCryptoUtils.$7jn=function(n){return n.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")};MsrCryptoUtils.$34r=function(n){return window.Uint8Array?new Uint8Array(n):n;return null};MsrCryptoUtils.$6UM=function(n){if(!1===_o365su.$T.$dQ(n.pop))return n;else{var i=new Uint8Array(n);var r=i.length;if(r===1)return i[0];else{for(var u=[],t=0;t<r;t++)u[t]=i[t];return u}return null}};MsrCryptoUtils.$2h5=function(n,t){if(_o365su.$T.$B(n)||_o365su.$T.$B(n.target)||_o365su.$T.$B(n.target.result)){t("result undefined");return!1}else return!0};O365SuiteServiceProxy.$1LH=function(){};O365SuiteServiceProxy.$1LH.prototype={name:null};O365SuiteServiceProxy.$16H=function(){};O365SuiteServiceProxy.$16H.prototype={name:null};O365SuiteServiceProxy.$18y=function(){};O365SuiteServiceProxy.$18y.prototype={name:null,iv:null};O365SuiteServiceProxy.$1VK=function(){};O365SuiteServiceProxy.$1gd=function(){};O365SuiteServiceProxy.$Mw=function(){};O365SuiteServiceProxy.$Mw.$F3L=function(n,t,i){var f="";var u;var e=0;var c=" \"%<>'&";var h=null;if(n===h||typeof n=="undefined"||!n.length)return"";for(e=0;e<n.length;e++){var r=n.charCodeAt(e);var o=n.charAt(e);if(t&&(o==="#"||o==="?")){f+=n.substr(e);break}if(r<=127)i?f+=o:r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r>=32&&r<=95&&c.indexOf(o)<0?f+=o:r<=15?f+="%0"+r.toString(16).toUpperCase():r<=127&&(f+="%"+r.toString(16).toUpperCase());else if(r<=2047){u=192|r>>6;f+="%"+u.toString(16).toUpperCase();u=128|r&63;f+="%"+u.toString(16).toUpperCase()}else if((r&64512)!=55296){u=224|r>>12;f+="%"+u.toString(16).toUpperCase();u=128|(r&4032)>>6;f+="%"+u.toString(16).toUpperCase();u=128|r&63;f+="%"+u.toString(16).toUpperCase()}else if(e<n.length-1){r=(r&1023)<<10;e++;var s=n.charCodeAt(e);r|=s&1023;r+=65536;u=240|r>>18;f+="%"+u.toString(16).toUpperCase();u=128|(r&258048)>>12;f+="%"+u.toString(16).toUpperCase();u=128|(r&4032)>>6;f+="%"+u.toString(16).toUpperCase();u=128|r&63;f+="%"+u.toString(16).toUpperCase()}}return f};O365SuiteServiceProxy.$Mw.$4xE=function(n){for(var f=document.cookie.split(";"),u=null,t=0;t<f.length;t++){var i=f[t];var r=i.indexOf("=");if(r!==-1&&i.substring(0,r).trim()===n){u=i.substr(r+1);break}}return u};O365SuiteServiceProxy.$6h=function(){};O365SuiteServiceProxy.$6h.$1Wp=function(n){var t=n.indexOf("://");t=n.indexOf("/",t+3);t>0&&(n=n.substr(0,t));n.substr(0,8).toLowerCase()==="https://"&&n.substr(n.length-4,4)===":443"?n=n.substr(0,n.length-4):n.substr(0,7).toLowerCase()==="http://"&&n.substr(n.length-3,3)===":80"&&(n=n.substr(0,n.length-3));return n};O365SuiteServiceProxy.$6h.$AcR=function(n){var u=null;if(typeof n=="string"){for(var r=new ArrayBuffer(n.length),f=new Uint8Array(r),i=0;i<n.length;i++)f[i]=n.charCodeAt(i)&255;var t=null;window.BlobBuilder?t=new BlobBuilder:window.MozBlobBuilder&&(t=new MozBlobBuilder);if(t){t.append(r);u=t.getBlob()}else u=r}return u};O365SuiteServiceProxy.$6h.$AcP=function(n){var i="";if(n)for(var r=new Uint8Array(n),t=0;t<n.byteLength;t++)ret=ret+String.fromCharCode(r[t]);return i};O365SuiteServiceProxy.$6h.$EeA=function(n){n.responseType="arraybuffer"};O365SuiteServiceProxy.$6h.$7uG=function(){O365SuiteServiceProxy.$6h.$7Dn++;return O365SuiteServiceProxy.$6h.$9Y8+O365SuiteServiceProxy.$6h.$7Dn.toString()};O365SuiteServiceProxy.$6h.$DrO=function(n){var i="";var t=n.indexOf("?");t>0&&(i=n.substr(t+1,n.length));return i};O365SuiteServiceProxy.$6h.$Btl=function(n){var i="";var t=O365SuiteServiceProxy.$6h.$1Wp(n);var r=n.indexOf("?");i=r>t.length+1?n.substring(t.length+1,r):n.substring(t.length+1,n.length);return i};O365SuiteServiceProxy.$6h.get_emptyCallback=function(){return null};O365SuiteServiceProxy.$1h=function(){};O365SuiteServiceProxy.$1h.$AF=function(n){var t=null;return n===t||typeof n=="undefined"||!n.length};O365SuiteServiceProxy.$1h.$B=function(n){var t=null;return n===t||typeof n=="undefined"};O365SuiteServiceProxy.$1h.$dQ=function(n){return typeof n=="undefined"};O365SuiteServiceProxy.$1h.$Ev4=function(n){try{return JSON.parse(n)}catch(t){return null}};O365SuiteServiceProxy.$1h.$8YE=function(){var n=window.XMLHttpRequest;if(O365SuiteServiceProxy.$1h.$dQ(n))throw O365SuiteServiceProxy.$1h.$Wp("Browser not supported",-2003);return new XMLHttpRequest};O365SuiteServiceProxy.$1h.$7b3=function(n,t){if(!O365SuiteServiceProxy.$1h.$8ix(n))throw O365SuiteServiceProxy.$1h.$2L6(t);};O365SuiteServiceProxy.$1h.$8ix=function(n){return n.substr(0,8).toLowerCase()==="https://"||n.substr(0,7).toLowerCase()==="http://"};O365SuiteServiceProxy.$1h.$1mO=function(n,t,i,r){if(r){if(O365SuiteServiceProxy.$1h.$B(n)||typeof n!==i)throw O365SuiteServiceProxy.$1h.$Wp(String.format("Invalid field or parameter {0}",t),-2001);}else if(!O365SuiteServiceProxy.$1h.$B(n)&&typeof n!==i)throw O365SuiteServiceProxy.$1h.$Wp(String.format("Invalid field or parameter {0}",t),-2001);};O365SuiteServiceProxy.$1h.$Wp=function(n,t){var i=Error.create(n);i.errorCode=t;return i};O365SuiteServiceProxy.$1h.$2L6=function(n){return O365SuiteServiceProxy.$1h.$Wp(String.format("Invalid field or parameter {0}",n),-2001)};O365SuiteServiceProxy.$1h.$80Q=function(n){return O365SuiteServiceProxy.$Mw.$F3L(n,!0,!0)};O365SuiteServiceProxy.ServiceHandlers=function(){};O365SuiteServiceProxy.ServiceHandlers.onBeforeSendRequestAdmin=function(n){var t=O365SuiteServiceProxy.$Mw.$4xE("s.AjaxSessionKey");t&&n.setRequestHeader("AjaxSessionKey",t)};O365SuiteServiceProxy.ServiceHandlers.onBeforeSendRequestSuiteService=function(n){var r="X-OWA-CANARY";var u="X-OWA-CANARY-DEBUG";var t=O365SuiteServiceProxy.$Mw.$4xE(r);var i=O365SuiteServiceProxy.$Mw.$4xE(u);t&&n.setRequestHeader(r,t);i&&n.setRequestHeader(u,i)};O365SuiteServiceProxy.ServiceHandlers.validateOrigin=function(n,t){var f=253;if(!t||n.length>f)return!1;for(var u=!1,r,i=0;i<t.length;i++){r=new RegExp(t[i],"i");if(r.test(n)){u=!0;break}}return u};O365SuiteServiceProxy.ServiceHandlers.IsAllowedApi=function(n){if(O365SuiteServiceProxy.$1h.$AF(n))return!1;var t=O365SuiteServiceProxy.$6h.$Btl(n);if(t in O365SuiteServiceProxy.ServiceHandlers.$7hK){var i=O365SuiteServiceProxy.$6h.$DrO(n);if(i in O365SuiteServiceProxy.ServiceHandlers.$7hJ)return!0}return t==="owa/ev.owa2"||t==="ev.owa2"?O365SuiteServiceProxy.ServiceHandlers.$AWy(n):!1};O365SuiteServiceProxy.ServiceHandlers.$Ada=function(){var n={};n["action=GetReminders"]=!0;n["action=GetOwaUserConfiguration"]=!0;n["action=SetNotificationSettings"]=!0;n["action=FindItem"]=!0;n["action=GetUserAvailabilityInternal"]=!0;n["action=GetCalendarFolders"]=!0;n["action=ProcessSuiteStorage"]=!0;n["action=SubscribeToNotification"]=!0;n["action=GetReminders"]=!0;n["action=PerformReminderAction"]=!0;n["action=GetOwaUserOofSettings"]=!0;n["action=SetTheme"]=!0;n["action=UnsubscribeToNotification"]=!0;n["action=GetDaysUntilPasswordExpiration"]=!0;n["action=GetSystemAlerts"]=!0;n["action=GetModernGroups"]=!0;n["action=GetModernGroup"]=!0;n["action=GetModernGroupUnseenItems"]=!0;n["action=GetCalendarFolderConfiguration"]=!0;n["action=SubscribeToGroupUnseenNotification"]=!0;n["action=SubscribeToGroupNotification"]=!0;n["format=json"]=!0;n["action=TestAddReminders"]=!0;n["action=TestDeleteAllReminders"]=!0;n["action=TestAddItems"]=!0;n["action=TestDeleteAllItems"]=!0;n["action=TestAddCalendarFolders"]=!0;n["action=TestAddCalendarGroups"]=!0;n["action=TestDeleteAllCalendarFolders"]=!0;n["action=TestDeleteAllCalendarGroups"]=!0;n["action=TestAddUserAvailability"]=!0;n["action=TestDeleteAllUserAvailability"]=!0;n["action=TestAddOwaUserOofSettings"]=!0;n["action=TestDeleteNotifications"]=!0;n["action=TestAddNotifications"]=!0;n["action=TestGetSettings"]=!0;return n};O365SuiteServiceProxy.ServiceHandlers.$Adc=function(){var n={};n.ecnsq=!0;n.brwnm=!0;n.cid=!0;n.syncFnshRq=!0;n.ns=!0;n.ev=!0;n.Fn=!0;n.UA=!0;n["UX-E4E-CANARY"]=!0;n["X-OWA-CANARY"]=!0;n["X-OWA-CANARY-DEBUG"]=!0;n["X-E4E-CANARY-DEBUG"]=!0;return n};O365SuiteServiceProxy.ServiceHandlers.$Adb=function(){var n={};n["owa/service.svc"]=!0;n["SuiteService.svc/"]=!0;n["SuiteService.svc"]=!0;n["owa/ev.owa2"]=!0;n["ev.owa2"]=!0;n["Microsoft.Online.BOX.Admin.UI.Alert.GetAlerts.model"]=!0;n["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model"]=!0;n["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model"]=!0;return n};O365SuiteServiceProxy.ServiceHandlers.$AWy=function(n){if(O365SuiteServiceProxy.$1h.$AF(n)||n===" ")return!1;var u=n.split("?");if(u.length===2){var i=u[1];if(O365SuiteServiceProxy.$1h.$AF(i)||i===" ")return!1;for(var f=i.split("&"),t=0;t<f.length;t++){var r=f[t].split("=");if(r.length===2){if(!(r[0]in O365SuiteServiceProxy.ServiceHandlers.$7hL))return!1}else return!1}return!0}return!1};O365SuiteServiceProxy.$2K=function(){};O365SuiteServiceProxy.$2K.$352=function(n,t){t.val=0;var i=n.errorCode;if(!1===_o365su.$T.$B(i)){t.val=i;return!0}else return!1};O365SuiteServiceProxy.$2K.$EW=function(n){var t;var r,i;return(i=O365SuiteServiceProxy.$2K.$352(n,r={val:t}),t=r.val,i)&&t===-1010};O365SuiteServiceProxy.$1ge=function(){};O365SuiteServiceProxy.$1ge.prototype={userId:null,clear:!1,reads:null,writes:null,deletes:null};O365SuiteServiceProxy.$9u=function(){};O365SuiteServiceProxy.$9u.$DxZ=function(n,t){var r=new O365SuiteServiceProxy.$1ax;var e=O365SuiteServiceProxy.$Mw.$4xE("SuiteServiceProxyKey");var o=null;var f=null;if(O365SuiteServiceProxy.$1h.$AF(e))throw O365SuiteServiceProxy.$1h.$Wp("Session storage error",-2007);else{var u=e.split("&");if(u.length!==2)throw O365SuiteServiceProxy.$1h.$Wp("Session storage error",-2007);o=u[0];f=u[1]}if(O365SuiteServiceProxy.$1h.$AF(n.userId))throw O365SuiteServiceProxy.$1h.$Wp("Session storage error",-2004);var i=window.sessionStorage;if(!i)throw O365SuiteServiceProxy.$1h.$Wp("Session storage error",-2005);var s=window.MsrCryptoUtils;if(!s)throw O365SuiteServiceProxy.$1h.$Wp("Session storage error",-2006);try{MsrCryptoUtils.$AbA(n.userId,function(u){var e=i.getItem("CurrentUserId");if(u!==e){i.clear();i.setItem("CurrentUserId",u)}O365SuiteServiceProxy.$9u.$AqN(n,r,i);O365SuiteServiceProxy.$9u.$AqX(n,r,i);O365SuiteServiceProxy.$9u.$ArW(n,o,f,i,r,t)},function(n){var i=_o365su.$T.$B(n)?"Session storage error":n;r.resetError=O365SuiteServiceProxy.$1h.$Wp(i,-2008);t(r)})}catch(h){r.resetError=h;t(r)}};O365SuiteServiceProxy.$9u.$AqN=function(n,t,i){try{n.clear&&i.clear()}catch(r){t.clearError=r}};O365SuiteServiceProxy.$9u.$AqX=function(n,t,i){try{if(!1===O365SuiteServiceProxy.$1h.$B(n.deletes))for(var r=0;r<n.deletes.length;r++){var u=n.deletes[r];i.removeItem(u)}}catch(f){t.deleteError=f}};O365SuiteServiceProxy.$9u.$ArW=function(n,t,i,r,u,f){try{!1===O365SuiteServiceProxy.$1h.$B(n.writes)?O365SuiteServiceProxy.$9u.$6Cs(t,i,n.writes,0,r,function(){O365SuiteServiceProxy.$9u.$4l6(n,t,i,r,u,f)},function(e){u.writeError=e;O365SuiteServiceProxy.$9u.$4l6(n,t,i,r,u,f)}):O365SuiteServiceProxy.$9u.$4l6(n,t,i,r,u,f)}catch(e){u.writeError=e;O365SuiteServiceProxy.$9u.$4l6(n,t,i,r,u,f)}};O365SuiteServiceProxy.$9u.$4l6=function(n,t,i,r,u,f){var s={};try{if(!1===O365SuiteServiceProxy.$1h.$B(n.reads)){var e={};O365SuiteServiceProxy.$9u.$4iq(t,i,n.reads,0,e,r,function(n){u.reads=n;f(u)},function(n){u.readError=n;f(u)})}}catch(o){u.readError=o;f(u)}};O365SuiteServiceProxy.$9u.$6Cs=function(n,t,i,r,u,f,e){if(!1===_o365su.$T.$B(i)&&r<i.length)if(_o365su.$T.$B(n)){u.setItem(i[r].key,i[r].value);O365SuiteServiceProxy.$9u.$6Cs(n,t,i,r+1,u,f,e)}else MsrCryptoUtils.$AuJ(n,t,"$"+i[r].value+"$",function(o){u.setItem(i[r].key,o);O365SuiteServiceProxy.$9u.$6Cs(n,t,i,r+1,u,f,e)},function(n){var t=_o365su.$T.$B(n)?"Session storage error":n;e(O365SuiteServiceProxy.$1h.$Wp(t,-2009))});else f()};O365SuiteServiceProxy.$9u.$4iq=function(n,t,i,r,u,f,e,o){if(!1===_o365su.$T.$B(i)&&r<i.length){var h=i[r];var s=f.getItem(h);if(s===null)O365SuiteServiceProxy.$9u.$4iq(n,t,i,r+1,u,f,e,o);else if(_o365su.$T.$B(n)){u[h]=s;O365SuiteServiceProxy.$9u.$4iq(n,t,i,r+1,u,f,e,o)}else MsrCryptoUtils.$AmL(n,t,s,function(s){O365SuiteServiceProxy.$1h.$B(s)||!1===s.startsWith("$")||!1===s.endsWith("$")||s.length<=2?f.clear():u[h]=s.substr(1,s.length-2);O365SuiteServiceProxy.$9u.$4iq(n,t,i,r+1,u,f,e,o)},function(n){o(Error.create(n))})}else e(u)};O365SuiteServiceProxy.$1ax=function(){};O365SuiteServiceProxy.$1ax.prototype={reads:null,resetError:null,clearError:null,deleteError:null,writeError:null,readError:null};MsrCryptoUtils.registerClass("MsrCryptoUtils");O365SuiteServiceProxy.$1LH.registerClass("O365SuiteServiceProxy.$1LH");O365SuiteServiceProxy.$16H.registerClass("O365SuiteServiceProxy.$16H");O365SuiteServiceProxy.$18y.registerClass("O365SuiteServiceProxy.$18y");O365SuiteServiceProxy.$1VK.registerClass("O365SuiteServiceProxy.$1VK");O365SuiteServiceProxy.$1gd.registerClass("O365SuiteServiceProxy.$1gd");O365SuiteServiceProxy.$Mw.registerClass("O365SuiteServiceProxy.$Mw");O365SuiteServiceProxy.$6h.registerClass("O365SuiteServiceProxy.$6h");O365SuiteServiceProxy.$1h.registerClass("O365SuiteServiceProxy.$1h");O365SuiteServiceProxy.ServiceHandlers.registerClass("O365SuiteServiceProxy.ServiceHandlers");O365SuiteServiceProxy.$2K.registerClass("O365SuiteServiceProxy.$2K");O365SuiteServiceProxy.$1ge.registerClass("O365SuiteServiceProxy.$1ge");O365SuiteServiceProxy.$9u.registerClass("O365SuiteServiceProxy.$9u");O365SuiteServiceProxy.$1ax.registerClass("O365SuiteServiceProxy.$1ax");O365SuiteServiceProxy.$6h.$7Dn=0;O365SuiteServiceProxy.$6h.$9Y8="SP.RequestExecutor";O365SuiteServiceProxy.ServiceHandlers.$7hL=O365SuiteServiceProxy.ServiceHandlers.$Adc();O365SuiteServiceProxy.ServiceHandlers.$7hJ=O365SuiteServiceProxy.ServiceHandlers.$Ada();O365SuiteServiceProxy.ServiceHandlers.$7hK=O365SuiteServiceProxy.ServiceHandlers.$Adb();
window.scriptsLoaded['microsoft.o365.suiteserviceproxycommon.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.o365.suiteserviceproxycommon.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
