try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.shellplus.o365.js'] = (new Date()).getTime();
Type.registerNamespace("_sp");_sp.$uT=function(n,t,i,r,u){this.$$d_$9TD=Function.createDelegate(this,this.$9TD);this.$$d_$9Se=Function.createDelegate(this,this.$9Se);this.$$d_$9Qv=Function.createDelegate(this,this.$9Qv);this.$$d_$9OG=Function.createDelegate(this,this.$9OG);this.$$d_$9OF=Function.createDelegate(this,this.$9OF);this.$$d_$9Sf=Function.createDelegate(this,this.$9Sf);this.$$d_$5Qu=Function.createDelegate(this,this.$5Qu);this.$HX=n;i.$1l(ISendFailedO365Event,this.$$d_$5Qu);i.$1l(ISendFailureRemoveO365Event,this.$$d_$9Sf);i.$1l(_y.$112,this.$$d_$9OF);i.$1l(_y.$113,this.$$d_$9OG);i.$1l(_y.$Km,this.$$d_$9Qv);this.$34=r;var f=this;t.$I(function(n){f.$9Mb(n.$I())});this.$5hG(u)};_sp.$uT.prototype={$34:null,$HX:null,$1VE:null,$1JG:null,$3gh:!1,get_$5O3:function(){return this.$HX},get_$1VF:function(){if(!this.$1VE){this.$1VE=new _o365sa.SAl;this.$1VE.Title=_u.Strings.l_Send_Failed_Text;this.$1VE.IsLocal=!0}return this.$1VE},get_$3ad:function(){if(!this.$1JG){this.$1JG=new _o365sa.SAl;this.$1JG.Title=_u.Strings.l_Send_Failed_In_QR_Text;this.$1JG.ActionText=_u.Strings.l_Send_Failed_In_QR_Notification_Popup_Text;this.$1JG.IsLocal=!0}return this.$1JG},$9Mb:function(n){this.$HX.$18g(new _o365sp.$Le(new _sp.$1D5(n)))},$5Qu:function(n){if(n.get_$8ij()){if(n.get_$55w()){this.get_$1VF().ActionText=n.get_$85A();this.get_$1VF().ActionCallback=n.get_$1eU();this.$HX.$Jy.$1mt(this.get_$1VF());this.$HX.$Jy.$T3.add_$20(this.$$d_$9Se)}else{this.get_$3ad().ActionCallback=n.get_$1eU();this.$HX.$Jy.$1mt(this.get_$3ad())}this.$HX.$Jy.$n("ShowPopup",this.$$d_$9TD);this.$HX.$Jy.get_$1XO().set_$6W(!1)}},$9Sf:function(n){this.$HX.$Jy.$1B("ShowPopup",this.$$d_$9TD);this.$HX.$Jy.get_$1XO().set_$6W(!0);if(n.get_$55w()){this.$3gh=!0;this.$HX.$Jy.$T3.remove_$20(this.$$d_$9Se);this.$HX.$Jy.$T3.$3K(this.get_$1VF())}else this.$HX.$Jy.$T3.$3K(this.get_$3ad());this.$HX.$Jy.set_$G7(!1)},$9OF:function(n){var t=new _o365sa.SAl;t.Title=n.get_$8mk()?_u.Strings.l_EventUpdate_Failed_Text:_u.Strings.l_EventCreate_Failed_Text;t.IsLocal=!0;t.ActionText=n.get_$7vE();t.ActionCallback=n.get_$1eU();this.$HX.$Jy.$1mt(t);if(n.get_$8ig()){this.$HX.$Jy.$n("ShowPopup",this.$$d_$9TD);this.$HX.$Jy.get_$1XO().set_$6W(!1)}},$9OG:function(n){this.$HX.$Jy.$1B("ShowPopup",this.$$d_$9TD);this.$HX.$Jy.get_$1XO().set_$6W(!0);this.$HX.$Jy.set_$G7(!1)},$9Qv:function(n){this.$5hG(n.$u9)},$5hG:function(n){n&&this.$HX.set_$3jd(!n.$84&&!n.$x9)},$9Se:function(n,t){if(!$B(t.$4c))for(var r=0;r<t.$4c.length;r++)if(t.$4c[r]===this.get_$1VF()){var i=this;this.$34.$2W(_a.$0.$1a,"Process send failure alert",function(){i.$3gh||i.$HX.$Jy.$1mt(i.get_$1VF())},0)}},$9TD:function(n,t){var i=n;i.get_$G7()||i.set_$G7(!0)}};_sp.$1D5=function(n){this.$$d_$7ka=Function.createDelegate(this,this.$7ka);this.$$d_$8gL=Function.createDelegate(this,this.$8gL);this.$79=n;this.$Bg=new _js.$Z;this.$iR=new _js.$Z;this.$79.get_$42v().add_$20(this.$$d_$8gL);this.$79.get_$5zt().add_$20(this.$$d_$7ka)};_sp.$1D5.prototype={$79:null,$Bg:null,$iR:null,get_$42v:function(){return this.$Bg},$3lh:function(n){this.$79.$3lh(n.$AL)},$420:function(n){this.$79.$420(n.$AL)},$8gL:function(n,t){if(t.$3T===2||t.$3T===3)for(var u=0;u<t.$4c.length;u++)for(var r=0;r<this.$Bg.get_$9();r++){var e=t.$4c[u];var f=this.$Bg.get_$D(r);e===f.$AL&&this.$Bg.$3K(f)}if(!t.$3T||t.$3T===3)for(var i=0;i<t.$4H.length;i++)this.$Bg.$F(new _sp.$1D4(t.$4H[i]))},$7ka:function(n,t){if(t.$3T===2||t.$3T===3)for(var u=0;u<t.$4c.length;u++)for(var r=0;r<this.$iR.get_$9();r++){var e=t.$4c[u];var f=this.$iR.get_$D(r);e===f.$1c&&this.$iR.$3K(f)}if(!t.$3T||t.$3T===3)for(var i=0;i<t.$4H.length;i++)this.$iR.$F(new _sp.$w5(t.$4H[i]))}};_sp.$1D4=function(n){this.$AL=n};_sp.$1D4.prototype={$AL:null,get_$A8G:function(){return this.$AL.$3jE},get_$5nX:function(){return new _sp.$w5(this.$AL.$2fm)}};_sp.$w5=function(n){this.$1c=n};_sp.$w5.prototype={$1c:null,get_$27:function(){return this.$1c.get_$27()},get_$Ic:function(){return this.$1c.$IG}};function O365ShellPlusComponent(){}O365ShellPlusComponent.$$cctor=function(){_a.$v.get_$P().$q(O365ShellPlusComponent)};O365ShellPlusComponent.prototype={$2ki:function(n,t,i){_o365sa.$81.$3f(n);if(i.get_$9q()==="Mouse"){var f=this;n.$q(_sp.$uT,function(){return new _sp.$uT(new _o365sp.$Ca,n.$3I(IChatManagerFactory),n.$1(_ff.$J),n.$1(_js.$2D),n.$1(_y.$8w).get_$Aj())}).$2V(IGlobalNotificationTrayViewModel).$1J();var e=this;n.$q(IUserThemesHandler,function(){return new _sp.$1D6(n.$32(IThemesViewModel),n.$32(IThemesViewCore))}).$1J();var r=this;n.$q(IChangeThemeMenuItemClickHandler,function(){return new _sp.$17l(n.$1(IUserThemesHandler))})}else{var u=this;n.$q(IGlobalMiniaturesPlusViewModel,function(){return new _sp.$19z(n.$32(ICalendarMiniatureNextAppointmentManager),i.get_$9q(),t.get_$8q(),n.$1(_a.$1J),n.$32(IModernGroupsNavigationFactory),n.$1(IGlobalMiniaturesViewModel))}).$1J()}},$Bjd:function(){return null}};_sp.$1D6=function(n,t){this.$$d_$9TQ=Function.createDelegate(this,this.$9TQ);this.CanHandlePreview=this.$F6R;this.Loading=this.$Fh;this.Closing=this.$F6S;this.SelectionChanged=this.$EBP;this.Saved=this.$5ZE;this.Cancelled=this.$4dK;this.$1Kr=t;this.$20D=n;var i=this;n.$I(function(n){n.apcl("ThemesList",i.$$d_$9TQ);n.get_$8oz().$ZQ_2()})};_sp.$1D6.prototype={$20D:null,$1Kr:null,$F6R:function(){return!0},$4dK:function(n,t){var i=this;this.$1Kr.$I(function(n){n.$5XI()})},$F6S:function(){},$Fh:function(){var n=this;this.$1Kr.$I(function(n){})},$5ZE:function(n,t){var i=this;this.$20D.$I(function(t){if(null!==t.get_$19O()&&t.get_$19O().length)for(var r=0;r<t.get_$1Kq().length;r++)if(t.get_$1Kq()[r].FolderName.toLowerCase()===n.toLocaleLowerCase()){i.$1Kr.$I(function(n){n.$9W(t.get_$1Kq()[r].FolderName)});break}})},$EBP:function(n,t){var i=this;this.$20D.$I(function(t){if(null!==t.get_$19O()&&t.get_$19O().length)for(var r=0;r<t.get_$1Kq().length;r++)if(t.get_$1Kq()[r].FolderName.toLowerCase()===n.toLocaleLowerCase()){i.$1Kr.$I(function(n){n.$77l(t.get_$1Kq()[r].FolderName)});break}})},$9TQ:function(n,t){var i=this;this.$1Kr.$I(function(n){i.$20D.$I(function(t){n.set_$19O(t.get_$19O())})})}};_sp.$17l=function(n){this.$Vt=n};_sp.$17l.prototype={$Vt:null,$22Q:function(){return _o365sp.$AX.$7nB(this.$Vt)()}};_sp.$17R=function(n){this.BeginGetNextAppointments=this.$F6Q;this.$OI=n;this.$1nY=new _js.$Z};_sp.$17R.prototype={$OI:null,$1nY:null,$FR:null,$F6Q:function(n,t,i,r,u){this.$FR=this.$OI.get_$9KR();this.$OI.set_$9RC(r);this.$1nY.$1v();if(this.$FR)for(var o=0;o<this.$FR.get_$9();o++){var e=new _o365sp.$AE;var f=this.$FR.get_$D(o);e.$og(f.get_$x());e.$9zf(f.get_$3L());e.$9yg(f.get_$Dj());e.$3t=f.get_$3t();e.$6C=f.get_$6C()?f.get_$6C().get_$27():"";e.$A0R(f.get_$1R());e.$9yF(f.get_$2s());e.$7q=f.get_$7q();e.$1sj=f.get_$6t()?f.get_$6t().get_$1XW():!1;this.$1nY.$F(e)}t&&t(this.$1nY.$3e())}};_sp.$19z=function(n,t,i,r,u,f){_sp.$19z.initializeBase(this);t==="Mouse"&&_a.$4.$1Rg("Mouse layout is not supported in GlobalMiniaturesPlusViewModel");this.$1wI=f.$7l;var s=t==="TouchWide"?1:2;if(u){var o=this;u.$I(function(n){var t=i||r.get_$2a().get_$5OO().Enabled;o.$2Qr=t?new _sp.$MD(n,f,i):null;o.$1wI.set_$ku(o.$2Qr)})}if(n){var e=this;n.$I(function(n){e.$2Jn=new _o365sp.$8k(new _sp.$17R(n),s);e.$1wI.$LI&&e.$1wI.$LI.set_$191(e.$2Jn)})}};_sp.$19z.prototype={$1wI:null,$2Jn:null,$2Qr:null,get_$4cr:function(){return this.$2Jn},get_$ku:function(){return this.$2Qr}};_sp.$MD=function(n,t,i){this.$$d_$4LR=Function.createDelegate(this,this.$4LR);this.$$d_$52i=Function.createDelegate(this,this.$52i);this.$$d_$A6g=Function.createDelegate(this,this.$A6g);this.$$d_$5YQ=Function.createDelegate(this,this.$5YQ);_sp.$MD.initializeBase(this);_js.Trace.logInfo(_a.$0.$1a,"GroupsViewModelAdapter -- initialize");this.$j2=t;this.$j2.$7l.add_$1zZ(this.$$d_$5YQ);this.$j2.add_$9R4(this.$$d_$A6g);this.$179=i;var r=this;_js.$D.get_$P().$LM(_ff.$W.$1a,"GroupsViewModelAdapter",function(){r.$4p=n.$4p;r.$1Gq=new _sp.$ud(r.$4p.$rf);r.$5YG();r.$Tf=new _js.$Z;r.$WE=new _js.$Z;r.$VT=new _js.$Z;r.$7fp();r.$52i();r.$4p.add_$3LL(r.$$d_$52i)})};_sp.$MD.prototype={$j2:null,$1Gq:null,$4p:null,$Tf:null,$WE:null,$VT:null,$179:!1,get_$6X7:function(){return this.$4p?this.$4p.$3Lh:!1},set_$6X7:function(n){return n},get_$6Wz:function(){return this.$4p?this.$4p.$3Lc:!1},set_$6Wz:function(n){return n},get_$6Xe:function(){return this.$4p?this.$4p.$2RV:!1},set_$6Xe:function(n){return n},get_$8bY:function(){return!this.$179},set_$8bY:function(n){return n},get_$3Mh:function(){return this.$4p?this.$4p.$2S9:!1},set_$3Mh:function(n){return n},get_$QE:function(){var n=this.$4p?this.$4p.$HW:!1;_js.Trace.logInfo(_a.$0.$1a,"GroupsViewModelAdapter IsReady {0}",n);return n},set_$QE:function(n){return n},get_$3QG:function(){return this.$4p?this.$4p.get_$3QG():!0},get_$59j:function(){return this.$Tf},get_$5U5:function(){return this.$WE},get_$AGN:function(){return this.$VT},get_$N9:function(){return this.$1Gq},set_$N9:function(n){this.$1Gq=n;if(null===this.$1Gq){if(!this.$4p.$rf){_js.Trace.logInfo(_a.$0.$1a,"Clear selected group");this.$7oU()}}else{_js.Trace.logInfo(_a.$0.$1a,"Cache selected group");this.$7lC(this.$1Gq.$Lg.get_$1An());this.$4p.set_$N9(this.$1Gq.$Lg)}this.$ik("SelectedGroup");return n},get_$7kX:function(){var n=this;return new _C(function(){n.$j2.$6Y9();n.$4p.$2jc.$11()},_ff.$W.$1a)},$ik:function(n){this.$4(n)},$83n:function(n){this.$CL(n)},$7ns:function(n){for(var t=0;t<n.get_$9();t++)n.get_$D(t).$1t();n.$1v()},$A6g:function(){if(this.get_$QE()){this.$4p.set_$N9(null);this.set_$N9(null)}},$7fp:function(){var r=this;this.$4p.$n("HasJoinedAndVisitedGroups",function(){r.$ik("HasJoinedAndVisitedGroups")});var u=this;this.$4p.$n("HasPinnedAndUnpinnedGroups",function(){u.$ik("HasPinnedAndUnpinnedGroups")});var f=this;this.$4p.$n("InitialGroupsLoadFailed",function(){f.$ik("InitialGroupsLoadFailed")});var n=this;this.$4p.$n("IsReady",function(){n.$ik("IsReady")});var t=this;this.$4p.$n("IsWelcomeMessageHidden",function(){t.$ik("IsWelcomeMessageHidden")});var i=this;this.$4p.$n("HideBrowseGroups",function(){i.$ik("HideBrowseGroups")});this.$4p.add_$4LR(this.$$d_$4LR);this.$83n(_sp.$MD.$53b)},$4LR:function(n){this.$5YQ()},$5YQ:function(){this.$j2.$7l.$hz||this.$5YG()},$5YG:function(){this.$j2.$7l.set_$2Fc(this.get_$QE()&&!!this.$4p.$rf&&this.$4p.$rf.$YN!==1)},$52i:function(){this.$3KM(this.$4p.$Tf,this.$Tf,"JoinedGroups");this.$3KM(this.$4p.$WE,this.$WE,"PinnedGroups");this.$3KM(this.$4p.$VT,this.$VT,"VisitedGroups")},$3KM:function(n,t,i){if(t){t.get_$9()&&this.$7ns(t);for(var r=n.get_$9()-1;r>=0;r--)t.$7W(0,new _sp.$ud(n.get_$D(r)));this.$ik(i)}}};_sp.$ud=function(n){this.$$d_$6Au=Function.createDelegate(this,this.$6Au);this.$$d_$AB1=Function.createDelegate(this,this.$AB1);_sp.$ud.initializeBase(this);this.$Lg=n;this.set_$1Dn(this.$Lg.get_$1mF().get_$1Dn());this.set_$27(this.$Lg.$C0.get_$27());this.$Lg.get_$1mF().$n("LastVisitedTime",this.$$d_$AB1);this.$Lg.$C0.$n("DisplayName",this.$$d_$6Au)};_sp.$ud.prototype={$Lg:null,$25:function(){_js.$FT.prototype.$25.call(this);this.$Lg.get_$1mF().$1B("LastVisitedTime",this.$$d_$AB1);this.$Lg.$C0.$1B("DisplayName",this.$$d_$6Au)},$AB1:function(n,t){this.set_$1Dn(this.$Lg.get_$1mF().get_$1Dn())},$6Au:function(n,t){this.set_$27(this.$Lg.$C0.get_$27())}};_sp.$uT.registerClass("_sp.$uT",null,IGlobalNotificationTrayViewModel);_sp.$1D5.registerClass("_sp.$1D5",null,_o365sp.$1eT);_sp.$1D4.registerClass("_sp.$1D4",null,_o365sp.$1eS);_sp.$w5.registerClass("_sp.$w5",null,_o365sp.$1eV);O365ShellPlusComponent.registerClass("O365ShellPlusComponent",null,_a.$1e2);_sp.$1D6.registerClass("_sp.$1D6",null,IUserThemesHandler);_sp.$17l.registerClass("_sp.$17l",null,IChangeThemeMenuItemClickHandler);_sp.$17R.registerClass("_sp.$17R",null,_o365sp.$1ed);_sp.$19z.registerClass("_sp.$19z",_a.$Ew,IGlobalMiniaturesPlusViewModel);_sp.$MD.registerClass("_sp.$MD",_o365sp.$7c);_sp.$ud.registerClass("_sp.$ud",_o365sp.$SP);O365ShellPlusComponent.$$cctor();_sp.$MD.$53b=["IsReady","IsWelcomeMessageHidden","InitialGroupsLoadFailed","HasPinnedAndUnpinnedGroups","HasJoinedAndVisitedGroups"];
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.shellplus.o365.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.shellplus.o365.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
