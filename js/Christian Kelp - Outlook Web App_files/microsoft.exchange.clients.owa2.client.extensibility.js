try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime();
Type.registerNamespace("_ex");function ExtensibilityComponent(){}ExtensibilityComponent.$$cctor=function(){_a.$v.get_$P().$q(ExtensibilityComponent)};ExtensibilityComponent.prototype={$2ki:function(n,t,i){n.$Bw(_ex.$19B).$2V(IExtensibilityStatistics).$1J();var f=this;n.$q(_ex.$hx,function(){return new _ex.$hx(n.$1(_g.$Or),n.$1(IExtensibilityStatistics),n.$1(_a.$1J))}).$1J();n.$Bw(_ex.$uB).$1J();var e=this,r=this;n.$q(_ex.$hz,function(){var t=n.$1(_g.$Q);return new _ex.$hz(t.get_$iB(),t.get_$4n().get_$NE(),t.get_$4n().get_$Gd(),t.get_$1f().get_$HI(),n.$1(_y.$R),n.$3I(IItemReadingPaneContextFactory),n.$3I(IItemReadingPaneViewModelPopOutFactory),n.$3I(IMailComposeContextFactory),n.$3I(IMailComposeActionFactory),n.$1(_a.$b),n.$1(_a.$35),n.$1(_a.$2c),n.$1(_a.$7n))}).$1J().$dl(function(t){t.$vW=n.$3I(ICalendarItemDetailsViewModelFactory);t.$xT=n.$3I(IMailComposeViewModelFactory);t.$vg=n.$3I(IComposeCalendarItemViewModelFactory)});var u=this;n.$q(_ex.$106,function(){var t=n.$1(_g.$Q);return new _ex.$106(n.$1(_a.$1i),n.$1(_ex.$uB),t.get_$4n().get_$C6(),i.get_$9Ug(),n.$1(_a.$35),n.$1(_a.$b),n.$1(_y.$R),n.$1(_ff.$J),n.$1(_ex.$hx),n.$1(_ex.$hz),n.$1(IExtensibilityStatistics),n.$1(_a.$1J))}).$2V(IExtensibilityViewModelFactory).$1J()},$Bjd:function(){return null}};_ex.$uA=function(n,t,i){_ex.$uA.initializeBase(this);this.$K5=n;this.$QV=t;this.$O0=i};_ex.$uA.prototype={$K5:null,$QV:null,$O0:null,$6au:function(n){var i=new _g.$RR(this.$K5,this.$QV,this.$O0);var t=new _g.$191(this.$2Y);t.actionName="Ext_ExecuteEwsProxy";n.$4n2(i,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){t()}};_ex.$uM=function(n,t){_ex.$uM.initializeBase(this);this.$20M=new Array(n.length);for(var i=0;i<n.length;i++){this.$20M[i]=new _g.$Lh(t);this.$20M[i].Id=n[i]}};_ex.$uM.prototype={$20M:null,$6au:function(n){var i=new _g.$M3(this.get_$7Q());i.Body.TokenRequests=this.$20M;var t=new _g.$uN(this.$2Y);t.actionName="Ext_GetUserIdentityToken";n.$3K3(i,t,this.$$d_$732,this.$$d_$1Iy)},$yV:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&_ex.$5X.get_$P().$7gW(n.Token)}};_ex.$uP=function(n){_ex.$uP.initializeBase(this);this.$c=n};_ex.$uP.prototype={$c:null,$6au:function(n){var i=new _g.$J9(_h.$k.get_$sn());i.ItemIds=[new _g.$1b(this.$c.get_$x().Id)];var t=new _g.$Yd(this.$2Y);t.clientStoreItem=0;var r=new _g.$J8(this.get_$7Q(),i);n.$6E(r,t,this.$$d_$732,this.$$d_$1Iy)},$yV:function(n){var t=n.Items[0];this.$c.set_$sn(t.EntityExtractionResult)}};_ex.$4b=function(){_ex.$4b.initializeBase(this)};_ex.$4b.prototype={$11Y:!1,$A9:null,$2Ku:0,$65:null,$11:function(n,t){if(OwaApplication.$1Sd){_ex.$4b.$gT=new _g.$Ly;_ex.$4b.$gT.Extensions=new Array(0)}else if(!this.$11Y){this.$65=new _g.$Rp(n,t);this.$11Y=!0;this.$A9=_a.$7.get_$3A();OwaApplication.$2D.$1T(this)}},$6au:function(n){var t=new _g.$19a(this.$2Y);t.actionName="Ext_LoadApps";n.$2QM(this.$65,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){this.$2Ku=_a.$7.get_$3A().$6P(this.$A9);_ex.$4b.$gT=n;t()}};_ex.$iz=function(n,t){_ex.$iz.initializeBase(this);if(_js.$A.$o(t))throw Error.argument("scope","scope can not be null or empty.");this.$20L=new _g.$Lh("ScopedToken");this.$20L.Id=n;this.$20L.Scope=t};_ex.$iz.prototype={$20L:null,$QV:null,$6au:function(n){var i=new _g.$M3(this.get_$7Q());i.Body.TokenRequests=[this.$20L];var t=new _g.$uN(this.$2Y);t.actionName="Ext_GetAttachmentToken";n.$3K3(i,t,this.$$d_$732,this.$$d_$1Iy)},$yV:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&(this.$QV=n.Token)}};_ex.$k8=function(n,t){_ex.$k8.initializeBase(this);this.$O0=n;this.$6B=t};_ex.$k8.prototype={$O0:null,$6B:null,$6au:function(n){var i=new _g.$T5(this.$O0,this.$6B);var t=new _g.$1C2(this.$2Y);t.actionName="Ext_LoadExtensionCustomProperties";n.$5BK(i,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){t()}};_ex.$1Ey=function(n){_ex.$1Ey.initializeBase(this);_a.$4.$1q(n,"input");this.$3Mx=n};_ex.$1Ey.prototype={$3Mx:null,$6au:function(n){var t=new _g.$1Ez(this.$2Y);n.$4Kp(this.$3Mx,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){if(null===n){i(Error.create("SanitizeHtmlAction failed."));return}_js.Trace.logInfo(_a.$0.$4F,"SanitizeHtml Web Service request successful.");t()}};_ex.$x1=function(n,t,i){_ex.$x1.initializeBase(this);this.$O0=n;this.$6B=t;this.$3dO=i};_ex.$x1.prototype={$O0:null,$6B:null,$3dO:null,$6au:function(n){var i=new _g.$UB(this.$O0,this.$6B,this.$3dO);var t=new _g.$1F0(this.$2Y);t.actionName="Ext_SaveExtensionCustomProperties";n.$5ZH(i,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){t()}};_ex.$x2=function(n,t,i){_ex.$x2.initializeBase(this);this.$O0=n;this.$3Es=t;this.$3dP=i};_ex.$x2.prototype={$O0:null,$3Es:null,$3dP:null,$6au:function(n){var i=new _g.$UD(this.$O0,this.$3Es,this.$3dP);var t=new _g.$1F1(this.$2Y);t.actionName="Ext_SaveExtensionSettings";n.$5ZI(i,t,this.$$d_$732,this.$$d_$1Iy)},$78J:function(n,t,i){t()}};_ex.$5X=function(){this.$1TE={};this.$1T9={}};_ex.$5X.get_$P=function(){$B(_ex.$5X.$1M)&&(_ex.$5X.$1M=new _ex.$5X);return _ex.$5X.$1M};_ex.$5X.prototype={$7gW:function(n){switch(n.TokenType){case"CallerIdentity":this.$1TE[n.Id]=new _ex.$5X.$3oj(n);break;case"ExtensionCallback":this.$1T9[n.Id]=new _ex.$5X.$3oj(n);break;default:var t=String.format("Error: ClientAccessTokenCache.AddToken type not supported - {0}",_js.$1S.$I2(_g.$Qs,n));_js.Trace.logError(_a.$0.$PL,t);break}},$3Aj:function(n){return n in this.$1TE&&!this.$1TE[n].$1sg()},$3Ai:function(n){return n in this.$1T9&&!this.$1T9[n].$1sg()},$8Xv:function(n){return this.$3Aj(n)?this.$1TE[n].$QV:null},$8T6:function(n){return this.$3Ai(n)?this.$1T9[n].$QV:null},$8gu:function(){var t=this.$1TE;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1sg())return!0}return!1},$8go:function(){var t=this.$1T9;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1sg())return!0}return!1}};_ex.$5X.$3oj=function(n){this.$1eL=new Date;this.$QV=n};_ex.$5X.$3oj.prototype={$1eL:null,$QV:null,$1sg:function(){var t=new Date;var n=t.getTime()-this.$1eL.getTime();return n>=(this.$QV.TTL-15)*6e4}};_ex.$1dG=function(){};_ex.$1dG.registerInterface("_ex.$1dG");_ex.$hx=function(n,t,i){this.$2L=n;this.$GQ=t;this.$1C=i||null};_ex.$hx.prototype={$2L:null,$GQ:null,$1C:null,$3BU:function(n,t){return new _ex.$6Q(n,this.$2L,t,this.$GQ)},$4ge:function(n){return new _ex.$195(this.$GQ,n,this.$1C)}};_ex.$195=function(n,t,i){this.$GQ=n;this.$pn=t;this.$1C=i||null};_ex.$195.prototype={$GQ:null,$1C:null,$pn:0,$6DJ:function(n,t){_a.$8.stPT(_a.$0.$4F,"AppActivationInComposeForm",5);for(var v=_a.$8.$1g(_a.$0.$4F,"AppActivationInComposeForm",!0),y=_a.$7.get_$3A(),s=new(_ff.$1E.$$(_ex.$7t)),r=0;r<n.length;r++){var l=n[r];var i;var f,h;if(h=_ex.$7t.$5on(l,new _ex.$u7(this.$GQ,this.$pn),f={val:i}),i=f.val,h){var e=null;var p=_a.$7.get_$3A();var c,o;var u=i.$zX?(o=i.$zX.$2Mw(null,i.$Ww,c={val:e}),e=c.val,o):!1;var a=_a.$7.get_$3A();u&&s.$F(i);this.$GQ.$5oK(l.Id,a.$6P(p),u)}}this.$GQ.$5oP(_a.$7.get_$3A().$6P(y));t(s);this.$AU();this.$GQ.$4oW();_a.$8.$1I(v,"AppActivationInComposeForm");_a.$8.endPT("AppActivationInComposeForm")},$A1X:function(){return!0},$AU:function(){}};_ex.$6Q=function(n,t,i,r){this.$c=n;this.$2So=i;this.$GQ=r;this.$2L=t};_ex.$6Q.get_$5Nc=function(){_ex.$6Q.$2Y9||(_ex.$6Q.$2Y9=["junkemail","drafts"]);return _ex.$6Q.$2Y9};_ex.$6Q.prototype={$2So:!1,$c:null,$GQ:null,$1FW:null,$2L:null,$6DJ:function(n,t){var e=!0;this.$1FW=new(_ff.$1E.$$(_ex.$7t));for(var r=0;r<n.length;r++){var s=n[r];var f=new _ex.$u7(this.$GQ,1);f.$td=this.$2So;var i;var u,o;if(o=_ex.$7t.$5on(s,f,u={val:i}),i=u.val,o){this.$1FW.$F(i);i.$zX&&(i.$zX.$56b(this.$c,i.$Ww)||(e=!1))}}e?this.$4mm(t):this.$8p4(t)},$A1X:function(){if(this.$c.get_$A4()||this.$c.get_$IA())return!1;if(this.$c.get_$CO()){var n=this.$c.get_$CO().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$c.get_$3L()&&!this.$A1Y(this.$c.get_$3L().Id)?!1:!0},$AU:function(){this.$1FW=null},$A1Y:function(n){if(!_ex.$6Q.$1wB){_ex.$6Q.$1wB={};for(var t=0;t<_ex.$6Q.get_$5Nc().length;t++){var r=_ex.$6Q.get_$5Nc()[t];var i=this.$2L.nameToId(r);i&&(_ex.$6Q.$1wB[i.Id]=!0)}}return!(n in _ex.$6Q.$1wB)},$4mm:function(n){if(this.$1FW){_a.$8.stPT(_a.$0.$4F,"AppActivationInReadingPane",5);var c=_a.$8.$1g(_a.$0.$4F,"AppActivationInReadingPane",!0);var e=new(_ff.$1E.$$(_ex.$7t));this.$GQ.$5oM(this.$c.get_$2z5(),this.$c.get_$sn());for(var h=_a.$7.get_$3A(),o=null,i=0;i<this.$1FW.get_$9();i++){var t=this.$1FW.get_$D(i);var l=_a.$7.get_$3A();var f,u;var r=(u=this.$A1Z(t,f={val:o}),o=f.val,u);var s=_a.$7.get_$3A();if(r){e.$F(t);t.$9ym(this.$c.get_$sn())}this.$GQ.$5oK(t.$5c.Id,s.$6P(l),r)}this.$GQ.$5oP(_a.$7.get_$3A().$6P(h));n(e);this.$AU();this.$GQ.$4oW();_a.$8.$1I(c,"AppActivationInReadingPane","");_a.$8.endPT("AppActivationInReadingPane")}},$A1Z:function(n,t){if($B(n)||$B(n.$zX))return!1;var i=!1;n.$Ww.$1ao={};i=!!(i|n.$zX.$2Mw(this.$c,n.$Ww,t));return i},$8p4:function(n){var t=new _ex.$uP(this.$c);var i=this;t.add_$2x(function(t){i.$4mm(n)});OwaApplication.$2D.$1T(t)}};_ex.$sS=function(n,t,i,r){this.$$d_$AEs=Function.createDelegate(this,this.$AEs);this.$$d_$7jF=Function.createDelegate(this,this.$7jF);_ex.$sS.initializeBase(this,[i,r]);this.$7L=n;this.$k3=t};_ex.$sS.$8T5=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_ex.$sS.prototype={$7L:null,$k3:null,$vP:null,$81U:function(){var n;if(!this.$AAJ()){this.$hg();return}var r,i,t;if(t=this.$A9n(r={val:n},i={val:this.$vP}),n=r.val,this.$vP=i.val,t){this.$vP.add_$D4(this.$$d_$7jF);this.$vP.add_$1Ix(this.$$d_$AEs)}else{this.$aN(n,null);return}},$AEs:function(n){this.$vP.remove_$1Ix(this.$$d_$AEs);if(n.get_$3Yp()){var i=_ex.$sS.$8T5(n.get_$389());this.$aN(i,null);return}var t=this.$k3.$F(this.$vP);this.$VC(t,null)},$7jF:function(n,t){if(t==="IsDeleted"&&this.$vP.get_$1hU()){this.$vP.remove_$D4(this.$$d_$7jF);this.$aN(9006,null)}}};_ex.$16D=function(n,t,i,r){_ex.$16D.initializeBase(this,[n,t,i,r])};_ex.$16D.prototype={get_$V4:function(){return"AddFileAttachment"},get_$5TH:function(){return 3},$AAJ:function(){var t=this.$1m.uri;var n=this.$1m.name;if(_js.$A.$o(t)||_js.$A.$o(n)){_js.Trace.logError(_a.$0.$4F,"AddFileAttachment got null or empty uri or name");return!1}else if(t.length>2048||n.length>255){_js.Trace.logError(_a.$0.$4F,"AddFileAttachment got too long uri or name");return!1}else return!0},$A9n:function(n,t){var r=this.$1m.uri;var i=this.$1m.name;t.val=this.$7L.$4YI(r,i,n);return!!t.val}};_ex.$16E=function(n,t,i,r){_ex.$16E.initializeBase(this,[n,t,i,r])};_ex.$16E.prototype={get_$V4:function(){return"AddItemAttachment"},get_$5TH:function(){return 3},$AAJ:function(){var t=this.$1m.itemId;var n=this.$1m.name;if(_js.$A.$o(t)||_js.$A.$o(n)){_js.Trace.logError(_a.$0.$4F,"AddItemAttachment got null or empty itemId or name");return!1}else if(t.length>200||n.length>255){_js.Trace.logError(_a.$0.$4F,"AddItemAttachment got too long itemId or name");return!1}else return!0},$A9n:function(n,t){var r=this.$1m.itemId;var u=this.$1m.name;var i=new _g.$7W;i.set_$x(new _g.$1b(r));i.set_$1w(u);i.set_$Cn(!1);i.set_$8A(0);t.val=this.$7L.$4YN(i,n);return!!t.val}};_ex.$sX=function(n,t,i,r){_ex.$sX.initializeBase(this,[t,i]);this.$7L=n;this.$2KN=r};_ex.$sX.prototype={$2KN:!1,$7L:null,get_$V4:function(){return this.$2KN?"SetRecipients":"AddRecipients"},get_$5TH:function(){return 3},$A9t:function(n,t){t.val=new(_ff.$1E.$$(_g.$1U));if($B(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.$0.$4F,"Add/SetRecipientsAsync null for both displayName and address");this.$hg();return!1}if(r&&r.length>255){_js.Trace.logError(_a.$0.$4F,"Add/SetRecipientsAsync got displayName lengths over the limit");this.$hg();return!1}if(_a.$2s.$Zo(f)){var i=new _g.$1U;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$F(i)}}if(t.val.get_$9()>0)return!0;else{this.$aN(9013,null);return!1}},$81U:function(){var u=this.$1m.recipientField;var r=this.$1m.recipientArray;var n;if(r.length>100){_js.Trace.logError(_a.$0.$4F,"Add/SetRecipientsAsync got more recipients in the list than the limit.");this.$hg();return}var t,i;if(i=this.$A9t(r,t={val:n}),n=t.val,i){if(this.$2KN)this.$7L.$A02(u,n);else if(!this.$7L.$A9l(u,n)){this.$aN(9012,null);return}this.$VC(null,null)}}};_ex.$1gT=function(n,t){this.$1m=n;this.$1JU=t};_ex.$1gT.prototype={$1m:null,$1JU:null,$Fk:null,$11:function(n){if(!this.$82K(n)){_js.Trace.logError(_a.$0.$4F,String.format("API call failing due to insufficient permission {0}",this.get_$V4()));this.$hg();return}_a.$8.stPT(_a.$0.$4F,this.get_$V4(),5);this.$Fk=_a.$8.$1g(_a.$0.$4F,this.get_$V4(),!0);this.$81U()},$VC:function(n,t){this.$1JU(_ex.$1Z.$4hP(n));_a.$8.$1I(this.$Fk,this.get_$V4(),"",t);_a.$8.endPT(this.get_$V4())},$aN:function(n,t){this.$1JU(_ex.$1Z.$7sd(n));_a.$8.$1I(this.$Fk,this.get_$V4(),_ex.$Fr.$8qv(n),t);_a.$8.endPT(this.get_$V4())},$2bG:function(n,t){this.$1JU(n);_a.$8.$1I(this.$Fk,this.get_$V4(),"",t);_a.$8.endPT(this.get_$V4())},$9gD:function(n,t,i){this.$1JU(n);_a.$8.$1I(this.$Fk,this.get_$V4(),t,i);_a.$8.endPT(this.get_$V4())},$hg:function(){this.$1JU(null);_a.$8.$1I(this.$Fk,this.get_$V4(),"NonAPI",null);_a.$8.endPT(this.get_$V4())},$82K:function(n){return n===2?!0:this.get_$5TH()===2?!1:n>=this.get_$5TH()}};_ex.$179=function(n,t,i,r){_ex.$179.initializeBase(this,[n,t,i,r])};_ex.$179.prototype={get_$V4:function(){return"BodyPrepend"},get_$5TH:function(){return 3},$2SK:function(n){this.$7L_1.$9YT(n,this.$vc===3);this.$VC(null,null)}};_ex.$17A=function(n,t,i,r){_ex.$17A.initializeBase(this,[n,t,i,r])};_ex.$17A.prototype={get_$V4:function(){return"BodySetSelectedData"},get_$5TH:function(){return 3},$2SK:function(n){this.$7L_1.$8el(n,this.$vc===3);this.$VC(null,null)}};_ex.$1gS=function(){};_ex.$1gS.$Wm=function(){};_ex.$1gS.$Wm.prototype={text:0,html:3};_ex.$1gS.$Wm.registerEnum("_ex.$1gS.$Wm",!1);_ex.$193=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$9zG=Function.createDelegate(this,this.$9zG);this.$$d_$8UV=Function.createDelegate(this,this.$8UV);this.$$d_$A0h=Function.createDelegate(this,this.$A0h);this.$$d_$8Xg=Function.createDelegate(this,this.$8Xg);_ex.$193.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$Nz=n};_ex.$193.prototype={$Nz:null,get_$9hB:function(){return 1},$1EB:function(n,t){n.itemType=5;var i=this;_ex.$1hM.prototype.$1EB.call(this,n,function(){t()})},$2I4:function(n){n.$48([_ex.$2I.$I("GetTimeAsync",this.$$d_$8Xg),_ex.$2I.$I("SetTimeAsync",this.$$d_$A0h),_ex.$2I.$I("GetLocationAsync",this.$$d_$8UV),_ex.$2I.$I("SetLocationAsync",this.$$d_$9zG)]);_ex.$1hM.prototype.$2I4.call(this,n)},$8Xg:function(n,t){new _ex.$19v(this.$Nz,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$A0h:function(n,t){new _ex.$1Ff(this.$Nz,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$9zG:function(n,t){new _ex.$1FV(this.$Nz,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$8UV:function(n,t){new _ex.$19e(this.$Nz,n,t).$11(this.$8k.$5c.RequestedCapabilities)}};_ex.$194=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_ex.$194.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p,w])};_ex.$194.prototype={get_$9hB:function(){return 2},$1EB:function(n,t){var r=this.$c.get_$CO()?this.$c.get_$CO().toLowerCase():"";if(_ex.$EX.$54B(r)){n.itemType=2;var i=this.$c;this.$7eO(i,n)}var u=this;_ex.$4M.prototype.$1EB.call(this,n,function(){t()})},$7eO:function(n,t){if(!this.get_$1HE()){_ex.$4M.$1SQ(t,"to",n.get_$BJ(),n.get_$JU());_ex.$4M.$1SQ(t,"cc",n.get_$CZ(),null);_ex.$4M.$1SQ(t,"resources",n.get_$Ee(),null);n.get_$JU()&&_ex.$4M.$36e(t,"organizer",n.get_$JU())}n.get_$6C()&&(t.location=n.get_$6C().get_$27());n.get_$1R()&&(t.start=n.get_$1R().$dD().getTime());n.get_$2s()&&(t.end=n.get_$2s().$dD().getTime())}};_ex.$1hM=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$8RV=Function.createDelegate(this,this.$8RV);this.$$d_$4nA=Function.createDelegate(this,this.$4nA);this.$$d_$4n4=Function.createDelegate(this,this.$4n4);this.$$d_$9YU=Function.createDelegate(this,this.$9YU);this.$$d_$A0I=Function.createDelegate(this,this.$A0I);this.$$d_$A0H=Function.createDelegate(this,this.$A0H);this.$$d_$8Wn=Function.createDelegate(this,this.$8Wn);this.$$d_$A0V=Function.createDelegate(this,this.$A0V);this.$$d_$8XI=Function.createDelegate(this,this.$8XI);this.$$d_$A03=Function.createDelegate(this,this.$A03);this.$$d_$7fy=Function.createDelegate(this,this.$7fy);this.$$d_$8W8=Function.createDelegate(this,this.$8W8);this.$$d_$1QT=Function.createDelegate(this,this.$1QT);this.$$d_$4YI=Function.createDelegate(this,this.$4YI);this.$$d_$4YN=Function.createDelegate(this,this.$4YN);_ex.$1hM.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$7L=n};_ex.$1hM.prototype={$7L:null,$k3:null,get_$2Ii:function(){return"ComposeAppSelection"},get_$4aT:function(){return"ComposeAppSelectionToProgressDone"},get_$38F:function(){this.$k3||(this.$k3=new(_ex.$i0.$$(_y.$Sb))(this.$8k.$5c.Id));return this.$k3},$4YN:function(n,t){new _ex.$16E(this.$7L,this.get_$38F(),n,t).$11(this.$8k.$5c.RequestedCapabilities)},$4YI:function(n,t){new _ex.$16D(this.$7L,this.get_$38F(),n,t).$11(this.$8k.$5c.RequestedCapabilities)},$1QT:function(n,t){new _ex.$1Ej(this.get_$38F(),n,t).$11(this.$8k.$5c.RequestedCapabilities)},$8W8:function(n,t){new _ex.$iy(this.$7L,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$A03:function(n,t){new _ex.$sX(this.$7L,n,t,!0).$11(this.$8k.$5c.RequestedCapabilities)},$7fy:function(n,t){new _ex.$sX(this.$7L,n,t,!1).$11(this.$8k.$5c.RequestedCapabilities)},$8XI:function(n,t){new _ex.$19s(this.$7L,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$A0V:function(n,t){new _ex.$1Fd(this.$7L,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$8Wn:function(n,t){new _ex.$19q(this.$7L,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$A0H:function(n,t){new _ex.$1Fc(this.$7L,n,t,this.$m).$11(this.$8k.$5c.RequestedCapabilities)},$A0I:function(n,t){new _ex.$17A(this.$7L,n,t,this.$m).$11(this.$8k.$5c.RequestedCapabilities)},$9YU:function(n,t){new _ex.$179(this.$7L,n,t,this.$m).$11(this.$8k.$5c.RequestedCapabilities)},$8RV:function(n,t){new _ex.$19U(this.$7L,n,t).$11(this.$8k.$5c.RequestedCapabilities)},$1EB:function(n,t){t()},$2I4:function(n){_ex.$1Z.prototype.$2I4.call(this,n);n.$48([_ex.$2I.$I("AddItemAttachmentAsync",this.$$d_$4YN),_ex.$2I.$I("AddFileAttachmentAsync",this.$$d_$4YI),_ex.$2I.$I("RemoveAttachmentAsync",this.$$d_$1QT),_ex.$2I.$I("GetRecipientsAsync",this.$$d_$8W8),_ex.$2I.$I("AddRecipientsAsync",this.$$d_$7fy),_ex.$2I.$I("SetRecipientsAsync",this.$$d_$A03),_ex.$2I.$I("GetSubjectAsync",this.$$d_$8XI),_ex.$2I.$I("SetSubjectAsync",this.$$d_$A0V),_ex.$2I.$I("GetSelectedDataAsync",this.$$d_$8Wn),_ex.$2I.$I("SetSelectedDataAsync",this.$$d_$A0H),_ex.$2I.$I("BodySetSelectedDataAsync",this.$$d_$A0I),_ex.$2I.$I("BodyPrependAsync",this.$$d_$9YU),_ex.$2I.$I("LoadCustomProperties",this.$$d_$4n4),_ex.$2I.$I("SaveCustomProperties",this.$$d_$4nA),_ex.$2I.$I("GetBodyTypeAsync",this.$$d_$8RV)])},$4nA:function(n,t){new _ex.$Mx(this.$7L,n,this.$8k.$5c.Id,t).$11(this.$8k.$5c.RequestedCapabilities)},$4n4:function(n,t){new _ex.$1C1(this.$7L,n,this.$8k.$5c.Id,this.$m,t).$11(this.$8k.$5c.RequestedCapabilities)}};_ex.$1Z=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$8oF=Function.createDelegate(this,this.$8oF);this.$$d_$81b=Function.createDelegate(this,this.$81b);this.$$d_$81a=Function.createDelegate(this,this.$81a);this.$$d_$81c=Function.createDelegate(this,this.$81c);this.$$d_$81k=Function.createDelegate(this,this.$81k);this.$$d_$A9A=Function.createDelegate(this,this.$A9A);this.$$d_$9bE=Function.createDelegate(this,this.$9bE);this.$$d_$9bA=Function.createDelegate(this,this.$9bA);this.$$d_$81v=Function.createDelegate(this,this.$81v);this.$$d_$81h=Function.createDelegate(this,this.$81h);this.$$d_$8Tu=Function.createDelegate(this,this.$8Tu);this.$$d_$9Ot=Function.createDelegate(this,this.$9Ot);this.$$d_$A92=Function.createDelegate(this,this.$A92);_a.$4.$y(a,"nativeBridge");this.$H=n;this.$jy=t;this.$s9=i;this.$Ns=r;this.$Pu=u;this.$vg=f;this.$vW=e;this.$xT=o;this.$qp=s;this.$xL=h;this.$f5=c;this.$l=a;this.$m=v;this.$6a=_a.$6y.$I()};_ex.$1Z.get_$13t=function(){_ex.$1Z.$2J5||(_ex.$1Z.$2J5=String.format(_u.ExtStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3));return _ex.$1Z.$2J5};_ex.$1Z.get_$2J8=function(){_ex.$1Z.$2J7||(_ex.$1Z.$2J7={wasSuccessful:!1,errorMessage:_ex.$1Z.get_$13t()});return _ex.$1Z.$2J7};_ex.$1Z.get_$7iu=function(){_ex.$1Z.$2J6||(_ex.$1Z.$2J6={wasProxySuccessful:!1,errorMessage:_ex.$1Z.get_$13t()});return _ex.$1Z.$2J6};_ex.$1Z.get_$7iv=function(){_ex.$1Z.$2J9||(_ex.$1Z.$2J9={error:1,errorMessage:_ex.$1Z.get_$13t()});return _ex.$1Z.$2J9};_ex.$1Z.$4hP=function(n){return{error:0,data:n}};_ex.$1Z.$7sd=function(n){return{error:1,errorCode:n}};_ex.$1Z.$6Tx=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_ex.$1Z.prototype={$s9:null,$Ns:null,$Pu:null,$1Ug:0,$H:null,$jy:null,$Jg:null,$Ww:null,$8k:null,$2ZC:0,$1yU:null,$qp:null,$m:null,$vg:null,$vW:null,$xT:null,$xL:null,$f5:null,$1yM:null,$1yO:null,$144:0,$2Ic:0,$2ZX:0,$1pP:!1,$2I8:!1,$14j:null,$1FS:null,$1FT:null,$xN:null,$1rt:!1,$l:null,$6a:null,$1wk:null,$2QR:0,get_$1HE:function(){return!this.$8k.$5c.RequestedCapabilities},$3f:function(n,t,i){this.$8k=n;this.$Jg=t;this.$Ww=i;this.$1wk={};try{window.msWriteProfilerMark=this.$$d_$A92}catch(r){_js.Trace.logException(_a.$0.$4F,r,"Unable to write to Window object for MsWriteProfileMarkHandler.")}},$AAd:function(){try{window.msWriteProfilerMark=null}catch(n){}this.$144=0},$8Tu:function(n,t){var u=_a.$7.get_$3A();var f=_js.$I.s(_a.$0.$4F,517,"GetInitialData");var i={};i.permissionLevel=this.$8k.$5c.RequestedCapabilities;i.timeZoneOffsets=this.$8Xh();i.hostVersion=this.$H.get_$35d();i.owaView=_ex.$1Z.$6Tx(this.$H.get_$T());i.overrideWindowOpen=this.$l.$8G(this.$l.get_$Ip())&&this.$l.get_$Ip().get_$2MP().get_$2Uj();if(!this.get_$1HE()){i.userDisplayName=this.$Ns;i.userEmailAddress=this.$Pu;i.userTimeZone=this.$s9;i.ewsUrl=this.$Jg.EwsUrl}var r=this;this.$1EB(i,function(){_js.$I.e(f);r.$2QR=_a.$7.get_$3A().$6P(u);t(i);r.$1pP=!0;r.$2mU()})},$9bs:function(){if(!this.$1rt){if(!this.$xN){this.$xN=new(_ff.$1E.$$(_ex.$2I));this.$2I4(this.$xN)}for(var t=0;t<this.$xN.get_$9();t++){var n=this.$xN.get_$D(t);this.$1yU.registerMethod(n.$XK,n.$nm,0,n.$38d)}this.$l.$8G(this.$l.get_$Ip())&&this.$l.get_$Ip().get_$2MP().get_$2Uj()&&this.$1yU.unregisterMethod("ContextActivationManager_openWindowInHost");this.$1rt=!0}},$AAx:function(){if(this.$1rt&&this.$xN){for(var n=0;n<this.$xN.get_$9();n++){var t=this.$xN.get_$D(n);this.$1yU.unregisterMethod(t.$XK)}this.$1rt=!1}},$81h:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteEwsRequest",5);this.$14j=_a.$8.$1g(_a.$0.$4F,"ExecuteEwsRequest",!0);var i=this.$8k.$5c;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$4F,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_ex.$1Z.$1VJ);this.$Da(this.$14j,"ExecuteEwsRequest","Failed",null);return}var s=n;var e=s.body;var o=_ex.$5X.get_$P();if($B(e)||this.$pA(e.length,_y.$hy.$48F,"ExecuteEwsRequest")){t(_ex.$1Z.$1VJ);this.$Da(this.$14j,"ExecuteEwsRequest","Failed",null);return}var r,u;if(!(u=this.$1TR(r={val:t},_ex.$1Z.get_$7iu()),t=r.val,u)){this.$Da(this.$14j,"ExecuteEwsRequest",_ex.$1Z.get_$13t(),null);return}if(!o.$3Ai(i.Id)||o.$8go()){var h=this,f=this;this.$4gT("ExtensionCallback",function(r){h.$5Pp(i,n,t)},function(n){t({wasProxySuccessful:!1});f.$Da(f.$14j,"ExecuteEwsRequest","Failed",n)})}else this.$5Pp(i,n,t)},$81v:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteSaveSettingsRequest",5);this.$1FT=_a.$8.$1g(_a.$0.$4F,"ExecuteSaveSettingsRequest",!0);var u=this.$8k;var c=n;var o=c[0];var s=JsonParser.serialize(o);if(this.$pA(s.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$Da(this.$1FT,"ExecuteSaveSettingsRequest","Failed",null);return}var h,f;if(!(f=this.$1TR(h={val:t},_ex.$1Z.get_$7iv()),t=h.val,f)){this.$Da(this.$1FT,"ExecuteSaveSettingsRequest",_ex.$1Z.get_$13t(),null);return}var i=new _ex.$x2(u.$5c.Id,u.$5c.Version,s);var r=this;i.add_$2x(function(n){if(i.get_$4i().WasSuccessful){u.set_$5hC(o);t({error:0});r.$Da(r.$1FT,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$4i().ErrorMessage,error:1});r.$Da(r.$1FT,"ExecuteSaveSettingsRequest",i.get_$4i().ErrorMessage,n)}});var e=this;i.add_$2d(function(n){t({errorMessage:i.$2I.message,error:1});e.$Da(e.$1FT,"ExecuteSaveSettingsRequest",i.$2I.message,n)});this.$m.$1T(i)},$81k:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteGetUserIdentityTokenRequest",5);this.$1FS=_a.$8.$1g(_a.$0.$4F,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1HE()){_js.Trace.logInfo(_a.$0.$4F,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$8k.$5c.DisplayName);t(_ex.$1Z.$1VJ);this.$Da(this.$1FS,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_ex.$5X.get_$P();var r=this.$8k.$5c.Id;if(!u.$3Aj(r)||u.$8gu()){var e,o;if(!(o=this.$1TR(e={val:t},_ex.$1Z.get_$2J8()),t=e.val,o)){this.$Da(this.$1FS,"ExecuteGetUserIdentityTokenRequest",_ex.$1Z.get_$13t(),null);return}var i=this,f=this;this.$4gT("CallerIdentity",function(n){i.$5Ps(r,t);i.$Da(i.$1FS,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1,errorMessage:n.$2I.toString(),error:1,errorCode:9018});f.$Da(f.$1FS,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{this.$5Ps(r,t);this.$Da(this.$1FS,"ExecuteGetUserIdentityTokenRequest","",null)}},$81c:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteDisplayNewAppointmentForm",5);var u=_a.$8.$1g(_a.$0.$4F,"ExecuteDisplayNewAppointmentForm",!0);try{var f=n;var r=this.$85N(f);if(!r){t(null);this.$Da(u,"ExecuteDisplayNewAppointmentForm","Failed",null);return}var i=this;this.$vg.$I(function(n){if(i.$H.get_$T()==="Mouse"){var e=n.$3G3(r);i.$H.$WF(IComposeCalendarItemViewModelFactory,null,null,_bc.$2V.get_$sq(),e,!1)}else{var f=n.$yg(r.$65,null,null);i.$5ja(f)}i.$Da(u,"ExecuteDisplayNewAppointmentForm","",null);t(null)})}catch(e){this.$Da(u,"ExecuteDisplayNewAppointmentForm","Failed",null);throw e;}},$81a:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteDisplayExistingAppointmentForm",5);var u=_a.$8.$1g(_a.$0.$4F,"ExecuteDisplayExistingAppointmentForm",!0);try{var e=n;var f=e.itemId;if(_js.$A.$o(f)){t(null);this.$Da(u,"ExecuteDisplayExistingAppointmentForm","Failed",null);return}var r=new _y.$Bj;r.$og(new _g.$1b(f));var i=this;this.$vW.$I(function(n){if(i.$H.get_$T()==="Mouse")i.$H.$WF(ICalendarItemDetailsViewModelFactory,null,r.$65,_bc.$2V.get_$sq(),null,!1);else{var f=n.$yg(r.$65,null,null);i.$5ja(f)}i.$Da(u,"ExecuteDisplayExistingAppointmentForm","",null);t(null)})}catch(o){this.$Da(u,"ExecuteDisplayExistingAppointmentForm","Failed",null);throw o;}},$81b:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteDisplayExistingMessageForm",5);var i=_a.$8.$1g(_a.$0.$4F,"ExecuteDisplayExistingMessageForm",!0);try{var r=n;this.$8U6(r.itemId,this.$$d_$9Ot);this.$Da(i,"ExecuteDisplayExistingMessageForm","",null)}catch(u){this.$Da(i,"ExecuteDisplayExistingMessageForm","Failed",null);throw u;}t(null)},$8oF:function(n,t){if(this.$l.$8G(this.$l.get_$Ip())){var i=n.launchUrl;i&&this.$l.get_$Ip().$2Ui(i)}t(null)},$9bA:function(n,t){var r=n;if(this.$8k.$5c.Origin===3){var i=new _ex.$19D(this.$8k.$5c.DisplayName.replace(_ex.$1Z.$20z,""));i.$9Xh(r);i.$1T()}t(null)},$9bE:function(n,t){var i=n;if(this.$8k.$5c.Origin!==3){t(null);return}var f=_a.$0.$4F;var u="[{0}] {1}";var r=this.$8k.$5c.DisplayName.replace(_ex.$1Z.$20z,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(f,u,r,i.Message);break;case"Error":_js.Trace.logError(f,u,r,i.Message);break;default:break}t(null)},$A9A:function(n,t){var r=n;if(this.$8k.$5c.Origin!==3){t(null);return}var i=this.$8k.$5c.DisplayName.replace(_ex.$1Z.$20z,"")+"."+r.Name.replace(_ex.$1Z.$20z,"");var u=r.Event;switch(u){case"Start":_a.$8.$1g(_a.$0.$4F,i);break;case"End":_a.$8.$1I(null,i);break;default:break}t(null)},setServiceEndPoint:function(n){this.$1yU=n},$8Xh:function(){return this.$jy.$3Kt(this.$s9)},$7TF:function(){this.$1pP=!1;this.$2I8=!1;this.$2Ic=0;this.$2QR=0;this.$1Ug=0;this.$2ZX=0;_a.$8.stPT(_a.$0.$4F,this.get_$2Ii(),5);this.$1yM=_a.$8.$1g(_a.$0.$4F,this.get_$2Ii(),!0);this.$1yO=_a.$8.$1g(_a.$0.$4F,this.get_$4aT(),!0)},$2mU:function(){if(this.$1yM){this.$3EN(!1);var n=this.$1pP?"":"Failed";_a.$8.$1I(this.$1yM,this.get_$2Ii(),n,null,this.$4yR());_a.$8.endPT(this.get_$2Ii());this.$1yM=null}},$3EN:function(n){if(this.$1yO){_a.$8.$1I(this.$1yO,this.get_$4aT(),n?"":"Failed",null,this.$4yR());this.$1yO=null}},$Da:function(n,t,i,r){i||(i="");var u=null;r&&(_ex.$uA.isInstanceOfType(r)&&r.$6J?u=r.$6J.correlationId:_ex.$x2.isInstanceOfType(r)&&r.$6J?u=r.$6J.correlationId:_ex.$k8.isInstanceOfType(r)&&r.$6J?u=r.$6J.correlationId:_ex.$x1.isInstanceOfType(r)&&r.$6J?u=r.$6J.correlationId:_ex.$uM.isInstanceOfType(r)&&r.$6J?u=r.$6J.correlationId:_ex.$iz.isInstanceOfType(r)&&r.$6J&&(u=r.$6J.correlationId));n?_a.$8.$1I(n,t,i,u):_a.$8.$1I(null,t,i,u);_a.$8.endPT(t)},$2I4:function(n){n.$48([_ex.$2I.$7ry("GetInitialData",this.$$d_$8Tu),_ex.$2I.$I("EwsRequest",this.$$d_$81h),_ex.$2I.$I("saveSettingsAsync",this.$$d_$81v),_ex.$2I.$I("RecordDataPoint",this.$$d_$9bA),_ex.$2I.$I("RecordTrace",this.$$d_$9bE),_ex.$2I.$I("TrackCtq",this.$$d_$A9A),_ex.$2I.$I("GetUserIdentityToken",this.$$d_$81k),_ex.$2I.$I("DisplayNewAppointmentForm",this.$$d_$81c),_ex.$2I.$I("DisplayExistingAppointmentForm",this.$$d_$81a),_ex.$2I.$I("DisplayExistingMessageForm",this.$$d_$81b),_ex.$2I.$I("LaunchPalUrl",this.$$d_$8oF)])},$36u:function(n){this.$2ZX|=n},$pA:function(n,t,i){if(n>t){_js.Trace.logWarning(_a.$0.$4F,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",i,this.$8k.$5c.DisplayName,t,n);return!0}return!1},$1TR:function(n,t){if(this.$2ZC<3){var r=n.val;var i=this;n.val=function(n){i.$7pg();r(n)};this.$2ZC++;return!0}n.val(t);return!1},$7pg:function(){this.$2ZC--},$A92:function(n){if(!_js.$A.$o(n)){n===OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd?this.$3EN(!0):n===OSF.OsfControlActivationPerfMarker.SelectionTimeout?this.$3EN(!1):n===OSF.OsfControlActivationPerfMarker.ActivationStart&&this.$2Ic++;if(n.endsWith("Start")){n=n.substr(0,n.length-5);var i=_js.$I.s(_a.$0.$4F,517,n);this.$1wk[n]=i}else if(n.endsWith("End")){n=n.substr(0,n.length-3);var t=this.$1wk[n];if(t){_js.$I.e(t);delete this.$1wk[n]}}}},$5Ps:function(n,t){var i="";_ex.$5X.get_$P().$3Aj(n)&&(i=_ex.$5X.get_$P().$8Xv(n).TokenValue);t({wasSuccessful:!0,token:i})},$4gT:function(n,t,i){for(var f=new(_ff.$1E.$$(String)),r=0;r<this.$Jg.Extensions.length;r++){var e=this.$Jg.Extensions[r];(n==="CallerIdentity"&&e.RequestedCapabilities>=1||n==="ExtensionCallback"&&e.RequestedCapabilities===2)&&f.$F(this.$Jg.Extensions[r].Id)}var u=new _ex.$uM(f.$3e(),n);u.add_$2x(t);u.add_$2d(i);this.$m.$1T(u)},$5Pp:function(n,t,i){var s=t;var o=s.body;var f="";if(_ex.$5X.get_$P().$3Ai(n.Id)){f=_ex.$5X.get_$P().$8T6(n.Id).TokenValue;var r=new _ex.$uA(o,f,n.Id);var u=this;r.add_$2x(function(n){i({wasProxySuccessful:r.get_$4i().WasProxySuccessful,errorMessage:r.get_$4i().ErrorMessage,statusCode:r.get_$4i().StatusCode,statusDescription:r.get_$4i().StatusDescription,body:r.get_$4i().Body});u.$Da(u.$14j,"ExecuteEwsRequest","",r)});var e=this;r.add_$2d(function(n){i({wasProxySuccessful:!1,errorMessage:r.$2I.message,statusCode:500,statusDescription:r.$2I.message,body:null});e.$Da(e.$14j,"ExecuteEwsRequest",r.$2I.message,r)});this.$m.$1T(r)}else i({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})},$4yR:function(){if(!this.$144){var r=this.$6a.$6E("ExtAppVistedUrls");var u=this.$8k.$1Ui.toLowerCase();this.$144=_js.$A.$o(r)?3:-1!==r.indexOf(u)?1:2}if(!this.$2I8&&this.$1pP&&this.$144!==1){var t=this.$6a.$6E("ExtAppVistedUrls");var i=this.$8k.$1Ui.toLowerCase();if(t){t.length>5e3&&(t=t.substr(i.length));t+=i}else t=i;this.$6a.$If("ExtAppVistedUrls",t);this.$2I8=!0}var n=new _a.$48;n.$5F("G",this.$2QR);n.$5F("S",this.$144);n.$5F("Sc",this.get_$9hB());this.$1Ug&&n.$5F("E",this.$1Ug);n.$5F("R",this.$2Ic);n.$5F("F",this.$2ZX);n.$C7("Id",this.$8k.$5c.Id);n.$C7("Name",this.$8k.$5c.DisplayName);return n.toString()},$9Ot:function(n){if(n.get_$IA()){var i=this;this.$qp.$I(function(t){var r=t.$HO(!0,!1);r.$52h(n);i.$xT.$I(function(n){i.$H.$WF(IMailComposeViewModelFactory,function(){return n},null,_bc.$2V.get_$sq(),r,!1)})})}else{var t=this;this.$xL.$I(function(i){var r=i.$I(!1);r.set_$D(n);t.$f5.$I(function(n){t.$H.$WF(IItemReadingPaneViewModelPopOutFactory,function(){return n},null,_bc.$2V.get_$sq(),r,!1)})})}},$85N:function(n){var t=new _bc.$Qw;if("requiredAttendees"in n){t.set_$BJ(new _js.$Z);var e=n.requiredAttendees;if(this.$pA(e.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var f=0;f<e.length;f++)t.get_$BJ().$F(_g.$2w.$4pM(e[f]))}if("optionalAttendees"in n){t.set_$CZ(new _js.$Z);var o=n.optionalAttendees;if(this.$pA(o.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var i=0;i<o.length;i++)t.get_$CZ().$F(_g.$2w.$4pM(o[i]))}if("start"in n&&!$B(n.start)){var v=n.start;var w=new Date(v);t.set_$1R(_a.$7.$4pK(w))}else{var a=_a.$1d.$3BE(_a.$7.get_$3A());t.set_$1R(a)}if("end"in n){var p=n.end;var y=new Date(p);t.set_$MC(_a.$7.$4pK(y).$6P(t.get_$1R()))}else t.set_$MC(18e5);if("subject"in n){var s=n.subject;if(this.$pA(s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;t.set_$3t(s)}if("body"in n){var u=n.body;if(this.$pA(u.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var r;r=this.$H.get_$T()==="Mouse"?new _g.$5g("HTML",_a.$1P.$4gB(u)):new _g.$5g("Text",u);var l=new _g.$5B(r);t.set_$4u(l)}var h=_g.$3V.$1Ew();if("location"in n){var c=n.location;if(this.$pA(c.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;h.set_$27(c)}t.set_$6C(h);return t},$8U6:function(n,t){var f=_h.$r.get_$P();var i=f.$6E(n);if($B(i)||$B(i.get_$4u()))if(!$B(i)&&i.get_$IA())this.$4xR(n,i.get_$12G(),t);else{var u=this;var r=function(i){i.get_$IA()?u.$4xR(n,i.get_$12G(),t):t(i)};this.$3iC(n,_h.$k.get_$46e(),"ItemNormalizedBody",r)}else t(i)},$4xR:function(n,t,i){var r;r=this.$H.get_$T()==="Mouse"&&t!==1?_h.$k.get_$2VC():_h.$k.get_$3Rl();this.$3iC(n,r,"MailCompose",i)},$3iC:function(n,t,i,r){var f=new _g.$1b(n);var u=new _h.$uQ(100,[f],t,i,0,!1);var o=this;u.add_$2x(function(t){var i=_h.$r.get_$P().$6E(n);r(i)});var e=this;u.add_$2d(function(n){_js.Trace.logError(_a.$0.$4F,"GetItem failed with "+n.$2I)});this.$m.$1T(u)},$5ja:function(n){this.$H.$Cc(n)}};_ex.$hz=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$jy=n;this.$Ns=t;this.$Pu=i;this.$s9=r;this.$H=u;this.$xL=f;this.$f5=e;this.$qp=o;this.$1Hr=s;this.$19=h;this.$l=c;this.$m=l;this.$1C=a};_ex.$hz.prototype={$jy:null,$Ns:null,$Pu:null,$s9:null,$H:null,$qp:null,$1Hr:null,$xL:null,$f5:null,$1C:null,$vW:null,$xT:null,$vg:null,$19:null,$l:null,$m:null,$4h0:function(n,t){return new _ex.$19A(this.$H,this.$jy,this.$s9,this.$Ns,this.$Pu,t,this.$vg,this.$vW,this.$xT,this.$qp,this.$1Hr,this.$xL,this.$f5,n,this.$19,this.$l,this.$m,this.$1C)},$65d:function(n){return new _ex.$194(this.$H,this.$jy,this.$s9,this.$Ns,this.$Pu,this.$vg,this.$vW,this.$xT,this.$qp,this.$1Hr,this.$xL,this.$f5,n,this.$19,this.$l,this.$m,this.$1C)},$66R:function(n){return new _ex.$199(n,this.$H,this.$jy,this.$s9,this.$Ns,this.$Pu,this.$vg,this.$vW,this.$xT,this.$qp,this.$xL,this.$f5,this.$19,this.$l,this.$m)},$65Z:function(n){return new _ex.$193(n,this.$H,this.$jy,this.$s9,this.$Ns,this.$Pu,this.$vg,this.$vW,this.$xT,this.$qp,this.$xL,this.$f5,this.$19,this.$l,this.$m)}};_ex.$199=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_ex.$199.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$3Er=n};_ex.$199.prototype={$3Er:null,get_$9hB:function(){return 3},$1EB:function(n,t){n.itemType=4;n.conversationId=this.$3Er.$4xD();var i=this;_ex.$1hM.prototype.$1EB.call(this,n,function(){t()})}};_ex.$19A=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_ex.$19A.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b])};_ex.$19A.prototype={get_$9hB:function(){return 4},$1EB:function(n,t){var i=this.$c.get_$CO()?this.$c.get_$CO().toLowerCase():"";if(_ex.$EX.$56y(i)){if(_g.$9k.isInstanceOfType(this.$c)){n.itemType=3;this.$7fK(n)}else n.itemType=1;this.$8p6(n,t)}else _ex.$4M.prototype.$1EB.call(this,n,t)},$8p6:function(n,t){var r=this.$c;n.conversationId=r.get_$5b()?r.get_$5b().Id:null;n.internetMessageId=r.get_$Hq();if(this.get_$1HE())_ex.$4M.prototype.$1EB.call(this,n,t);else if(r.$26s){this.$36u(16);var i=new _h.$uK(this.$c.get_$x());var f=this;i.add_$2d(function(){_js.Trace.logWarning(_a.$0.$4F,"GetAllRecipients to fetch extra recipients failed "+i.$2I);f.$36u(256)});var u=this;i.add_$4e(function(){u.$4Yy(n,t)});OwaApplication.$2D.$1T(i)}else this.$4Yy(n,t)},$4Yy:function(n,t){var i=this.$c;_ex.$4M.$36e(n,"from",i.get_$5d());_ex.$4M.$36e(n,"sender",i.get_$Ew());_ex.$4M.$4YM(n,"to",i.get_$7J());_ex.$4M.$4YM(n,"cc",i.get_$8D());n.itemType===3&&this.$7gf(n);_ex.$4M.prototype.$1EB.call(this,n,t)},$7gf:function(n){var t=this.$c;_ex.$4M.$1SQ(n,"to",t.get_$Qo().get_$BJ(),t.get_$Qo().get_$JU());_ex.$4M.$1SQ(n,"cc",t.get_$Qo().get_$CZ(),null);_ex.$4M.$1SQ(n,"resources",t.get_$Qo().get_$Ee(),null)},$7fK:function(n){var t=this.$c;t.get_$Qo().get_$6C()&&(n.location=t.get_$Qo().get_$6C().get_$27());t.get_$Qo().get_$1R()&&(n.start=t.get_$Qo().get_$1R().$dD().getTime());t.get_$Qo().get_$2s()&&(n.end=t.get_$Qo().get_$2s().$dD().getTime())}};_ex.$i0=function(n){this.$1wL={};this.$38T=n};_ex.$i0.$$=function(n){var t="$i0"+"$"+n.getName().replace(/\./g,"_");if(!_ex[t]){var r=_ex[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_ex.$i0.apply(this,t)};r.registerClass("_ex."+t);var e={"_ex.$i0":{T:n}};r.prototype.$$gta=e;var f=_ex.$i0.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _ex[t]};_ex.$i0.prototype={$38T:null,$1Ay:0,$F:function(n){var t=this.$38T+(+new Date).toString()+this.$1Ay.toString();this.$1wL[t]=n;this.$1Ay++;return t},$7gm:function(n,t){this.$1wL[n]=t;return n},$9g1:function(n,t){var i=this.$1wL[n];t&&delete this.$1wL[n];return i}};_ex.$4M=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.$$d_$81d=Function.createDelegate(this,this.$81d);this.$$d_$81e=Function.createDelegate(this,this.$81e);this.$$d_$4nA=Function.createDelegate(this,this.$4nA);this.$$d_$4n4=Function.createDelegate(this,this.$4n4);this.$$d_$81j=Function.createDelegate(this,this.$81j);_ex.$4M.initializeBase(this,[n,t,i,r,u,e,o,s,h,l,a,y,p,w]);this.$l3=f;this.$c=v;this.$1C=b;this.$1Hr=c};_ex.$4M.$36e=function(n,t,i){$B(i)||(n[t]=_ex.$4M.$4hF(i.Mailbox))};_ex.$4M.$4YM=function(n,t,i){if(!$B(i)&&i.get_$9()>0){for(var f=[],r=0;r<i.get_$9()&&r<100;r++){var u=i.get_$D(r);$B(u)||(f[r]=_ex.$4M.$4hF(u))}n[t]=f}};_ex.$4M.$1SQ=function(n,t,i,r){var f=null;var o=0;var s=!1;if(r&&r.Mailbox){s=!0;f=new Array(0);f[o++]=_ex.$4M.$4gY(r.Mailbox,"Organizer")}if(!$B(i)&&i.get_$9()>0){f||(f=new Array(0));for(var e=0;e<i.get_$9()&&o<100;e++){var u=i.get_$D(e);if(u&&u.get_$AH()){if(s&&r.Mailbox.EmailAddress&&u.get_$AH().EmailAddress&&u.get_$AH().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;f[o++]=_ex.$4M.$4gY(u.get_$AH(),u.get_$jg())}}}n[t]=f};_ex.$4M.$4hF=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_ex.$4M.$3Rv(n.MailboxType);return t};_ex.$4M.$3Rv=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_ex.$4M.$7fD=function(n,t){if(!$B(t)&&t.get_$9()>0){for(var f=[],u=0;u<t.get_$9();u++){var i=t.get_$D(u);var r={};if(i){r.id=i.get_$6K().Id;r.name=i.get_$1w();r.contentType=i.get_$Kz();r.size=i.get_$8A();r.attachmentType=_g.$56.isInstanceOfType(i)?0:1;r.isInline=i.get_$Cn();f[u]=r}}n.attachments=f}};_ex.$4M.$4gY=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_ex.$4M.$3Rv(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};_ex.$4M.prototype={$l3:!1,$1C:null,$1Hr:null,$c:null,get_$2Ii:function(){return"ReadAppSelection"},get_$4aT:function(){return"ReadAppSelectionToProgressDone"},$81j:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteGetCallbackTokenRequest",5);var i=_a.$8.$1g(_a.$0.$4F,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1HE()){_js.Trace.logInfo(_a.$0.$4F,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$8k.$5c.DisplayName);t(_ex.$1Z.$1VJ);this.$Da(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var f,e;if(!(e=this.$1TR(f={val:t},_ex.$1Z.get_$2J8()),t=f.val,e)){this.$Da(i,"ExecuteGetCallbackTokenRequest",_ex.$1Z.get_$13t(),null);return}var r=new _ex.$iz(this.$8k.$5c.Id,String.format("ParentItemId:{0}",this.$c.get_$x().Id));var u=this;r.add_$2x(function(n){u.$9P5(t,n);u.$Da(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$2d(function(n){t({wasSuccessful:!1});o.$Da(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$2D.$1T(r)},$4n4:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteLoadCustomPropRequest",5);var r=_a.$8.$1g(_a.$0.$4F,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _ex.$k8(this.$8k.$5c.Id,this.$c.get_$x().Id);var f,u;if(!(u=this.$1TR(f={val:t},_ex.$1Z.get_$2J8()),t=f.val,u)){this.$Da(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$2x(function(n){t({errorMessage:i.get_$4i().ErrorMessage,wasSuccessful:i.get_$4i().WasSuccessful,customProperties:i.get_$4i().CustomProperties});e.$Da(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$2d(function(n){t({errorMessage:i.$2I.message,wasSuccessful:!1,customProperties:null});o.$Da(r,"ExecuteLoadCustomPropRequest",i.$2I.message,n)});OwaApplication.$2D.$1T(i)},$4nA:function(n,t){_a.$8.stPT(_a.$0.$4F,"ExecuteSaveCustomPropRequest",5);var r=_a.$8.$1g(_a.$0.$4F,"ExecuteSaveCustomPropRequest",!0);var c=n;var h=c.customProperties;var e=JsonParser.serialize(h);if(this.$pA(e.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_ex.$1Z.$1VJ);this.$Da(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var u,f;if(!(f=this.$1TR(u={val:t},_ex.$1Z.get_$2J8()),t=u.val,f)){this.$Da(r,"ExecuteSaveCustomPropRequest",_ex.$1Z.get_$13t(),null);return}var i=new _ex.$x1(this.$8k.$5c.Id,this.$c.get_$x().Id,e);var o=this;i.add_$2x(function(n){t({errorMessage:i.get_$4i().ErrorMessage,wasSuccessful:i.get_$4i().WasSuccessful});o.$Da(r,"ExecuteSaveCustomPropRequest","",n)});var s=this;i.add_$2d(function(n){t({errorMessage:i.$2I.message,wasSuccessful:!1});s.$Da(r,"ExecuteSaveCustomPropRequest",i.$2I.message,n)});OwaApplication.$2D.$1T(i)},$81e:function(n,t){if(!this.$8lO()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$pA(r.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}this.$5jK(1,r);t(null)},$81d:function(n,t){if(!this.$8lN()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$pA(r.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}this.$5jK(2,r);t(null)},$1EB:function(n,t){if(this.$8ja())this.$8p5(n,t);else{this.$36a(n);t()}},$2I4:function(n){_ex.$1Z.prototype.$2I4.call(this,n);n.$48([_ex.$2I.$I("GetCallbackToken",this.$$d_$81j),_ex.$2I.$I("LoadCustomProperties",this.$$d_$4n4),_ex.$2I.$I("SaveCustomProperties",this.$$d_$4nA),_ex.$2I.$I("DisplayReplyForm",this.$$d_$81e),_ex.$2I.$I("DisplayReplyAllForm",this.$$d_$81d)])},$36a:function(n){n.id=this.$c.get_$x().Id;n.itemClass=this.$c.get_$CO();this.$c.get_$1F9()&&(n.dateTimeCreated=this.$c.get_$1F9().$dD().getTime());this.$c.get_$KK()&&(n.dateTimeModified=this.$c.get_$KK().$dD().getTime());this.$c.get_$19T()&&(n.dateTimeSent=this.$c.get_$19T().$dD().getTime());$B(this.$c.get_$sn())||(n.entities=this.$8TA(this.$c.get_$sn()));var i=this.$Ww.$gW.$8Sh();i&&(n.filteredEntities=i);if(!this.get_$1HE()){n.subject=this.$c.get_$3t();n.normalizedSubject=this.$c.get_$1CG();var t=this.$Ww.$1ao;$B(t)||(n.regExMatches=t);_ex.$4M.$7fD(n,this.$c.get_$F2())}},$8ja:function(){if(this.$c.get_$sn())return!1;var n=this.$c.get_$2z5();return n?n.ExtractedAddresses||n.ExtractedContacts||n.ExtractedEmails||n.ExtractedMeetings||n.ExtractedPhones||n.ExtractedTasks||n.ExtractedUrls:!1},$8p5:function(n,t){var i=new _ex.$uP(this.$c);var u=_a.$7.get_$3A();var f=this;i.add_$2x(function(i){f.$1Ug=_a.$7.get_$3A().$6P(u);f.$36a(n);t()});var r=this;i.add_$2d(function(f){_js.Trace.logWarning(_a.$0.$4F,"GetItem to fetch entities failed "+i.$2I);r.$36u(1);r.$1Ug=_a.$7.get_$3A().$6P(u);r.$36a(n);t()});OwaApplication.$2D.$1T(i)},$8TA:function(n){var t={};t.Addresses=_ex.$3y.$15R(n.Addresses,3,this.$l3);t.Urls=_ex.$3y.$15R(n.Urls,4,this.$l3);t.PhoneNumbers=_ex.$3y.$15R(n.PhoneNumbers,5,this.$l3);if(!this.get_$1HE()){t.Contacts=_ex.$3y.$15R(n.Contacts,7,this.$l3);t.EmailAddresses=_ex.$3y.$15R(n.EmailAddresses,6,this.$l3);t.MeetingSuggestions=_ex.$3y.$15R(n.MeetingSuggestions,1,this.$l3);t.TaskSuggestions=_ex.$3y.$15R(n.TaskSuggestions,2,this.$l3)}return t},$5jK:function(n,t){var i=this;this.$qp.$I(function(r){var u=r.$HO(!0,!1);u.set_$6h(n);u.$1XJ(i.$c);var e=u.$1oL(!0);var f;if(n===1)f=new _g.$cM;else if(n===2)f=new _g.$cL;else return;f.$3kT(e.get_$Ay());f.set_$2Xx(new _g.$5B(new _g.$5g("HTML",t)));f.set_$2zY(i.$c.get_$x());u.$6ZZ(f);i.$1Hr.$I(function(n){var t=n.$4hI(u,f,i.$1C);t.$N4=0;t.add_$2x(function(n){_js.Trace.logInfo(_a.$0.$4F,"Create response action succeeded");var t=n;if(t.$9a===u.get_$DX()){u.$AU();u.set_$6b(0);u.set_$6h(4);u.set_$GD(t.$6B);var i=new _y.$DP;i.$WA(u)}});OwaApplication.$2D.$1T(t)})})},$8lN:function(){return this.$c?_g.$2r.isInstanceOfType(this.$c)?this.$c.get_$vX():!0:!1},$8lO:function(){return this.$c?_g.$2r.isInstanceOfType(this.$c)?this.$c.get_$sV():!0:!1},$9P5:function(n,t){var i="";t&&_ex.$iz.isInstanceOfType(t)&&t.$QV&&(i=t.$QV.TokenValue);n({wasSuccessful:!0,token:i})}};_ex.$19U=function(n,t,i){_ex.$19U.initializeBase(this,[t,i]);this.$7L=n};_ex.$19U.prototype={$7L:null,get_$V4:function(){return"GetBodyType"},get_$5TH:function(){return 1},$81U:function(){var t=this.$7L.$2QA();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");this.$VC(n,null)}};_ex.$19e=function(n,t,i){_ex.$19e.initializeBase(this,[t,i]);this.$Nz=n};_ex.$19e.prototype={$Nz:null,get_$V4:function(){return"GetLocation"},get_$5TH:function(){return 1},$81U:function(){var n=this.$Nz.$3KW();this.$VC(n,null)}};_ex.$iy=function(n,t,i){_ex.$iy.initializeBase(this,[t,i]);this.$7L=n};_ex.$iy.$84p=function(n){var u=[];if(!n)return u;for(var f=n.get_$9()>100?100:n.get_$9(),t=0;t<f;t++){var r=n.get_$D(t).get_$2aU();var i={};i.recipientType=_ex.$4M.$3Rv(r.get_$2c().MailboxType);i.address=r.get_$2c().EmailAddress||null;i.name=r.get_$27();u[t]=i}return u};_ex.$iy.prototype={$7L:null,get_$V4:function(){return"GetRecipients"},get_$5TH:function(){return 1},$81U:function(){var i=this.$1m.recipientField;var t=this.$7L.$8W7(i);var n=_ex.$iy.$84p(t);this.$VC(n,null)}};_ex.$19s=function(n,t,i){_ex.$19s.initializeBase(this,[t,i]);this.$7L=n};_ex.$19s.prototype={$7L:null,get_$V4:function(){return"GetSubject"},get_$5TH:function(){return 1},$81U:function(){var n=this.$7L.$wt();this.$VC(n||"",null)}};_ex.$19q=function(n,t,i){_ex.$19q.initializeBase(this,[t,i]);this.$7L=n};_ex.$19q.prototype={$7L:null,get_$V4:function(){return"GetSelectedData"},get_$5TH:function(){return 1},$81U:function(){var e=this.$1m;var n=0;var t;var s=e.coercionType;var f,r,u;var o=(u=this.$7L.$8Wm(s===_ex.$1gS.$Wm.toString(3)?_ex.$1gS.$Wm.toString(3):_ex.$1gS.$Wm.toString(0),f={val:t},r={val:n}),t=f.val,n=r.val,u);if(n)this.$aN(n,null);else{var i={};i.data=o;i.sourceProperty=t;this.$VC(i,null)}}};_ex.$19v=function(n,t,i){_ex.$19v.initializeBase(this,[t,i]);this.$Nz=n};_ex.$19v.prototype={$Nz:null,get_$V4:function(){return"GetTime"},get_$5TH:function(){return 1},$81U:function(){var n=null;var t=this.$1m.TimeProperty;t===1?n=this.$Nz.$40H():t===2&&(n=this.$Nz.$3zg());this.$VC(n.$dD().getTime(),null)}};_ex.$1C1=function(n,t,i,r,u){this.$$d_$2Uu=Function.createDelegate(this,this.$2Uu);this.$$d_$290=Function.createDelegate(this,this.$290);_ex.$1C1.initializeBase(this,[t,u]);this.$O0=i;this.$7L=n;this.$m=r};_ex.$1C1.prototype={$O0:null,$7L:null,$m:null,get_$V4:function(){return"ExecuteLoadCustomPropRequestForCompose"},get_$5TH:function(){return 0},$81U:function(){var t=this.$7L.$3KH();if(t)for(var n=t.get_$9()-1;n>=0;n--)if(_h.$6N.$54z(t.get_$D(n),this.$O0)){this.$2bG({wasSuccessful:!0,customProperties:t.get_$D(n).get_$1b()},null);return}var r=this.$7L.$2QT();if(!r){this.$2bG({wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$1m;var i=new _ex.$k8(this.$O0,this.$7L.$2QT());i.add_$2x(this.$$d_$290);i.add_$2d(this.$$d_$2Uu);this.$m.$1T(i)},$290:function(n){var t=n;var r={wasSuccessful:t.get_$4i().WasSuccessful,customProperties:t.get_$4i().CustomProperties};if(!_js.$A.$o(t.get_$4i().CustomPropertyNames)){var i=this.$7L.$3KH();_h.$6N.$4YX(i,t.get_$4i().CustomPropertyNames)}this.$2bG(r,n.$9a)},$2Uu:function(n){_js.Trace.logError(_a.$0.$4F,"custom properties load failed with "+n.$2I);var t={errorMessage:n.$2I.message,wasSuccessful:!1,customProperties:null};this.$9gD(t,n.$2I.message,n.$9a)}};_ex.$1Ej=function(n,t,i){this.$$d_$69M=Function.createDelegate(this,this.$69M);_ex.$1Ej.initializeBase(this,[t,i]);this.$k3=n};_ex.$1Ej.prototype={$k3:null,$13w:null,$1Sr:null,get_$V4:function(){return"RemoveAttachment"},get_$5TH:function(){return 3},$81U:function(){this.$1Sr=this.$1m.attachmentIndex;if(this.$1Sr.length>200){_js.Trace.logError(_a.$0.$4F,"RemoveFileAttachment got too long attachmentId");this.$hg();return}if(!this.$1Sr){_js.Trace.logError(_a.$0.$4F,"RemoveAttachment got null or empty attachmentIndex");this.$hg();return}this.$13w=this.$k3.$9g1(this.$1Sr,!0);if(!this.$13w){this.$aN(9008,null);return}if(this.$13w.get_$1hU()){this.$VC(null,null);return}this.$13w.add_$1wU(this.$$d_$69M);this.$13w.get_$1FE().$11()},$69M:function(n){this.$13w.remove_$1wU(this.$$d_$69M);if(n.get_$3Yp()){this.$k3.$7gm(this.$1Sr,this.$13w);this.$aN(9009,null);return}this.$VC(null,null)}};_ex.$Mx=function(n,t,i,r){_ex.$Mx.initializeBase(this,[t,r]);this.$O0=i;this.$7L=n};_ex.$Mx.prototype={$O0:null,$7L:null,get_$V4:function(){return"ExecuteSaveCustomPropRequestCompose"},get_$5TH:function(){return 0},$81U:function(){var f=this.$1m;var e=f.customProperties;var u=JsonParser.serialize(e);if(u.length>2500){this.$hg();return}for(var r=_h.$6N.$7sh(this.$O0,u),n=this.$7L.$3KH(),i=!1,t=0;t<n.get_$9();t++)if(_h.$6N.$54z(n.get_$D(t),this.$O0)){n.set_$D(t,r);i=!0;break}i||this.$7fr(n,r);this.$7L.$8qz();this.$2bG(_ex.$Mx.$4iR,null)},$7fr:function(n,t){n.$F(t);_h.$6N.$4YX(n,t.get_$Mt().get_$Nk())}};_ex.$1hG=function(n,t,i,r){this.$$d_$9go=Function.createDelegate(this,this.$9go);this.$$d_$9gp=Function.createDelegate(this,this.$9gp);_ex.$1hG.initializeBase(this,[t,i]);this.$7L_1=n;this.$m=r};_ex.$1hG.prototype={$7L_1:null,$m:null,$vc:0,$81U:function(){var i=this.$1m;var n=i.data;if(n.length>1e6){this.$hg();return}var u,r;if(r=this.$AFb(i.coercionType,u={val:this.$vc}),this.$vc=u.val,r)if(this.$vc===3)if(_js.$A.$o(n))this.$2SK("");else{var t=new _ex.$1Ey(n);t.add_$2x(this.$$d_$9gp);t.add_$2d(this.$$d_$9go);this.$7L_1.$A5m();this.$m.$1T(t)}else this.$7L_1.$2QA()==="HTML"?this.$2SK(_ff.$2n.$KX(n)):this.$2SK(n)},$9go:function(n){_js.Trace.logError(_a.$0.$4F,"Sanitize html failed with "+n.$2I);this.$aN(9011,null)},$9gp:function(n){_js.Trace.logInfo(_a.$0.$4F,"Sanitize html succeeded.");if(this.$7L_1.$2QA()==="HTML"){var u=n;var t=u.get_$4i();var r;this.$9e2(r={val:t}),t=r.val;var i=this;this.$7L_1.$7nQ(function(n){n?i.$aN(9014,null):i.$2SK(t)})}else this.$aN(2006,null)},$9e2:function(n){n.val=n.val.trim();n.val.substr(0,5).toLowerCase()==="<div>"&&n.val.substr(n.val.length-6,6).toLowerCase()==="</div>"&&(n.val=n.val.substring(5,n.val.length-6))},$AFb:function(n,t){var i=this.$7L_1.$2QA();t.val=n;if(!$B(n)){if(i==="Text"&&t.val===3){this.$aN(2006,null);return!1}return!0}this.$hg();return!1}};_ex.$1FV=function(n,t,i){_ex.$1FV.initializeBase(this,[t,i]);this.$Nz=n};_ex.$1FV.prototype={$Nz:null,get_$V4:function(){return"SetLocation"},get_$5TH:function(){return 3},$81U:function(){var n=this.$1m.location;if(n.length>255)this.$hg();else{this.$Nz.$9zE(n);this.$VC(null,null)}}};_ex.$1Fd=function(n,t,i){_ex.$1Fd.initializeBase(this,[t,i]);this.$7L=n};_ex.$1Fd.prototype={$7L:null,get_$V4:function(){return"SetSubject"},get_$5TH:function(){return 3},$81U:function(){var n=this.$1m.subject;if(n.length>255){this.$hg();return}this.$7L.$A0U(n);this.$VC(null,null)}};_ex.$1Fc=function(n,t,i,r){_ex.$1Fc.initializeBase(this,[n,t,i,r]);this.$7L=n};_ex.$1Fc.prototype={$7L:null,get_$V4:function(){return"SetSelectedData"},get_$5TH:function(){return 3},$2SK:function(n){var t;var i;this.$7L.$A0G(n,this.$vc===3,i={val:t}),t=i.val;t?this.$aN(t,null):this.$VC(null,null)}};_ex.$1Ff=function(n,t,i){_ex.$1Ff.initializeBase(this,[t,i]);this.$Nz=n};_ex.$1Ff.prototype={$Nz:null,get_$V4:function(){return"SetTime"},get_$5TH:function(){return 3},$81U:function(){var i=this.$1m.TimeProperty;var r=this.$1m.time;var n=_a.$7.$sw(new Date(r));var t=!0;i===1?this.$Nz.$A0Q(n):i===2&&(t=this.$Nz.$AAF(n));t?this.$VC(null,null):this.$aN(9010,null)}};_ex.$2I=function(n,t,i){this.$XK=n;this.$nm=t;this.$38d=i};_ex.$2I.$I=function(n,t){return new _ex.$2I(n,t,!1)};_ex.$2I.$7ry=function(n,t){return new _ex.$2I(n,t,!0)};_ex.$2I.prototype={$XK:null,$38d:!1,$nm:null};_ex.$1Gy=function(n,t){this.$1dN=n;this.$3W=t};_ex.$1Gy.prototype={$1dN:null,$3W:null,get_$F3K:function(){return this.$1dN},get_$1w:function(){return this.$3W},get_$8A:function(){return 0},get_$6l:function(){return""}};_ex.$tT=function(n,t){this.$$d_$2NP=Function.createDelegate(this,this.$2NP);this.$$d_$4zt=Function.createDelegate(this,this.$4zt);_ex.$tT.resolveInheritance();this.apcl=this.$n;this.rpcl=this.$1B;this.dispose=this.$1t;_ex.$tT.initializeBase(this);this.$5q=n;this.$Os=t;if(this.$Os==="TouchNarrow"){this.set_$AK(_y.$1s.$FV(this));var r=this;var i=new _C(function(){r.$4x()},_a.$0.$4F);this.$5k.set_$U4([_y.$1T.$ST(_u.ExtStrings.l_Close_LowerCase_Text,i)])}};_ex.$tT.prototype={$Os:0,$7U:null,$5q:null,$x4:!1,$14P:null,$rI:null,get_$2yg:function(){return 2},get_$40l:function(){return this.$$d_$4zt},get_$iZ:function(){return this.$7U},set_$iZ:function(n){this.$7U=n;return n},get_$7yW:function(){return!0},get_$TB:function(){return this.$Os==="TouchNarrow"?1:0},$4zt:function(n,t){if(this.$x4)return!1;if(this.$rI){this.$14P=n;this.$rI(this.$$d_$2NP);return!0}this.$2NP();return!1},$4x:function(){if(!this.$x4&&this.$7U){this.$7U();this.$5q.$38Q(!1)}},$2NP:function(){this.$x4=!0;this.$14P&&this.$14P()}};_ex.$Ll=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$9OS=Function.createDelegate(this,this.$9OS);this.$$d_$5QV=Function.createDelegate(this,this.$5QV);this.$$d_$4o5=Function.createDelegate(this,this.$4o5);this.$$d_$72A=Function.createDelegate(this,this.$72A);this.$$d_$9M3=Function.createDelegate(this,this.$9M3);this.$$d_$9PI=Function.createDelegate(this,this.$9PI);this.$$d_$7Qe=Function.createDelegate(this,this.$7Qe);_ex.$Ll.resolveInheritance();this.apcl=this.$n;this.rpcl=this.$1B;this.dispose=this.$1t;_ex.$Ll.initializeBase(this,[r,u,f,e,o,s,h,c,l,a,v,y,p,w]);_a.$8.stPT(_a.$0.$4F,"EnableAppsButton",5);this.$1zT=_a.$8.$1g(_a.$0.$4F,"EnableAppsButton",!0);this.$Fe=t;this.set_$37Y(_u.ExtStrings.l_ComposeAppsForOutlook_Text);this.set_$3M2(!1);this.set_$1Sh(!0);this.$2Ig=i;this.$ur=new _C(this.$$d_$7Qe,n);this.$ur.set_$6W(!1);this.$3Lz=new _C(this.$$d_$9PI,n);this.$38R=new _C(this.$$d_$9M3,n)};_ex.$Ll.prototype={$16A:null,$2Ih:null,$2RZ:!1,$2Ig:null,$1cU:!1,$2Ni:!1,$1Sg:!1,$2If:0,$ur:null,$3Lz:null,$38R:null,$2Io:!1,$Fe:null,$Sw:null,$1zT:null,add_$2YT:function(n){this.$36("OnAppsPaneOpened",n)},remove_$2YT:function(n){this.$5v("OnAppsPaneOpened",n)},add_$5Ov:function(n){this.$36("OnAppsPaneClosed",n)},remove_$5Ov:function(n){this.$5v("OnAppsPaneClosed",n)},add_$2Ye:function(n){this.$36("OnExtensionOpened",n)},remove_$2Ye:function(n){this.$5v("OnExtensionOpened",n)},add_$3Xv:function(n){this.$36("BackToList",n)},remove_$3Xv:function(n){this.$5v("BackToList",n)},get_$Ego:function(){return"ShowAppsButton"},get_$2FW:function(){return this.$ur},set_$84a:function(n){if(this.$2Ni!==n){this.$2Ni=n;this.$4("ForceHideAppsButton")}return n},get_$4PY:function(){return this.$1cU},set_$4PY:function(n){if(this.$1cU!==n){this.$1cU=n;this.$4("ShowAppsButton")}return n},get_$3na:function(){return this.$2If},set_$3na:function(n){if(this.$2If!==n){this.$2If=n;this.$4("AppPaneSize")}return n},get_$1Sh:function(){return this.$1Sg},set_$1Sh:function(n){if(this.$1Sg!==n){this.$1Sg=n;this.$4("AppPaneIsHidden")}return n},get_$15z:function(){return this.$Fe.$c2===1},get_$6gq:function(){return this.$St.get_$T()==="TouchNarrow"},set_$5BD:function(n){this.$16A=n;if(n.$ef===3){var t=this.$16A.$3Ec.get_$2n().extensionViewModel;this.$1Pr(t)}return n},set_$37Y:function(n){if(this.$2Ih!==n){this.$2Ih=n;this.$4("AppPaneTitle")}return n},set_$3M2:function(n){if(this.$2RZ!==n){this.$2RZ=n;this.$4("HideExtensionsList")}return n},get_$3Pz:function(){return this.$St.get_$T()!=="Mouse"},$7Z:function(){this.$5Wg();this.set_$1Sh(!0);this.$8bm();this.$Fe&&this.$Fe.$n("Orientation",this.$$d_$72A);_ex.$2G.prototype.$7Z.call(this)},$AO:function(){this.$AAc();this.$Fe&&this.$Fe.$1B("Orientation",this.$$d_$72A);_ex.$2G.prototype.$AO.call(this)},$1Pr:function(n){if(n){this.set_$3M2(!0);this.set_$1rx(!1);this.set_$37Y(n.get_$1ff().DisplayName);if(this.$l.$8G(this.$l.get_$Ip())){var t=this;this.$l.get_$Ip().$4mO(n.get_$4mV(),n.get_$1ff().DisplayName,function(){t.$5Yk(n)},this.$$d_$4o5)}else this.$5Yk(n)}else this.$l.$8G(this.$l.get_$Ip())?this.$l.get_$Ip().$4nK():this.$4o5()},$7Qe:function(){_a.$8.stPT(_a.$0.$4F,"ShowAppPane",3);var n=_a.$8.$1g(_a.$0.$4F,"ShowAppPane",!0);if(this.$St.get_$T()==="Mouse"){if(this.$1Sg){this.set_$3na(342);this.set_$1Sh(!1);this.$5Os(1)}}else if(this.$St.get_$T()!=="TouchNarrow"&&this.$Fe.$c2)this.set_$1Sh(!1);else{this.$Sw=this.$2N8.$7sH(this,this.$St.get_$T());this.$Sw.$rI=this.$$d_$5QV;this.$St.$Cc(this.$Sw)}this.$6j("OnAppsPaneOpened");_a.$8.$1I(n,"ShowAppPane","");_a.$8.endPT("ShowAppPane")},$26x:function(n){if(!this.$1Sg){var t=null;if(n){_a.$8.stPT(_a.$0.$4F,"HideAppPane",3);t=_a.$8.$1g(_a.$0.$4F,"HideAppPane",!0)}this.$38Q(!1);this.set_$3na(0);this.set_$1Sh(!0);this.$6j("OnAppsPaneClosed");this.$5Os(2);if(n){_a.$8.$1I(t,"HideAppPane","");_a.$8.endPT("HideAppPane")}}},$38Q:function(n){var t=null;if(n){_a.$8.stPT(_a.$0.$4F,"CloseComposeApp",3);t=_a.$8.$1g(_a.$0.$4F,"CloseComposeApp",!0)}this.$1Pr(null);if(n){_a.$8.$1I(t,"CloseComposeApp","");_a.$8.endPT("CloseComposeApp")}},$4jr:function(n){return!n},$9M3:function(){this.$38Q(!0)},$72A:function(n,t){this.get_$15z()?this.$Sw&&this.$Sw.$4x():this.$26x(!1);this.$6j("OnAppsPaneClosed")},$9PI:function(){this.$St.get_$T()!=="TouchWide"||this.get_$15z()?this.$26x(!0):this.$Sw&&this.$Sw.$4x()},$5Yk:function(n){this.$6j("OnExtensionOpened");_ex.$2G.prototype.$1Pr.call(this,n);this.$1aD(!0)},$4o5:function(){this.$1xs(!0);this.set_$37Y(_u.ExtStrings.l_ComposeAppsForOutlook_Text);this.set_$3M2(!1);this.$6j("BackToList");_ex.$2G.prototype.$1Pr.call(this,null)},$8bm:function(){this.$n(_ex.$2G.$4Er,this.$$d_$9OS);this.$n(_ex.$2G.$48B,this.$$d_$9OS);this.$n("ForceHideAppsButton",this.$$d_$9OS);this.$2Io=!0},$AAc:function(){if(this.$2Io){this.$1B(_ex.$2G.$4Er,this.$$d_$9OS);this.$1B(_ex.$2G.$48B,this.$$d_$9OS);this.$1B("ForceHideAppsButton",this.$$d_$9OS);this.$2Io=!1}},$9OS:function(n,t){(t===_ex.$2G.$4Er||t===_ex.$2G.$48B||t==="ForceHideAppsButton")&&this.$5Wg()},$5Os:function(n){this.$2Ig&&this.$2Ig(n)},$5QV:function(n){this.$1Pr(null);n()},$5Wg:function(){this.set_$4PY(!this.$2Ni&&(!this.$1wC||!!this.$1YQ));this.$ur.set_$6W(this.$1cU);if(this.$1zT&&this.$1cU){_a.$8.$1I(this.$1zT,"EnableAppsButton");_a.$8.endPT("EnableAppsButton");this.$1zT=null}}};_ex.$196=function(){_ex.$196.initializeBase(this,[1,"VM.Extensibility.Stats"])};_ex.$196.prototype={set_$7qi:function(n){this.$R("ContextRetrievalTime",n);return n},set_$7qf:function(n){this.$R("ContextExtensionsCount",n);return n},set_$8rU:function(n){this.$R("MaxCountOfActiveExtensions",n);return n},set_$7dI:function(n){this.$R("ActivationTime",n);return n},set_$A8h:function(n){this.$R("TotalActivationStatistics",n);return n},set_$9bg:function(n){this.$R("RegExStatistics",n);return n},set_$9WB:function(n){this.$R("PerExtensionStatistics",n);return n},set_$x2:function(n){this.$R("Interval",n);return n},set_$852:function(n){this.$R("FromHtmlStatistics",n);return n},set_$8ec:function(n){this.$R("InnerTextStatistics",n);return n},set_$8by:function(n){this.$R("HtmlBodyLengthStatistics",n);return n},set_$7r7:function(n){this.$R("ConvertedBodyLengthStatistics",n);return n},set_$817:function(n){this.$R("EntityStatistics",n);return n}};_ex.$Fr=function(){};_ex.$Fr.$8qv=function(n){var i=n.toString();var t=_ex.$Fr.$Ll[i];if(!t){t=_js.$1S.$I2(_y.$197,n);_ex.$Fr.$Ll[i]=t}return t};_ex.$Bm=function(n,t){this.$$d_$9iF=Function.createDelegate(this,this.$9iF);this.$$d_$9Xs=Function.createDelegate(this,this.$9Xs);_ex.$Bm.initializeBase(this);this.$JG=n;this.$jl=t;this.$12Y=new _C(this.$$d_$9Xs,_a.$0.$4F);this.$1Ma=new _fm.$1v(new Array(0));this.$sp=new _js.$Z};_ex.$Bm.prototype={$qs:0,$JG:null,$sp:null,$1Ma:null,$jl:null,$2RY:!0,$1Kj:null,$16A:null,$12Y:null,set_$50x:function(n){if(this.$2RY!==n){this.$2RY=n;this.$4(_ex.$Bm.$50y)}return n},set_$2fL:function(n){if(this.$1Kj!==n){this.$1Kj=n;$B(n)||this.$4(_ex.$Bm.$3ih)}return n},set_$5BD:function(n){this.$16A=n;if(n.$ef===3){var t=this.$16A.$3Ec.get_$2n().extensionViewModel;if($B(t)||this.$1Kj===t){this.$jl.$8k=null;this.$jl.$11();this.$VY()}else{this.$jl.$8k=t;this.$jl.$11();this.set_$2fL(t)}}return n},$VY:function(){this.$1Kj=null;this.$4(_ex.$Bm.$3ih)},$9Xs:function(){if(!(this.$qs<1)){var n=0;var i=this.$JG.get_$9();var e=!1;var t=this.$1Kj;var r=this.$qs;this.$sp.$1v();while(n<r&&n<i){var o=this.$JG.get_$D(n);var u=n+1===r||n+1===i;($B(t)||o.$5c.Id===t.$5c.Id)&&(e=!0);var f=u&&!e?t:this.$JG.get_$D(n);this.$sp.$F(f);f.set_$56h(u&&i<=r);n++}this.set_$2fL(t);this.$4IF()}},$9iF:function(n){n.set_$56h(!1);this.$sp.$5g(this.$sp.get_$9()-1);this.$sp.$F(n);this.$jl.$8k=n;this.$jl.$11();this.set_$2fL(n);this.$4IF()},$4IF:function(){var i=this.$JG.get_$9();if(i>this.$qs){var t=0;this.$1Ma.$1Y.$1v();while(t<i){var n=this.$JG.get_$D(t);if(this.$sp.$7p(n)<0){var r=new _fm.$e(n.$5c.DisplayName,null,new _ex.$q1(this.$$d_$9iF,n),!0);this.$1Ma.$1Y.$F(r)}t++}this.set_$50x(!1)}else{this.$1Ma.$1Y.$1v();this.set_$50x(!0)}}};_ex.$OH=function(n,t,i){this.$$d_$4o7=Function.createDelegate(this,this.$4o7);this.$$d_$2NP=Function.createDelegate(this,this.$2NP);this.$$d_$4zt=Function.createDelegate(this,this.$4zt);_ex.$OH.resolveInheritance();this.apcl=this.$n;this.rpcl=this.$1B;this.dispose=this.$1t;_ex.$OH.initializeBase(this);this.$5q=n;this.$Os=i;if(i!=="Mouse"){this.set_$AK(_y.$1s.$FV(this));var e=this;var o=new _C(function(){e.$4x()},_a.$0.$4F);this.$5k.set_$U4([_y.$1T.$ST(_u.ExtStrings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$2UF())if(_g.$2r.isInstanceOfType(this.$5q.$c))this.set_$3QL(this.$5q.$c.get_$4u().get_$1b());else if(this.$5q.$c.get_$Nh()&&this.$5q.$c.get_$Nh().get_$1b())this.set_$3QL(this.$5q.$c.get_$Nh().get_$1b());else{var r=_ff.$1t.$56(_h.$k.get_$46e());r.MaximumBodySize=0;r.MaximumRecipientsToReturn=0;var u=new _h.$Gv(100,[this.$5q.$c.get_$x()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$2x(function(n){f.set_$3QL(f.$5q.$c.get_$Nh().get_$1b())});OwaApplication.$2D.$1T(u)}};_ex.$OH.prototype={$Os:0,$7U:null,$5q:null,$rI:null,$3QK:null,$x4:!1,$14P:null,set_$3QL:function(n){this.$3QK=n;this.$4("ItemBodyValue");return n},get_$2yg:function(){return 4},get_$40l:function(){return this.$$d_$4zt},get_$iZ:function(){return this.$7U},set_$iZ:function(n){this.$7U=n;return n},get_$7yW:function(){return!0},get_$TB:function(){return this.$Os!=="Mouse"?1:0},$4zt:function(n,t){if(this.$x4)return!1;if(this.$rI){this.$14P=n;this.$rI(this.$$d_$2NP);return!0}this.$2NP();return!1},$4x:function(){this.$x4||(this.$Os==="TouchNarrow"?this.$rI?this.$rI(this.$$d_$4o7):this.$4o7():this.$7U&&this.$7U())},$4o7:function(){this.$x4=!0;this.$7U&&this.$7U()},$2NP:function(){this.$x4=!0;this.$14P&&this.$14P()}};_ex.$uB=function(){};_ex.$uB.prototype={$7si:function(n,t,i){return new _ex.$OH(n,t,i)},$7sH:function(n,t){return new _ex.$tT(n,t)}};_ex.$19B=function(){this.$$d_$4xL=Function.createDelegate(this,this.$4xL);this.$3Qm=_a.$7.$nw;this.$13e=[];this.$1FU={};this.$1FV={}};_ex.$19B.prototype={$5Cf:100,$3CH:6e5,$p4:null,$ck:null,$Ua:null,$1FR:null,$5oN:function(n,t){if(!this.$1zS()){this.$Ua||(this.$Ua=new _ex.$19B.$4nZ);if(!this.$Ua.$1xX){this.$Ua.$1xX=[];this.$Ua.$1ap=[]}Array.add(this.$Ua.$1xX,n);Array.add(this.$Ua.$1ap,t)}},$A9E:function(n){this.$1FV[n]=$B(this.$1FV[n])?1:this.$1FV[n]+1},$5oK:function(n,t,i){i&&(this.$1FU[n]=$B(this.$1FU[n])?1:this.$1FU[n]+1);if(!this.$1zS()){this.$Ua||(this.$Ua=new _ex.$19B.$4nZ);this.$Ua.$3hj=t;this.$Ua.$36P=i;this.$Ua.$2N=n;this.$p4||(this.$p4=new _ex.$19B.$4XZ);Array.add(this.$p4.$2S7,this.$Ua);this.$Ua=null}},$5oM:function(n,t){if(!this.$1zS()){this.$1FR||(this.$1FR=new _ex.$19B.$82T);this.$1FR.$5oM(n,t)}},$5oP:function(n){if(!this.$1zS()){this.$p4||(this.$p4=new _ex.$19B.$4XZ);this.$p4.$3jU=n;Array.add(this.$13e,this.$p4);this.$p4=null}},$A99:function(n,t,i,r){if(!this.$1zS()){this.$ck||(this.$ck=new _ex.$19B.$7kM);this.$ck.$3MI.$2T(n,null);this.$ck.$3Mw.$2T(r,null);this.$ck.$3Fy.$2T(i,null);this.$ck.$3B3.$2T(t,null)}},$4oW:function(){var n=_a.$7.get_$3A();if(n.$6P(this.$3Qm)>=this.$3CH){_a.$n.$JE.$7eI(this.$$d_$4xL);this.$9eu();this.$3Qm=n}},$9eu:function(){this.$13e=[];this.$1FU={};this.$1FV={};this.$p4=null;this.$Ua=null;this.$ck=null;this.$1FR=null},$wI:function(n){var t=new Sys.StringBuilder;if($B(_ex.$4b.$gT))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$4xL().$I2(n));n&&t.append("</TABLE>")}return new _a.$Fq("Pending Extensibility Statistics",t.toString())},$4xL:function(){var l=_ex.$4b.$gT.Extensions.length;var n=new _ex.$196;n.set_$7qi(_ex.$4b.$2Ub);n.set_$7qf(l);if(this.$13e.length>0){for(var e=0,h=new _ex.$Hr,i={},c=new _ex.$Hr,r=0;r<this.$13e.length;r++){var u=this.$13e[r];h.$2T(u.$3jU,null);for(var f=0,s=0;s<u.$2S7.length;s++){var t=u.$2S7[s];var o=t.$2N;t.$36P&&f++;$B(i[o])&&(i[o]=new _ex.$Hr);i[o].$2T(t.$3hj,null);t.$AE0(c)}f>e&&(e=f)}n.set_$8rU(e);n.set_$7dI(this.$13e.length);n.set_$A8h(h.$yp());n.set_$9WB(this.$9jR(i));n.set_$9bg(c.$yp());n.set_$x2(this.$3CH/1e3);if(this.$ck){n.set_$852(this.$ck.$3Fy.$yp());n.set_$8ec(this.$ck.$3Mw.$yp());n.set_$8by(this.$ck.$3MI.$yp());n.set_$7r7(this.$ck.$3B3.$yp())}this.$1FR&&n.set_$817(this.$1FR.$yp())}return n},$9jR:function(n){for(var t=new Sys.StringBuilder,r=0;r<_ex.$4b.$gT.Extensions.length;r++){var i=_ex.$4b.$gT.Extensions[r];var f=$B(this.$1FU[i.Id])?0:this.$1FU[i.Id];var u=$B(this.$1FV[i.Id])?0:this.$1FV[i.Id];t.append("[");t.append(i.Id);t.append(",");t.append(i.DisplayName);t.append(";");t.append(n[i.Id]?n[i.Id].$yp():"");t.append(";");t.append(f.toString());t.append(",");t.append(u.toString());t.append("]")}return t.toString()},$1zS:function(){return this.$13e.length>=this.$5Cf||!_js.Trace.$42}};_ex.$19B.$4XZ=function(){this.$2S7=[]};_ex.$19B.$4XZ.prototype={$3jU:0};_ex.$19B.$7kM=function(){this.$3Fy=new _ex.$Hr;this.$3Mw=new _ex.$Hr;this.$3MI=new _ex.$Hr;this.$3B3=new _ex.$Hr};_ex.$19B.$4nZ=function(){};_ex.$19B.$4nZ.prototype={$2N:null,$1xX:null,$1ap:null,$3hj:0,$36P:!1,$AE0:function(n){if(this.$1ap)for(var t=0;t<this.$1ap.length;t++)n.$2T(this.$1ap[t],this.$1xX[t])}};_ex.$19B.$82T=function(){};_ex.$19B.$82T.prototype={$3WZ:0,$3Wa:0,$3Wb:0,$3Wc:0,$3Wd:0,$3We:0,$3Wf:0,$16m:null,$5oM:function(n,t){this.$16m=null;var i=!t;if(n){var r=new(_ff.$1E.$$(_g.$Br));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1E8(3);this.$3WZ++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1E8(7);this.$3Wa++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1E8(6);this.$3Wb++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1E8(1);this.$3Wc++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1E8(5);this.$3Wd++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1E8(2);this.$3We++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1E8(4);this.$3Wf++}}},$yp:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$3WZ,this.$3Wa,this.$3Wb,this.$3Wc,this.$3Wd,this.$3We,this.$3Wf));if(this.$16m){n.append("MissingOnLastMessage:");for(var t=0;t<this.$16m.get_$9();t++){n.append(_g.$Br.toString(this.$16m.get_$D(t)));n.append(",")}}return n.toString()},$1E8:function(n){this.$16m||(this.$16m=new(_ff.$1E.$$(_g.$Br)));this.$16m.$F(n)}};_ex.$19C=function(n){this.$2Y=n};_ex.$19C.prototype={$2Y:null,$Vt:null,$2W:function(n,t,i){this.$Vt=_js.$D.get_$P().$2W(i,this.$2Y,n,t)},$39P:function(){this.$Vt&&(this.$Vt=_js.$D.get_$P().$6g(this.$Vt))}};_ex.$105=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$5QV=Function.createDelegate(this,this.$5QV);this.$$d_$4o6=Function.createDelegate(this,this.$4o6);this.$$d_$5Sl=Function.createDelegate(this,this.$5Sl);_ex.$105.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v])};_ex.$105.prototype={$Sw:null,$2NO:null,$1Pr:function(n){_ex.$2G.prototype.$1Pr.call(this,n);this.$A2l()},$AO:function(){_ex.$2G.prototype.$AO.call(this);this.$Sw&&this.$Sw.$4x()},$4jr:function(n){return"Mouse"!==this.$St.get_$T()||!n},$5Sl:function(){this.$1aD(!0);this.$7uE()},$A2l:function(){"Mouse"!==this.$St.get_$T()&&this.$DU&&(this.$l.$8G(this.$l.get_$Ip())?this.$l.get_$Ip().$4mO(this.$DU.get_$4mV(),this.$DU.get_$1ff().DisplayName,this.$$d_$5Sl,this.$$d_$4o6):this.$5Sl())},$7uE:function(){this.$Sw=this.$2N8.$7si(this,this.$eN,this.$St.get_$T());this.$Sw.$rI=this.$$d_$5QV;this.$St.$Cc(this.$Sw)},$5QV:function(n){this.$fQ&&this.$fQ.$VY();this.$2NO=n;this.$1xs(!0);this.$l.$8G(this.$l.get_$Ip())?this.$l.get_$Ip().$4nK():this.$4o6()},$4o6:function(){this.$2NO&&this.$2NO()}};_ex.$2G=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$7nb=Function.createDelegate(this,this.$7nb);this.$$d_$9Or=Function.createDelegate(this,this.$9Or);this.$$d_$9OR=Function.createDelegate(this,this.$9OR);this.$$d_$2QM=Function.createDelegate(this,this.$2QM);this.$$d_$8Z4=Function.createDelegate(this,this.$8Z4);this.$$d_$9UH=Function.createDelegate(this,this.$9UH);this.$$d_$1Pr=Function.createDelegate(this,this.$1Pr);_ex.$2G.resolveInheritance();this.apcl=this.$n;this.rpcl=this.$1B;this.dispose=this.$1t;_ex.$2G.initializeBase(this);this.$Hh=n;this.$2N8=u;this.$l=t;this.$eN=i;this.$St=r;this.$JG=new _js.$Z;this.$VU=new _y.$V6;this.$ky=[];this.$3Z0=_ex.$2G.$8VR(o);this.$jl=new _ex.$q1(this.$$d_$1Pr,null);this.$3Yl=new _C(this.$$d_$9UH,_a.$0.$4F);this.$2bF=f;this.$x8=e;this.$2Mx=s;this.$GQ=h;this.$c=c;this.$2i1=l;this.$gu=a;this.$1C=v};_ex.$2G.add_$2Yi=function(n){_ex.$2G.$15Q||(_ex.$2G.$15Q=new Sys.EventHandlerList);_ex.$2G.$15Q.addHandler(_ex.$2G.$5Po,n)};_ex.$2G.remove_$2Yi=function(n){_ex.$2G.$15Q&&_ex.$2G.$15Q.removeHandler(_ex.$2G.$5Po,n)};_ex.$2G.$8VR=function(n){return n?n.replace("osfruntime_strings.js",""):""};_ex.$2G.$18p=function(n,t){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",t);n.appendChild(i)};_ex.$2G.prototype={$St:null,$eN:null,$2N8:null,$GQ:null,$Hh:null,$3Yl:null,$VU:null,$l:null,$3Z0:null,$2i1:null,$gu:null,$jl:null,$1TT:null,$17T:null,$Jg:null,$1zR:!1,$fQ:null,$1eo:null,$JG:null,$DU:null,$c:null,$1X5:!0,$1wC:!0,$1YQ:null,$2bF:!1,$x8:!1,$2Mx:null,$1Gc:null,$1C:null,$DO:!1,$ky:null,get_$7oe:function(){switch(this.$St.get_$T()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$8bd:function(){return"extensionHighlight"},get_$Ax5:function(){return this.$Jg},get_$9TL:function(){return null},get_$8jR:function(){return this.$Jg?this.$Jg.IsInOrgMarketplaceRole:!1},set_$5S0:function(n){this.$fQ!==n&&(this.$fQ=n);this.$4("OverflowMenuViewModel");return n},set_$4Gw:function(n){if(this.$1eo!==n){this.$1eo=n;this.$4("OsfContextActivationManager")}return n},get_$1yG:function(){return this.$DU},set_$1yG:function(n){if(this.$DU!==n){$B(n)||this.$GQ.$A9E(n.get_$1ff().Id);this.$DU=n;this.$4("SelectedExtension")}return n},set_$1rx:function(n){if(this.$1X5!==n){this.$1X5=n;this.$4(_ex.$2G.$8b6)}return n},get_$2wy:function(){return this.$1wC},set_$2wy:function(n){if(this.$1wC!==n){this.$1wC=n;this.$4(_ex.$2G.$4Er)}return n},get_$1s2:function(){return this.$ky},set_$1s2:function(n){if(this.$ky!==n){this.$ky=n;this.$4(_ex.$2G.$8be)}return n},get_$8hu:function(){return!1},get_$4LN:function(){return null},get_$21F:function(){return null},set_$6kz:function(n){this.$1YQ=n;this.$4(_ex.$2G.$48B);return n},$1Pr:function(n){n&&this.$DU===n||this.$gu.$2mU();if(n){this.$gu.$7TF();if(!this.$1eo){var t=_js.$I.s(_a.$0.$4F,517,"ContextActivationManager");this.$1aD(!1);this.set_$4Gw(this.$65l("15.01"));this.$1xs(!1);_js.$I.e(t)}this.$6D4(n);this.$St.get_$T()==="Mouse"&&this.set_$1s2(n.get_$1s2())}else{this.$3tl();this.set_$1s2([])}this.set_$1rx(this.$4jr(n));this.set_$1yG(n)},$AO:function(){_ex.$2G.remove_$2Yi(this.$$d_$8Z4);this.$DO=!1;this.$gu.$2mU();this.$3tl();this.set_$1yG(null);this.$fQ&&this.$fQ.$VY();this.$fQ=null;this.set_$1rx(!0);this.$JG.$1v();this.set_$2wy(!0);this.$2i1.$AU();this.$7mB()},$7Z:function(){if(this.$eN.get_$9LJ()){this.$JG.$1v();if(this.$2i1.$A1X()){this.$DO=!0;if(_a.$Aw.$582()){_a.$Aw.$5YM();_ex.$2G.$2T4=!1;_ex.$2G.add_$2Yi(this.$$d_$8Z4);this.$3KI()}else if($B(this.$Jg)&&$B(_ex.$4b.$gT)){_ex.$2G.add_$2Yi(this.$$d_$8Z4);this.$3KI()}else{$B(this.$Jg)&&!$B(_ex.$4b.$gT)&&(this.$Jg=_ex.$4b.$gT);this.$4XY()}}}},$9OR:function(n){if(this.$2bF&&this.$17T){this.$17T.$2s();this.$17T=null}this.$9aa(n);if(this.$1Gc){var t=null;_ex.$4b.isInstanceOfType(n)&&n.$6J&&(t=n.$6J.correlationId);_a.$8.$1I(this.$1Gc,"GetListOfApps","",t);_a.$8.endPT("GetListOfApps");this.$1Gc=null}},$4XY:function(){if(this.$2i1){this.$St.get_$T()==="Mouse"&&this.$Jg.MarketplaceUrl&&this.set_$6kz(this.$Jg.MarketplaceUrl);if(!$B(this.$Jg.Extensions)&&this.$Jg.Extensions.length){var n=this;this.$2i1.$6DJ(this.$Jg.Extensions,function(t){if(n.$2i1){if(t.get_$9()>0){n.$JG.$48(t.$3e());n.$Aym();n.set_$5S0(new _ex.$Bm(n.$JG,n.$jl));n.$fQ.$VY();n.set_$2wy(!1);n.$4(_ex.$2G.$82J)}else n.set_$2wy(!0);n.$4(_ex.$2G.$7dL)}})}}},$6D4:function(n){this.$gu.$3f(n,this.$Jg,n.$Ww);this.$gu.$9bs()},$1aD:function(n){this.$5Sv(n)&&this.$2Mx.$1o(_a.$FV,new _a.$FV(!0,"Extensibility"))},$1xs:function(n){this.$5Sv(n)&&this.$2Mx.$1o(_a.$FV,new _a.$FV(!1,"Extensibility"))},$65l:function(n){var i=new OSF.ContextActivationManager({appName:64,appVersion:n,clientMode:1,appUILocale:this.$Hh,dataLocale:"",hostControl:this.$gu,localizedScriptsUrl:this.$3Z0,docUrl:""});var t={frameBorder:"0"};this.$eN.get_$KH()&&this.$eN.get_$8q()&&(t.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(t);return i},$5Sv:function(n){return!this.$eN.get_$3Ob()&&!this.$eN.get_$44W()?!1:!n||this.$DU&&!this.$DU.get_$1ff().Type?!0:!1},$9UH:function(){if(this.$1YQ){_a.$8.stPT(_a.$0.$4F,"GetMoreApps",3);var n=_a.$8.$1g(_a.$0.$4F,"GetMoreApps",!0);this.$VU.$Yl(this.$1YQ);this.$A53();_a.$8.$1I(n,"GetMoreApps","");_a.$8.endPT("GetMoreApps")}},$9YH:function(){var n=document.getElementsByTagName("head")[0];_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js");_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/o15apptofilemappingtable.js");_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hh.toLowerCase()+"/office_strings.js");_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hh.toLowerCase()+"/outlook_strings.js");_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/office_strings.js");_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/outlook_strings.js");_ex.$2G.$18p(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/outlookwebapp-15.01.js")},$Aym:function(){this.$4("ActiveExtensions")},$3tl:function(){this.$gu.$AAd();this.$gu.$AAx()},$3KI:function(){if((!_ex.$2G.$2T4||this.$1zR)&&!this.$x8){_a.$8.stPT(_a.$0.$4F,"GetListOfApps",5);this.$1Gc=_a.$8.$1g(_a.$0.$4F,"GetListOfApps",!0);_ex.$2G.$2T4=!0;this.$2QM();if(this.$2bF){this.$17T=new _ex.$1Et(3,3e4,this.$$d_$2QM,_a.$0.$4F,"GetExtensibilityContext");this.$17T.$1R()}}},$2QM:function(){var n=new _ex.$4b;n.add_$2x(this.$$d_$9OR);n.add_$2d(this.$$d_$9Or);n.$11(this.get_$7oe(),this.$Hh)},$9Or:function(n){if(this.$17T&&this.$17T.$2RE&&this.$1Gc){var t=null;_ex.$4b.isInstanceOfType(n)&&n.$6J&&(t=n.$6J.correlationId);_a.$8.$1I(this.$1Gc,"GetListOfApps","Failed",t);_a.$8.endPT("GetListOfApps")}},$7mB:function(){this.$1TT&&this.$1TT.$39P()},$A53:function(){if(!this.$1TT){this.$1TT=new _ex.$19C("CheckNewApp");this.$5Vu()}},$5Vu:function(){this.$1TT.$2W(this.$$d_$7nb,5e3,_a.$0.$4F)},$7nb:function(){if(_a.$Aw.$582()){_a.$Aw.$5YM();this.$1zR=!0;this.$3KI()}this.$5Vu()},$9aa:function(n){if(_ex.$2G.$15Q){var t=_ex.$2G.$15Q.getHandler(_ex.$2G.$5Po);$B(t)||t(n)}},$8Z4:function(n){_ex.$2G.remove_$2Yi(this.$$d_$8Z4);if(this.$Jg){if(this.$1zR){this.$1zR=!1;_ex.$4b.$2Ub=n.$2Ku}}else{_ex.$4b.$2Ub=n.$2Ku;this.$Jg=_ex.$4b.$gT;(this.$St.get_$T()==="Mouse"||this.$1C&&this.$1C.get_$2a().get_$7hA().Enabled)&&this.$9YH();this.$4XY()}}};_ex.$106=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$Fe=n;this.$1pO=t;this.$Hh=i;this.$1Px=r;this.$l=u;this.$19=f;this.$H=e;this.$N=o;this.$1Up=s;this.$1Uq=h;this.$GQ=c;this.$1C=l};_ex.$106.prototype={$Hh:null,$1Px:null,$l:null,$19:null,$H:null,$1pO:null,$N:null,$1Up:null,$1Uq:null,$GQ:null,$Fe:null,$1C:null,$7sQ:function(n){var t=!this.$1C.get_$2a().get_$22y().Enabled;return null},$AeM:function(){var n=!this.$1C.get_$2a().get_$22y().Enabled;return null},$4h0:function(n,t){return this.$7o(n,this.$1Up.$3BU(n,t),this.$1Uq.$4h0(n,t))},$65d:function(n){return this.$7o(n,this.$1Up.$3BU(n,!1),this.$1Uq.$65d(n))},$66R:function(n,t){return new _ex.$Ll(_a.$0.$1D,this.$Fe,t,this.$Hh,this.$l,this.$19,this.$H,this.$1pO,!0,_a.$8I.$15t(),this.$1Px,this.$N,this.$GQ,null,this.$1Up.$4ge(2),this.$1Uq.$66R(n),this.$1C)},$65Z:function(n,t){return new _ex.$Ll(_a.$0.$1y,this.$Fe,t,this.$Hh,this.$l,this.$19,this.$H,this.$1pO,!0,_a.$8I.$15t(),this.$1Px,this.$N,this.$GQ,null,this.$1Up.$4ge(3),this.$1Uq.$65Z(n),this.$1C)},$7uw:function(n,t){return new _ex.$1Gy(n,t)},$7o:function(n,t,i){return new _ex.$105(this.$Hh,this.$l,this.$19,this.$H,this.$1pO,!0,_a.$8I.$15t(),this.$1Px,this.$N,this.$GQ,n,t,i,this.$1C)}};_ex.$19D=function(n){_ex.$19D.initializeBase(this,[1,"VM.Extensibility."+n])};_ex.$19D.prototype={$1T:function(){_a.$n.$JE.$K1(this)},$9Xh:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};this.$R(t.key,t.value)}}};_ex.$q1=function(n,t){this.$$d_$81z=Function.createDelegate(this,this.$81z);_ex.$q1.initializeBase(this);this.set_$6W(!0);this.set_$10Q(this.$$d_$81z);this.$3N8=n;this.$8k=t;this.$2B=_a.$0.$4F};_ex.$q1.prototype={$3N8:null,$8k:null,$81z:function(){this.$3N8(this.$8k)}};_ex.$7t=function(n,t){this.$$d_$4Yr=Function.createDelegate(this,this.$4Yr);this.$ky=[];_ex.$7t.initializeBase(this);this.$5c=n;this.$Ww=t;this.$zX=_ex.$Be.$I(n.Rule,this.$Ww)};_ex.$7t.$5on=function(n,t,i){i.val=null;var f=new _ex.$7t(n,t);var u=null;var r=0;var s,o,e;if(e=_ex.$7t.$A9v(n,t.$pn,s={val:u},o={val:r}),u=s.val,r=o.val,e){f.$1Ui=u;f.$2lP=r;i.val=f;return!0}return!1};_ex.$7t.$A9v=function(n,t,i,r){i.val=null;r.val=0;var e;if(t===1)e=0;else if(t===2||t===3)e=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,u=0;u<s;++u){var f=o[u];if(f.SettingsType===e){i.val=f.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=f.RequestedHeight;return!0}}return!1};_ex.$7t.prototype={$1Ui:null,$2lP:0,$5c:null,$zX:null,$Ww:null,$3Oj:!1,$1XB:null,get_$1ff:function(){return this.$5c},get_$Xx:function(){return this.$5c.AppStatus},get_$4mD:function(){return this.$5c.EndNodeUrl},get_$27:function(){return this.$5c.DisplayName},get_$8oY:function(){return this.$5c.LicenseType},get_$9a4:function(){return this.$5c.ProviderName},get_$5hC:function(){return _js.$A.$1k(this.$5c.Settings)?{}:JsonParser.deserialize(this.$5c.Settings)},set_$5hC:function(n){this.$5c.Settings=n?JsonParser.serialize(n):"";return n},get_$8c5:function(){if(!_js.$A.$1k(this.$1XB))return this.$1XB;this.$1XB=_ex.$7t.$52F?_js.$A.$1k(this.$5c.HighResolutionIconUrl)?this.$5c.IconUrl:this.$5c.HighResolutionIconUrl:_js.$A.$1k(this.$5c.IconUrl)?this.$5c.HighResolutionIconUrl:this.$5c.IconUrl;return this.$1XB},get_$4mV:function(){return this.$1Ui},set_$56h:function(n){if(n!==this.$3Oj){this.$3Oj=n;this.$4("IsLastExtension")}return n},get_$1s2:function(){return this.$ky},$9ym:function(n){var e=this.$Ww.$3SB;var c=this.$Ww.$1ao;Array.clear(this.$ky);if(!this.$5c.DisableEntityHighlighting){var t={};var o=c;for(var f in o)for(var h={key:f,value:o[f]},u=h.value,i=0;i<u.length;i++)this.$4Yr(u[i],null,t);for(var r=0;r<e.length;r++){var s=e[r];switch(s){case 3:_ex.$3y.$wH(n.Addresses,"Address",t,this.$$d_$4Yr);break;case 6:_ex.$3y.$wH(n.EmailAddresses,"EmailAddress",t,this.$$d_$4Yr);break;case 4:_ex.$3y.$wH(n.Urls,"Url",t,this.$$d_$4Yr);break;case 1:_ex.$3y.$wH(n.MeetingSuggestions,"MeetingString",t,this.$$d_$4Yr);break;case 2:_ex.$3y.$wH(n.TaskSuggestions,"TaskString",t,this.$$d_$4Yr);break;case 5:_ex.$3y.$wH(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$4Yr);break;case 7:_ex.$3y.$wH(n.Contacts,"ContactString",t,this.$$d_$4Yr);break}}this.$Ww.$gW.$84X(t,this.$$d_$4Yr)}},$4Yr:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$ky,n);r[n]=!0}}};_ex.$1Et=function(n,t,i,r,u){this.$$d_$8fJ=Function.createDelegate(this,this.$8fJ);_ex.$1Et.initializeBase(this,[u]);this.$1tm=n;this.$1m3=t;this.$8M=i;this.$2B=r};_ex.$1Et.prototype={$1tm:0,$1m3:0,$Sy:1,$8M:null,$2RE:!1,$2B:null,$1R:function(){_js.Trace.logInfo(_a.$0.$4F,"RetryTimer.Start");this.$2RE=!1;this.$2W(this.$$d_$8fJ,this.$1m3,this.$2B)},$2s:function(){_js.Trace.logInfo(_a.$0.$4F,"RetryTimer.End");this.$2RE=!0;this.$Sy=this.$1tm;this.$39P()},$8fJ:function(){_js.Trace.logInfo(_a.$0.$4F,"RetryTimer.Callback: count {0}",this.$Sy);this.$8M();if(this.$Sy<this.$1tm){this.$Sy++;this.$2W(this.$$d_$8fJ,this.$1m3,this.$2B)}else{_js.Trace.logInfo(_a.$0.$4F,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$Sy,this.$1tm);this.$2s()}}};_ex.$Be=function(){};_ex.$Be.$I=function(n,t){var i=_ex.$Be.$4h4(n,t);if(!$B(i)){t.$3CA>7&&i.$1cN("Number of custom pattern rules exceeds the limit of "+7+".");t.$3cQ>15&&i.$1cN("Number of rules exceeds the limit of "+15+".");if(i.$Ke)return i}return null};_ex.$Be.$3PM=function(n){return n.$pn===1};_ex.$Be.$4h4=function(n,t){return $B(n)?null:++t.$3cQ>15?null:n.Type==="Collection"?new _ex.$17u(n,t):n.Type==="ItemIs"?new _ex.$EX(n):n.Type==="ItemHasKnownEntity"?new _ex.$3y(n):n.Type==="ItemHasRegularExpressionMatch"?new _ex.$EW(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _ex.$1Bg:null};_ex.$Be.prototype={$Ke:!0,$56b:function(n,t){return!0},$1cN:function(n){_js.Trace.logError(_a.$0.$4F,n);this.$Ke=!1}};_ex.$17u=function(n,t){_ex.$17u.initializeBase(this);if($B(n.Mode)){this.$1cN("Collection rule with no required 'mode' attribute found.");return}if($B(n.Rules)||!n.Rules.length){this.$1cN("Collection rule with no required 'rule' attribute found.");return}this.$2SY="And"===n.Mode;this.$14D=new _js.$Z;for(var i=0;i<n.Rules.length;i++){var r=_ex.$Be.$4h4(n.Rules[i],t);$B(r)||this.$14D.$F(r)}};_ex.$17u.prototype={$2SY:!1,$14D:null,$2Mw:function(n,t,i){for(var r=this.$2SY,u=0;u<this.$14D.get_$9();u++){var f=this.$14D.get_$D(u);r=this.$2SY?!!(r&f.$2Mw(n,t,i)):!!(r|f.$2Mw(n,t,i))}return r},$56b:function(n,t){for(var i=0;i<this.$14D.get_$9();i++){var r=this.$14D.get_$D(i);if(!r.$56b(n,t))return!1}return!0}};_ex.$u7=function(n,t){this.$3SB=[];this.$gW=new _ex.$3x;this.$GQ=n;this.$pn=t};_ex.$u7.prototype={$3CA:0,$3cQ:0,$1ao:null,$td:!1,$GQ:null,$pn:0};_ex.$3x=function(){};_ex.$3x.$1Ff=function(n,t,i,r){if(n){var f=n;for(var u in f){var e={key:u,value:f[u]};_ex.$3y.$wH(e.value,t,i,r)}}};_ex.$3x.$1EC=function(n,t,i){i&&(n[t]=i)};_ex.$3x.$1EA=function(n,t,i){n.val||(n.val={});n.val[t]=i};_ex.$3x.prototype={$HK:null,$105:null,$UZ:null,$1I0:null,$yR:null,$1Kn:null,$zT:null,$8Sh:function(){var n={};_ex.$3x.$1EC(n,"Addresses",this.$HK);_ex.$3x.$1EC(n,"Contacts",this.$105);_ex.$3x.$1EC(n,"EmailAddresses",this.$UZ);_ex.$3x.$1EC(n,"MeetingSuggestions",this.$1I0);_ex.$3x.$1EC(n,"PhoneNumbers",this.$yR);_ex.$3x.$1EC(n,"TaskSuggestions",this.$1Kn);_ex.$3x.$1EC(n,"Urls",this.$zT);return n},$4YG:function(n,t,i){switch(n){case 3:var o;_ex.$3x.$1EA(o={val:this.$HK},t,i),this.$HK=o.val;break;case 7:var s;_ex.$3x.$1EA(s={val:this.$105},t,i),this.$105=s.val;break;case 6:var h;_ex.$3x.$1EA(h={val:this.$UZ},t,i),this.$UZ=h.val;break;case 1:var e;_ex.$3x.$1EA(e={val:this.$1I0},t,i),this.$1I0=e.val;break;case 5:var r;_ex.$3x.$1EA(r={val:this.$yR},t,i),this.$yR=r.val;break;case 2:var u;_ex.$3x.$1EA(u={val:this.$1Kn},t,i),this.$1Kn=u.val;break;case 4:var f;_ex.$3x.$1EA(f={val:this.$zT},t,i),this.$zT=f.val;break;default:break}},$84X:function(n,t){_ex.$3x.$1Ff(this.$HK,"Address",n,t);_ex.$3x.$1Ff(this.$105,"ContactString",n,t);_ex.$3x.$1Ff(this.$UZ,"EmailAddress",n,t);_ex.$3x.$1Ff(this.$1I0,"MeetingString",n,t);_ex.$3x.$1Ff(this.$yR,"OriginalPhoneString",n,t);_ex.$3x.$1Ff(this.$1Kn,"TaskString",n,t);_ex.$3x.$1Ff(this.$zT,"Url",n,t)}};_ex.$1Bg=function(){_ex.$1Bg.initializeBase(this)};_ex.$1Bg.prototype={$2Mw:function(n,t,i){return _ex.$Be.$3PM(t)?n.get_$QB()!==undefined&&n.get_$QB():!1}};_ex.$3y=function(n){this.$$d_$81K=Function.createDelegate(this,this.$81K);_ex.$3y.initializeBase(this);$B(n.EntityType)?this.$1cN("ItemHasKnownEntity rule contains null entity type."):this.$C3=n};_ex.$3y.$wH=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_ex.$3y.$15R=function(n,t,i){if($B(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_ex.$3y.$8iY(i,e,t)){f[r]=_ex.$3y.$8TB(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$4F,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$4F,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_ex.$3y.$8iY=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_ex.$3y.$57i(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_ex.$3y.$57i=function(n){return n===7||n===1||n===2};_ex.$3y.$8TB=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$7.$64(i.StartTime,!0).$8w());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$7.$64(i.EndTime,!0).$8w());return i;default:return n}};_ex.$3y.prototype={$C3:null,$1JK:null,$gW:null,$56b:function(n,t){return n.get_$sn()?!0:this.$8iX(n.get_$2z5())?this.$1JK?!1:t.$td?!1:!_ex.$3y.$57i(this.$C3.EntityType):!0},$2Mw:function(n,t,i){if(!_ex.$Be.$3PM(t))return!1;this.$gW=null;var u=n.get_$sn();if($B(u))return!1;if(this.$C3.RegExFilter){var f,e;if(!(e=_ex.$EW.$5op(this.$C3.RegExFilter,this.$C3.IgnoreCase,f={val:this.$1JK}),this.$1JK=f.val,e))return!1}var r=!1;switch(this.$C3.EntityType){case 3:r=this.$1FQ(t,u.Addresses,null);break;case 7:r=this.$1FQ(t,u.Contacts,"ContactString");break;case 6:r=this.$1FQ(t,u.EmailAddresses,null);break;case 1:r=this.$1FQ(t,u.MeetingSuggestions,"MeetingString");break;case 5:r=this.$1FQ(t,u.PhoneNumbers,"OriginalPhoneString");break;case 2:r=this.$1FQ(t,u.TaskSuggestions,"TaskString");break;case 4:r=this.$1FQ(t,u.Urls,null);break}return r},$1FQ:function(n,t,i){var r=null;!$B(t)&&t.length>0&&(r=_ex.$3y.$15R(t,this.$C3.EntityType,n.$td));if(r){if(!this.$1JK){Array.add(n.$3SB,this.$C3.EntityType);return!0}var u=_a.$7.get_$3A();_ex.$3y.$wH(r,i,null,this.$$d_$81K);n.$GQ.$5oN(this.$C3.FilterName,_a.$7.get_$3A().$6P(u));if(this.$gW){n.$gW.$4YG(this.$C3.EntityType,this.$C3.FilterName,this.$gW);return!0}}this.$1JK&&n.$gW.$4YG(this.$C3.EntityType,this.$C3.FilterName,null);return!1},$81K:function(n,t,i){var r=n.match(this.$1JK);if(r&&r.length>0){this.$gW||(this.$gW=[]);Array.add(this.$gW,t)}},$8iX:function(n){return n?this.$C3.EntityType===3&&n.ExtractedAddresses||this.$C3.EntityType===7&&n.ExtractedContacts||this.$C3.EntityType===6&&n.ExtractedEmails||this.$C3.EntityType===1&&n.ExtractedMeetings||this.$C3.EntityType===5&&n.ExtractedPhones||this.$C3.EntityType===2&&n.ExtractedTasks||this.$C3.EntityType===4&&n.ExtractedUrls:!1}};_ex.$EW=function(n,t,i){_ex.$EW.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$C3=n;t.$3CA++}else this.$1cN("Invalid ItemHasRegularExpressionMatchRule rule.");this.$19=i};_ex.$EW.$5op=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$4F,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_ex.$EW.$9dF=function(n){for(var t=n.length-1;t>=0;t--){var r=!1;if(t>=50||n[t].length>3072)r=!0;else for(var i=t-1;i>=0;i--)if(n[t]===n[i]){r=!0;break}r&&Array.removeAt(n,t)}return n};_ex.$EW.$8Tl=function(n,t){if(t){if(n.get_$T6())return n.get_$T6().get_$1b()}else if(n.get_$Nh())return n.get_$Nh().get_$1b();else if(n.get_$4u())return n.get_$4u().get_$1b();_js.Trace.logWarning(_a.$0.$4F,"Skipping regex eval: no body for item with Id: {0}.",n.get_$x()?n.get_$x().Id:"'null id'");return null};_ex.$EW.prototype={$C3:null,$19:null,$53s:16e3,$3NN:64e3,$4pX:5e5,$2Mw:function(n,t,i){if(!_ex.$Be.$3PM(t))return!1;var r=null;var o=this.$8U9(n,t,i);if(o){var u;var e,f;if(!(f=_ex.$EW.$5op(this.$C3.RegExValue,this.$C3.IgnoreCase,e={val:u}),u=e.val,f))return!1;var s=_a.$7.get_$3A();r=o.match(u);t.$GQ.$5oN(this.$C3.RegExName,_a.$7.get_$3A().$6P(s));if(r&&r.length>0){r=_ex.$EW.$9dF(r);if(r.length>0){t.$1ao[this.$C3.RegExName]=r;return!0}}}t.$1ao[this.$C3.RegExName]=new Array(0);return!1},$8U9:function(n,t,i){if(this.$C3.PropertyName===1)return n.get_$3t();else if(this.$C3.PropertyName===4){var r=null;if(_g.$5v.isInstanceOfType(n))n.get_$Ew()&&(r=n.get_$Ew().Mailbox);else if(_g.$2r.isInstanceOfType(n)){var o=n.get_$JU();o&&(r=o.Mailbox)}if(r&&r.EmailAddress)return r.EmailAddress}else if(this.$C3.PropertyName===3){var s=null;n.get_$12G()===3&&(s=this.$4xl(n,t.$td));return s}else if(this.$C3.PropertyName===2){if(i.val)return i.val;var u=this.$4xl(n,t.$td);var c=_a.$7.get_$3A();var f=$(u);var e=_a.$7.get_$3A();f[0]&&(i.val=f[0].innerText);$B(i.val)&&(i.val=f.text());var h=_a.$7.get_$3A();t.$GQ.$A99(u?u.length:0,i.val?i.val.length:0,e.$6P(c),h.$6P(e));return i.val}return null},$4xl:function(n,t){var i=_ex.$EW.$8Tl(n,t);if(i){if(i.length>this.$4pX){_js.Trace.logInfo(_a.$0.$4F,"Body size exceeds general activation size limit");i=null}if(this.$19.get_$3Ob()||this.$19.get_$44W())if(this.$C3.PropertyName===2){if(i.length>this.$53s){_js.Trace.logInfo(_a.$0.$4F,"Body size exceeds IPhone/IPad activation size limit");i=null}}else if(this.$C3.PropertyName===3&&i.length>this.$3NN){_js.Trace.logInfo(_a.$0.$4F,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");i=i.substr(0,this.$3NN)}}return i}};_ex.$EX=function(n){_ex.$EX.initializeBase(this);this.$3MY=n.IncludeSubClasses;this.$jH=n.ItemType;this.$1Y3=n.FormType;$B(n.ItemClass)||(this.$tm=n.ItemClass.toLowerCase())};_ex.$EX.$56y=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_ex.$EX.$54B=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_ex.$EX.prototype={$tm:null,$3MY:!1,$jH:0,$1Y3:0,$2Mw:function(n,t,i){if(t.$pn===1&&(this.$1Y3===2||this.$1Y3===3)){if(!$B(n.get_$CO())){var r=n.get_$CO().toLowerCase();if(this.$jH===1&&_g.$5v.isInstanceOfType(n)&&_ex.$EX.$56y(r)||this.$jH===2&&_g.$2r.isInstanceOfType(n)&&_ex.$EX.$54B(r)){if(!this.$tm)return!0;if(this.$3MY){if(r.startsWith(this.$tm))return!0}else if(r===this.$tm)return!0}}}else if(t.$pn===2&&this.$jH===1||t.$pn===3&&this.$jH===2)return this.$1Y3===1||this.$1Y3===3;return!1}};_ex.$Hr=function(){this.$1vg=-1};_ex.$Hr.prototype={$2VV:0,$2VZ:null,$3iP:0,$9:0,get_$7jb:function(){return this.$9?Math.round(this.$3iP/this.$9):-1},$2T:function(n,t){this.$9++;this.$3iP+=n;if(n>=this.$2VV){this.$2VV=n;this.$2VZ=t}(this.$1vg===-1||n<this.$1vg)&&(this.$1vg=n)},$yp:function(){if(!this.$9)return"";var t=$B(this.$2VZ)?"":this.$2VZ;var n=[this.$1vg,this.get_$7jb(),this.$2VV,t];return n.join(",")}};_ex.$17z=function(n){_ex.$17z.initializeBase(this,[n])};_ex.$gh=function(n,t){this.$$d_$DeB=Function.createDelegate(this,this.$DeB);_ex.$gh.initializeBase(this,[n,t]);this.$Cf=!1;this.$9Q=!0;this.set_$2MD(!0)};_ex.$gh.prototype={$1Gf:null,$kq:!1,$2bE:!1,$9JI:function(){if(this.get_$22().get_$9()>0){this.$4ob();this.$1xm();this.$kq=!1}else{this.$1Gf.$4K();this.$kq=!0}},$3R:function(){_fce.$Y.prototype.$3R.call(this);this.get_$S().bind("keydown",this.$$d_$DeB)},$4z:function(){this.get_$S().unbind("keydown",this.$$d_$DeB);_js.$3.prototype.$4z.call(this)},$4R:function(){_fce.$Y.prototype.$4R.call(this);this.$1Gf=this.$t.$1F("GetMoreAppsButton")},$3BO:function(){var n=_fce.$Y.prototype.$3BO.call(this);if(this.$3J.get_$T()==="Mouse"){n.get_$4X().set_$ag(-1);n.get_$4X().set_$U5(3);var t=this;n.get_$S().keydown(function(i){if(i.which===13||i.which===32){t.$xI(n,new _a.$7Q(i));i.preventDefault()}})}return n},$xI:function(n,t){if(this.get_$2t()){var i=n.get_$k();t.get_$2n().extensionViewModel=i;this.set_$Cy(new _ff.$DH(t,3))}},$70y:function(n){if(!this.$2bE&&this.$kq){this.$kq=!1;this.$1Gf.set_$g(-1)}else this.$2bE=!1},$DeB:function(n){if(this.$kq||this.get_$VW()){var t=new _a.$7Q(n);var r=this.$IW(this.get_$VW());var i=this.get_$22().get_$D(r);if(this.$kq&&(t.get_$9t()===32||t.get_$9t()===13))this.$2bE=!0;else if(t.get_$9t()===40){if(!this.$kq){this.$6G5();if(this.get_$VW()===i){this.$1QZ(null);this.set_$VW(null);this.$1Gf.set_$g(0);this.$1Gf.$4K();this.$kq=!0}}}else if(t.get_$9t()===38)if(this.$kq){this.$4od();this.$1Gf.set_$g(-1);this.$kq=!1}else this.$6G7();else t.get_$9t()===9&&_js.$D.get_$P().$2W(_a.$0.$4F,"ComposeExtensibilityMenuListView",this.$$d_$7Cf,100)}}};_ex.$gi=function(n){this.$$d_$5Pj=Function.createDelegate(this,this.$5Pj);this.$$d_$9Ll=Function.createDelegate(this,this.$9Ll);this.$$d_$5PQ=Function.createDelegate(this,this.$5PQ);this.$$d_$9OE=Function.createDelegate(this,this.$9OE);_ex.$gi.initializeBase(this,[n]);this.$5N={}};_ex.$gi.prototype={$5N:null,$2hA:!1,$4R:function(){_js.$3.prototype.$4R.call(this);this.$5N.CloseButton=this.$t.$1F("CloseButton");this.$5N.ComposeExtMenuListView=this.$t.$1F("ComposeExtMenuListView");this.$5N.AppsBackButton=this.$t.$1F("AppsBackButton")},$3R:function(){_js.$3.prototype.$3R.call(this);this.get_$S().bind("keydown",this.$$d_$9OE);var n=this.get_$k();this.$n("DataContext",this.$$d_$5PQ);n&&this.$5PQ(null,null)},$4z:function(){var n=this.get_$k();this.get_$S().unbind("keydown",this.$$d_$9OE);this.$1B("DataContext",this.$$d_$5PQ);if(n&&this.$2hA){n.remove_$2YT(this.$$d_$9Ll);n.remove_$3Xv(this.$$d_$9Ll);n.remove_$2Ye(this.$$d_$5Pj);this.$2hA=!1}_js.$3.prototype.$4z.call(this)},$5PQ:function(n,t){var i=this.get_$k();i.add_$2YT(this.$$d_$9Ll);i.add_$3Xv(this.$$d_$9Ll);i.add_$2Ye(this.$$d_$5Pj);this.$2hA=!0},$9Ll:function(){this.$5N.ComposeExtMenuListView.$9JI()},$5Pj:function(){this.$5N.AppsBackButton.$4K()},$9OE:function(n){var t=new _a.$7Q(n);if(t.get_$9t()===27){var i=this.get_$k();i.$26x(!1);t.$P8()}}};_ex.$198=function(n){_ex.$198.initializeBase(this,[n])};_ex.$198.prototype={$8cJ:function(n){this.get_$S().hide();this.get_$S().prev().show()}};_ex.$3w=function(n,t){this.$$d_$9Oj=Function.createDelegate(this,this.$9Oj);this.$$d_$1a4=Function.createDelegate(this,this.$1a4);this.$$d_$8da=Function.createDelegate(this,this.$8da);_ex.$3w.initializeBase(this,[n,t]);this.$H=t;this.$Cf=!1;this.set_$2MD(!0)};_ex.$3w.prototype={$qs:0,$JG:null,$12Y:null,$3OO:!1,$9l:!1,$H:null,$2Tk:!1,set_$2Vd:function(n){if(this.$qs!==n){this.$qs=n;this.$4("MaxTabCount");n>0&&this.$5p0()}return n},set_$778:function(n){this.$12Y=n;this.$2Tk&&this.$12Y&&this.$5p0();return n},$1a4:function(){this.set_$2Vd(this.$4cc(this.$40P(!0)))},$3BO:function(){var n=_fce.$Y.prototype.$3BO.call(this);if(this.$3J.get_$T()==="Mouse"){n.get_$4X().set_$ag(0);n.get_$4X().set_$U5(3);var t=this;n.get_$S().keydown(function(i){(i.which===13||i.which===32)&&t.$xI(n,new _a.$7Q(i))})}return n},$3R:function(){_fce.$Y.prototype.$3R.call(this);_js.$D.get_$P().$2W(this.get_$p(),"ExtensibilityMenuListView - Trigger InternalOnActivate on delay",this.$$d_$8da,0)},$4z:function(){_js.$3.prototype.$4z.call(this);if(this.$9l&&"Mouse"===this.$3J.get_$T()){this.$H.remove_$Mb(this.$$d_$1a4);_g.$Q.get_$P().get_$6Y().remove_$24d(this.$$d_$9Oj);_g.$Q.get_$P().get_$6Y().remove_$3L0(this.$$d_$9Oj)}},$xI:function(n,t){if(this.get_$2t()){var i=n.get_$k();t.get_$2n().extensionViewModel=i;this.set_$Cy(new _ff.$DH(t,3))}},$4cc:function(n){if(!this.$JG)return 0;for(var r=this.$JG.get_$9(),e=-1,u=0,o=0,f=new Array(r),i=0;i<r;i++){f[i]=this.$5Cu(this.$JG.get_$D(i).$5c.DisplayName);this.$JG.get_$D(i)===this.get_$1G()&&(e=i)}if(e>-1){o+=f[e];u++}for(var t=0;t<r;){if(t!==e)if(o+f[t]<n){o+=f[t];u++}else break;t++}t<r&&o+46>=n&&u--;return u},$5Cu:function(n){if(!(n in _ex.$3w.$2Jj)){if(!_ex.$3w.$yi||$("#extensionRuler").length<=0){_ex.$3w.$yi=document.createElement("span");_ex.$3w.$yi.id="extensionRuler";_ex.$3w.$yi.className="extensionRuler ms-fwt-r";document.body.appendChild(_ex.$3w.$yi)}var t=document.createElement("span");t.className="extensionRulerItem";t.appendChild(document.createTextNode(n));_ex.$3w.$yi.appendChild(t);_ex.$3w.$2Jj[n]=_ex.$3w.$yi.offsetWidth;_ex.$3w.$yi.removeChild(t)}return _ex.$3w.$2Jj[n]},$40P:function(n){var r=this.$8TZ();var i=this.get_$S().width();if(i>0)_ex.$3w.$1EU=i;else if(!_ex.$3w.$1EU||n){var t=this;_ex.$3w.$1EU=i;while(!$B(t)&&!$B(t.get_$BS())&&!$B(t.get_$S())&&_ex.$3w.$1EU<=0){t=t.get_$BS();_ex.$3w.$1EU=t.get_$S().width()}}return _ex.$3w.$1EU-r},$8TZ:function(){return this.$3OO?0:this.$5Cu(_u.ExtStrings.l_ExtensibilityTabGetMoreApps_Text)+22},$9Oj:function(n,t){this.$1a4()},$8da:function(){if(this.get_$2t()){this.set_$2Vd(0);if("Mouse"===this.$3J.get_$T()){this.$H.add_$Mb(this.$$d_$1a4);_g.$Q.get_$P().get_$6Y().add_$24d(this.$$d_$9Oj);_g.$Q.get_$P().get_$6Y().add_$3L0(this.$$d_$9Oj)}this.set_$2Vd(this.$4cc(this.$40P(!1)));this.$9l=!0}},$5p0:function(){if(this.$12Y){this.$12Y.$11();this.$2Tk=!1}else this.$2Tk=!0}};_ex.$2=function(){};_ex.$2.get_$81E=function(){return _fm.$K.$I("error-fallback-app-icon","error-fallback-app-icon","owa","ms-bg-color-neutralTertiary ms-font-color-white")};_ex.$2.get_$7im=function(){return _fm.$K.$I("arrow-left-grey-circle-hover-ext","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_ex.$2.get_$zb=function(){return _fm.$K.$I("add-small-ext","add-small-ext","owa","ms-font-color-neutralSecondary")};_ex.$2.get_$sE=function(){return _fm.$K.$I("add-small-hover-ext","add-small-hover-ext","owa","ms-font-color-neutralDark")};_ex.$2.get_$5wB=function(){return _fm.$K.$I("affordance-grey-ext","x16","owa","ms-font-color-neutralSecondary")};_ex.$Bw=function(n,t){_ex.$Bw.initializeBase(this,[n]);this.$H=t};_ex.$Bw.prototype={$H:null,$3Nm:!1,$3Q5:!1,$176:null,$DU:null,$Hh:null,$l:null,$14T:null,set_$4Gw:function(n){if(n&&n!==this.$176){this.$176=n;this.$3ji()}return n},set_$C6:function(n){if(this.$Hh!==n){this.$Hh=n;this.$3ji()}return n},set_$1yG:function(n){if(this.$DU===n)return n;$B(n)&&this.$5Vk();this.$DU=n;this.$3ji();return n},$4kk:function(n,t,i,r,u,f,e,o,s){this.$176.displayNotification({infoType:n,id:t,title:i,description:r,buttonTxt:u,buttonCallback:f,detailView:e,displayDeactive:o,reDisplay:s})},$5Vk:function(){if(_ex.$Bw.$2Z6>0&&!$B(this.$176)&&this.$14T){this.$176.purgeOsfControl(this.$14T,!1);this.$14T=null}},$3ji:function(){if(!$B(this.$DU)&&!$B(this.$176)&&!$B(this.$Hh)&&!this.get_$13()){this.$5Vk();_ex.$Bw.$2Z6++;this.$14T="ocii"+_ex.$Bw.$2Z6;var a="DefaultSettings";var e=new OSF.Manifest.ExtensionSettings;e._sourceLocations[this.$Hh]=this.$DU.$1Ui;if(OSF.OsfManifestManager.hasManifest(this.$DU.$5c.Id,this.$DU.$5c.Version)){var w=OSF.OsfManifestManager.getCachedManifest(this.$DU.$5c.Id,this.$DU.$5c.Version);w._extensionSettings[a]=e}else{var v=this;var b=new OSF.Manifest.Manifest(function(n){n._id=v.$DU.$5c.Id;n._version=v.$DU.$5c.Version;n._extensionSettings={};n._extensionSettings[a]=e});OSF.OsfManifestManager.cacheManifest(this.$DU.$5c.Id,this.$DU.$5c.Version,b)}var n;if(this.$H.get_$T()==="TouchNarrow"){n=window.innerHeight-50;n<0&&(n=0)}else{n=this.$DU.$2lP;n<32?n=32:n>450&&(n=450)}this.$3Nm||this.get_$S().css("height",n.toString()+"px");this.$176.insertOsfControl({div:this.get_$S()[0],id:this.$14T,marketplaceID:this.$DU.$5c.Id,marketplaceVersion:this.$DU.$5c.Version,settings:this.$DU.get_$5hC(),store:"",storeType:OSF.StoreType.Exchange});if(_y.$12.$1M.get_$T()==="Mouse"){var p=this;_js.$D.get_$P().$6H(_a.$0.$4F,"OsfHostContainerView.TryInsertOsfControl",function(){p.get_$S().children()[0]&&p.get_$S().children()[0].focus()})}if(this.$DU.$5c.Origin===1||this.$DU.$5c.Origin===2&&this.$3Q5){var t=this;var y=function(){t.$l&&t.$l.$8G(t.$l.get_$Ip())&&t.$l.get_$Ip().get_$2MP().get_$2Uj()?t.$l.get_$Ip().$2Ui(t.$DU.get_$4mD()):window.open(t.$DU.get_$4mD())};if(_js.$A.$1k(this.$DU.get_$Xx()))this.$DU.get_$8oY()===1&&this.$4kk(2,this.$14T,_u.ExtStrings.l_AppInfoTitle_Text,_u.ExtStrings.l_AppTrialMessage_Text,_u.ExtStrings.l_AppBuyButton_Text,y,!1,!1,!0);else{var i;var u;var f;var r;var h,c,l,o,s;(s=this.$A9w(this.$DU.get_$Xx(),h={val:i},c={val:u},l={val:f},o={val:r}),i=h.val,u=c.val,f=l.val,r=o.val,s)&&this.$4kk(1,this.$14T,_u.ExtStrings.l_AppErrorTitle_Text,i,u,y,f,r,!0)}}}},$A9w:function(n,t,i,r,u){t.val="";i.val="";r.val=!1;u.val=!1;switch(n){case"1.0":t.val=_u.ExtStrings.l_AppErrorCode1_0_Text;i.val=_u.ExtStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.1":t.val=_u.ExtStrings.l_AppErrorCode1_1_Text;i.val=_u.ExtStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.2":t.val=_u.ExtStrings.l_AppErrorCode1_2_Text;i.val=_u.ExtStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"2.0":t.val=_u.ExtStrings.l_AppErrorCode2_0_Text;i.val=_u.ExtStrings.l_AppErrorCodeUpdateAction_Text;break;case"2.1":t.val=_u.ExtStrings.l_AppErrorCode2_1_Text;i.val=_u.ExtStrings.l_AppErrorCodeUpdateAction_Text;break;case"3.0":t.val=_u.ExtStrings.l_AppErrorCode3_0_Text;i.val=_u.ExtStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.1":t.val=_u.ExtStrings.l_AppErrorCode3_1_Text;i.val=_u.ExtStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.2":t.val=_u.ExtStrings.l_AppErrorCode3_2_Text;i.val=_u.ExtStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.3":t.val=_u.ExtStrings.l_AppErrorCode3_3_Text;i.val=_u.ExtStrings.l_AppErrorCodeDetailsAction_Text;break;default:_js.Trace.logWarning(this.get_$p(),String.format("The app status {0} does not have corresponding description.",n));return!1}return!0}};_ex._TI=function(){};_ex._TI.$$cctor=function(){var s="ComposeAppsPane";new _A(s,function(){_ex._TI.$2[s]===undefined&&(_ex._TI.$2[s]=[null]);var t=_ex._TI._hf.childNodes[0].cloneNode(!0);var n=new _ex.$gi(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$Ll,_ex.$17z,null,!1,!1,!1,0,_ex._TI.$2);var o="ComposeExtensibilityPopupView";new _A(o,function(){_ex._TI.$2[o]===undefined&&(_ex._TI.$2[o]=[[[-1,0,["ExtensibilityViewModel"],[_ex._TI.$D1U],null,"DataContext",null,_ex._TI.$X,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[1].cloneNode(!0);var n=new _js.$3(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$tT,_js.$3,function(n){return new _js.$3(n)},!1,!1,!1,0,_ex._TI.$2);var e="ComposeExtensibilityView._tid1";new _A(e,function(){_ex._TI.$2[e]===undefined&&(_ex._TI.$2[e]=[null,[[-1,4,null,null,null,"AriaLabel",null,_ex._TI.$2p,0,null,null,null,_u.ExtStrings.l_ComposeGetMoreApps_AT_Button_Text],[-1,4,null,null,null,"AriaRole",null,_ex._TI.$62,0,null,null,0,7],[-1,4,null,null,null,"Text",null,_ex._TI.$1Q,0,null,null,null,_u.ExtStrings.l_ComposeGetMoreApps_Text],[-1,0,["IsTouch"],[_ex._TI.$D1Y],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$99e],null,"ClickCommand",null,_ex._TI.$Y,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[2].cloneNode(!0);var n=new _fc.$E(_B.$3(t,[1,0]));n.set_$g(-1);var i=new _fce.$x(t.children[0]);return new _B(t,[i,n]).R({ListPanel:i,GetMoreAppsButton:n})},_ex.$Ll,_ex.$gh,function(n){return new _ex.$gh(n,_js.$1.Instance.$1(_y.$R))},!1,!0,!1,0,_ex._TI.$2);var l="ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3";new _A(l,function(){_ex._TI.$2[l]===undefined&&(_ex._TI.$2[l]=[null,[[-1,0,["DisplayName"],[_ex._TI.$6tg],null,"Text",null,_ex._TI.$E,1,null,null,null]],[[-1,0,["ProviderName"],[_ex._TI.$D1m],null,"Text",null,_ex._TI.$E,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[3].cloneNode(!0);var i=new _b.$Lv(n.children[2]);var r=new _b.$Lv(n.children[1]);var t=new _js.$3(n.children[0]);t.set_$6("ComposeExtensibilityView.ExtensionIconImage");return new _B(n,[t,r,i])},_ex.$7t,_js.$3,function(n){return new _js.$3(n)},!1,!0,!1,0,_ex._TI.$2);var c="ComposeExtensibilityView.ComposeExtensionListItemTemplate";new _A(c,function(){_ex._TI.$2[c]===undefined&&(_ex._TI.$2[c]=[[[-1,0,["DisplayName"],[_ex._TI.$6tg],null,"AriaLabel",null,_ex._TI.$1i,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[4].cloneNode(!0);var n=new _js.$3(t.children[0]);n.set_$6("ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3");return new _B(t,[n])},_ex.$7t,_fce.$1I,function(n){return new _fce.$1I(n)},!1,!1,!1,0,_ex._TI.$2);var h="ComposeExtensibilityView.ExtensionIconImage";new _A(h,function(){_ex._TI.$2[h]===undefined&&(_ex._TI.$2[h]=[[[-1,4,null,null,null,"Id",null,_ex._TI.$14,0,null,null,null,_ex.$2.get_$81E()]],[[-1,0,["IconUrl"],[_ex._TI.$D1l],null,"Source",null,_ex._TI.$Kk,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[5].cloneNode(!0);var i=new _ex.$198(n.children[1]);var t=new _fc.$a(n.children[0],_js.$1.Instance.$1(_ff.$B),_js.$1.Instance.$1(_ff.$G));return new _B(n,[t,i])},_ex.$7t,_js.$3,function(n){return new _js.$3(n)},!1,!1,!1,0,_ex._TI.$2);var i="ComposeExtensibilityView";new _A(i,function(){_ex._TI.$2[i]===undefined&&(_ex._TI.$2[i]=[[[-1,5,["SelectedExtension"],[_ex._TI.$4Bz],null,"_ex_s",null,null,0,_ex._TI.get_$2A(),null,null],[-1,5,["IsLandscape"],[_ex._TI.$5JZ],null,"_ex_p",null,null,0,null,null,null],[-1,5,["IsTouchNarrow"],[_ex._TI.$99Y],null,"tnarrow",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$62,0,null,null,0,3],[-1,4,null,null,null,"ImageId",null,_ex._TI.$u,0,null,null,null,_n.$2.get_$4x()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1Z,0,null,null,null,_n.$2.get_$Gg()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$4q,0,null,null,null,_n.$2.get_$1TZ()],[-1,4,null,null,null,"Title",null,_ex._TI.$1V,0,null,null,null,_u.ExtStrings.l_CloseAppPaneButton_Text],[-1,0,["IsTouchNarrow"],[_ex._TI.$99Y],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["HideAppPaneCommand"],[_ex._TI.$D1W],null,"ClickCommand",null,_ex._TI.$Y,1,null,null,null],[-1,5,["IsLandscape"],[_ex._TI.$5JZ],null,"_ex_q",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$62,0,null,null,0,3],[-1,4,null,null,null,"Title",null,_ex._TI.$1V,0,null,null,null,_u.ExtStrings.l_AppBackButton_Title_Button_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$u,0,null,null,null,_n.$2.get_$7il()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1Z,0,null,null,null,_ex.$2.get_$7im()],[-1,0,["BackToListCommand"],[_ex._TI.$99X],null,"ClickCommand",null,_ex._TI.$Y,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$4Bz],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$2A(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_ex._TI.$u,0,null,null,null,_b.$2.get_$4al()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$4q,0,null,null,null,_b.$2.get_$7ik()],[-1,0,["BackToListCommand"],[_ex._TI.$99X],null,"ClickCommand",null,_ex._TI.$Y,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$4Bz],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$2A(),null,!0]],[[-1,0,["AppPaneTitle"],[_ex._TI.$D1V],null,"Text",null,_ex._TI.$E,1,null,null,null]],[[-1,5,["IsLandscape"],[_ex._TI.$5JZ],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["HideExtensionsList"],[_ex._TI.$D1X],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["ActiveExtensions"],[_ex._TI.$99a],null,"DataSource",null,_ex._TI.$2o,1,null,null,null],[-1,0,["ListViewEventInfo"],[_ex._TI.$D1Z],_ex._TI.$D1a,"EventInfo",_ex._TI.$y0,_ex._TI.$y1,2,null,null,null]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6te],null,"OsfContextActivationManager",null,_ex._TI.$6th,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$99b],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6tf],null,"UserCulture",null,_ex._TI.$6tj,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$4Bz],null,"SelectedExtension",null,_ex._TI.$6ti,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$99c],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$99g,1,null,null,!1],[-1,5,["IsLandscape"],[_ex._TI.$5JZ],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$99f],null,"DataContext",null,_ex._TI.$X,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[6].cloneNode(!0);var s=new _b.$GY(_B.$3(n,[0,3]));var f=new _ex.$Bw(_B.$3(n,[0,2]),_js.$1.Instance.$1(_y.$R));f.$3Nm=!0;var t=new _ex.$gh(_B.$3(n,[0,1,0]),_js.$1.Instance.$1(_y.$R));t.set_$3X("ComposeExtensibilityView.ComposeExtensionListItemTemplate");t.set_$AG("_ex_o");t.set_$6("ComposeExtensibilityView._tid1");var h=new _js.$C(_B.$3(n,[0,1]));var c=new _b.$Lv(_B.$3(n,[0,0,3]));var o=new _fc.$E(_B.$3(n,[0,0,2]));var u=new _fc.$E(_B.$3(n,[0,0,1]));var r=new _fc.$E(_B.$3(n,[0,0,0]));r.set_$g(0);var e=new _js.$C(_B.$3(n,[0,0]));return new _B(n,[e,r,u,o,c,h,t,f,s]).R({CloseButton:r,AppsBackButton:u,ComposeExtMenuListView:t})},_ex.$Ll,_ex.$gi,function(n){return new _ex.$gi(n)},!1,!1,!1,0,_ex._TI.$2);var t="ExtensibilityPopupView";new _A(t,function(){_ex._TI.$2[t]===undefined&&(_ex._TI.$2[t]=[[[-1,0,["ExtensibilityViewModel","UserCulture"],[_ex._TI.$5Ja,_ex._TI.$6tf],null,"UserCulture",null,_ex._TI.$6tj,1,null,null,null],[-1,0,["ExtensibilityViewModel","OsfContextActivationManager"],[_ex._TI.$5Ja,_ex._TI.$6te],null,"OsfContextActivationManager",null,_ex._TI.$6th,1,null,null,null],[-1,0,["ExtensibilityViewModel","OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$5Ja,_ex._TI.$1vB,_ex._TI.$6td],null,"SelectedExtension",null,_ex._TI.$6ti,1,null,null,null]],[[-1,0,["ItemBodyValue"],[_ex._TI.$D1j],null,"Html",null,_ex._TI.$xj,1,null,null,null],[-1,2,["ExtensibilityViewModel","SelectedExtension","HighlightedTerms"],[_ex._TI.$5Ja,_ex._TI.$4Bz,_ex._TI.$1ih],null,_b.$21.$oj,null,null,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[7].cloneNode(!0);var i=new _b.$2y(n.children[1],_js.$1.Instance.$1(_ff.$B),_js.$1.Instance.$1(_a.$AM.$$(ILinkPreviewBuilderFactory)));i.$R(_b.$21.$gt,"extensionHighlight");var r=new _ex.$Bw(n.children[0],_js.$1.Instance.$1(_y.$R));return new _B(n,[r,i])},_ex.$OH,_js.$3,function(n){return new _js.$3(n)},!1,!1,!1,0,_ex._TI.$2);var n="ExtensibilityView._tid4";new _A(n,function(){_ex._TI.$2[n]===undefined&&(_ex._TI.$2[n]=[[[-1,4,null,null,null,"Text",null,_ex._TI.$1Q,0,null,null,null,_u.ExtStrings.l_ExtensibilityTabGetMoreApps_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$u,0,null,null,null,_ex.$2.get_$zb()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1Z,0,null,null,null,_ex.$2.get_$sE()],[-1,0,["MarketplaceUrl"],[_ex._TI.$99d],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$2i(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$99e],null,"ClickCommand",null,_ex._TI.$Y,1,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_ex._TI.$u,0,null,null,null,_ex.$2.get_$5wB()],[-1,0,["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1vB,_ex._TI.$99Z],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0]]]);var t=_ex._TI._hf.childNodes[8].cloneNode(!0);var u=new _fc.$E(t.children[2]);var i=new _fce.$1L(_js.$1.Instance.$1(_fc.$h),_js.$1.Instance.$1(_ff.$J),_js.$1.Instance.$1(_ff.$B),_js.$1.Instance.$1(_ff.$G));i.$M(_E.$C(["OverflowMenuViewModel","ExtensionsContextMenuViewModel"],[_ex._TI.$1vB,_ex._TI.$D1b],null,"MenuDataContext",null,_ex._TI.$3s,1)).$M(_E.$C(["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1vB,_ex._TI.$99Z],null,"IsShown",null,_ex._TI.$3k,1,_ex._TI.get_$K(),null,!1));i.$55=3;u.set_$10([i]);var r=new _fce.$x(t.children[1]);var f=new _fc.$E(t.children[0]);return new _B(t,[f,r,u]).R({ListPanel:r})},_ex.$105,_ex.$3w,function(n){return new _ex.$3w(n,_js.$1.Instance.$1(_y.$R))},!1,!0,!1,0,_ex._TI.$2);var f="ExtensibilityView.ExtensionListItemTemplate._tid7";new _A(f,function(){_ex._TI.$2[f]===undefined&&(_ex._TI.$2[f]=[[[-1,0,["DisplayName"],[_ex._TI.$6tg],null,"Text",null,_ex._TI.$E,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.$9(n.children[0]);return new _B(n,[t])},_ex.$7t,_js.$3,function(n){return new _js.$3(n)},!1,!0,!1,0,_ex._TI.$2);var u="ExtensibilityView.ExtensionListItemTemplate";new _A(u,function(){_ex._TI.$2[u]===undefined&&(_ex._TI.$2[u]=[[[-1,5,["IsSelected"],[_ex._TI.$OH],null,"ms-font-color-white ms-bg-color-themeSecondary",null,null,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[10].cloneNode(!0);var n=new _js.$3(t.children[0]);n.set_$6("ExtensibilityView.ExtensionListItemTemplate._tid7");return new _B(t,[n])},_ex.$7t,_fce.$1I,function(n){return new _fce.$1I(n)},!1,!1,!1,0,_ex._TI.$2);var r="ExtensibilityView";new _A(r,function(){_ex._TI.$2[r]===undefined&&(_ex._TI.$2[r]=[[[-1,0,["OverflowMenuViewModel","ExtensionsTabList"],[_ex._TI.$1vB,_ex._TI.$D1c],null,"DataSource",null,_ex._TI.$2o,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1vB,_ex._TI.$6td],_ex._TI.$D1i,"SelectedItem",_ex._TI.$6D,_ex._TI.$6A,2,null,null,null],[-1,0,["OverflowMenuViewModel","MaxTabCount"],[_ex._TI.$1vB,_ex._TI.$D1e],_ex._TI.$D1h,"MaxTabCount",_ex._TI.$D1n,_ex._TI.$D1q,2,null,null,0],[-1,0,["ActiveExtensions"],[_ex._TI.$99a],null,"ActiveExtensions",null,_ex._TI.$D1o,1,null,null,null],[-1,0,["OverflowMenuViewModel","PopulateMenuItemsCommand"],[_ex._TI.$1vB,_ex._TI.$D1f],null,"PopulateMenuItemsCommand",null,_ex._TI.$D1r,1,null,null,null],[-1,0,["OverflowMenuViewModel","ListViewEventInfo"],[_ex._TI.$1vB,_ex._TI.$D1d],_ex._TI.$D1g,"EventInfo",_ex._TI.$y0,_ex._TI.$y1,2,null,null,null],[-1,0,["MarketplaceUrl"],[_ex._TI.$99d],null,"IsGetMoreAppHidden",null,_ex._TI.$D1p,1,_ex._TI.get_$2i(),null,!1]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6te],null,"OsfContextActivationManager",null,_ex._TI.$6th,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$99b],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6tf],null,"UserCulture",null,_ex._TI.$6tj,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1vB,_ex._TI.$6td],null,"SelectedExtension",null,_ex._TI.$6ti,1,null,null,null],[-1,0,["NativeBridge"],[_ex._TI.$D1k],null,"NativeBridge",null,_ex._TI.$D1s,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$99c],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$99g,1,null,null,!1]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$99f],null,"DataContext",null,_ex._TI.$X,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[11].cloneNode(!0);var i=new _b.$GY(_B.$3(t,[0,2]));var u=new _ex.$Bw(_B.$3(t,[0,1]),_js.$1.Instance.$1(_y.$R));var n=new _ex.$3w(_B.$3(t,[0,0,0]),_js.$1.Instance.$1(_y.$R));n.set_$3X("ExtensibilityView.ExtensionListItemTemplate");n.set_$AG("_ex_x");n.set_$6("ExtensibilityView._tid4");return new _B(t,[n,u,i])},_ex.$105,_js.$3,function(n){return new _js.$3(n)},!1,!1,!1,0,_ex._TI.$2)};_ex._TI.$9P=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div autoid=\"_ex_0\" class='_ex_2 _ex_3'></div> </div><div> <div autoid=\"_ex_1\" class='_ex_4'></div> </div><div> <div></div> <div class='_ex_l'> <button autoid=\"_ex_7\" type='button' class='_ex_m ms-font-weight-regular'></button> </div> </div><div> <div class='_ex_8'></div> <div autoid=\"_ex_9\" class='_ex_j ms-fwt-sb _ex_5'></div> <div autoid=\"_ex_a\" class='_ex_k ms-font-weight-regular _ex_5'></div> <div style=\"clear:both;\"></div> </div><div> <div autoid=\"_ex_8\" class='_ex_i'></div> </div><div> <span class='_ex_9'></span> <img autoid=\"_ex_b\" class='_ex_a'/> </div><div> <div class='_ex_e'> <div class='_ex_g'> <button autoid=\"_ex_2\" type='button' class='_ex_f'></button>  <button autoid=\"_ex_3\" type='button' class='_ex_6'></button>  <button autoid=\"_ex_4\" type='button' class='_ex_7'></button> <div autoid=\"_ex_5\" class='_ex_h ms-fwt-sl _ex_5'></div> <div style=\"clear:both;\"></div> </div> <div class='_ex_b'> <div autoid=\"_ex_6\" class='_ex_n'></div> </div> <div class='_ex_c'></div> <div class='hidden'> </div> </div>   </div><div> <div class='_ex_t ms-border-color-themeSecondary'></div> <div class='_ex_u ms-bg-color-white'></div> </div><div> <button autoid=\"_ex_d\" type='button' class='_ex_B ms-fwt-r'></button> <div class='_ex_x'></div> <button type='button' class='_ex_A ms-font-s ms-font-color-themePrimary'></button> </div><div> <span autoid=\"_ex_f\"></span> </div><div> <div autoid=\"_ex_e\" class='_ex_w ms-font-s ms-font-color-themePrimary'></div> </div><div> <div class='_ex_v'> <div class='_ex_y ms-bg-color-neutralLight'> <div autoid=\"_ex_c\"></div> </div> <div class='_ex_z ms-border-color-themeSecondary'></div> <div class='hidden'> </div> </div>  </div>";_js.$C.get_$98().appendChild(n);return n};_ex._TI.$D1U=function(n){return n.$5q};_ex._TI.$D1Y=function(n){return n.get_$3Pz()};_ex._TI.$99e=function(n){return n.$3Yl};_ex._TI.$6tg=function(n){return n.get_$27()};_ex._TI.$D1m=function(n){return n.get_$9a4()};_ex._TI.$D1l=function(n){return n.get_$8c5()};_ex._TI.$4Bz=function(n){return n.$DU};_ex._TI.$5JZ=function(n){return n.get_$15z()};_ex._TI.$99Y=function(n){return n.get_$6gq()};_ex._TI.$D1W=function(n){return n.$3Lz};_ex._TI.$99X=function(n){return n.$38R};_ex._TI.$D1V=function(n){return n.$2Ih};_ex._TI.$D1X=function(n){return n.$2RZ};_ex._TI.$99a=function(n){return n.$JG};_ex._TI.$D1Z=function(n){return n.$16A};_ex._TI.$y0=function(n){return n.get_$Cy()};_ex._TI.$6te=function(n){return n.$1eo};_ex._TI.$99b=function(n){return n.$1X5};_ex._TI.$6tf=function(n){return n.$Hh};_ex._TI.$99c=function(n){return n.get_$8jR()};_ex._TI.$99f=function(n){return n.$VU};_ex._TI.$5Ja=function(n){return n.$5q};_ex._TI.$1vB=function(n){return n.$fQ};_ex._TI.$6td=function(n){return n.$1Kj};_ex._TI.$D1j=function(n){return n.$3QK};_ex._TI.$1ih=function(n){return n.get_$1s2()};_ex._TI.$99d=function(n){return n.$1YQ};_ex._TI.$99Z=function(n){return n.$2RY};_ex._TI.$D1b=function(n){return n.$1Ma};_ex._TI.$OH=function(n){return n.get_$2j()};_ex._TI.$D1c=function(n){return n.$sp};_ex._TI.$6D=function(n){return n.get_$1G()};_ex._TI.$D1e=function(n){return n.$qs};_ex._TI.$D1n=function(n){return n.$qs};_ex._TI.$D1f=function(n){return n.$12Y};_ex._TI.$D1d=function(n){return n.$16A};_ex._TI.$D1k=function(n){return n.$l};_ex._TI.$X=function(n,t){n.set_$k(t)};_ex._TI.$8=function(n,t){n.set_$13(t)};_ex._TI.$Y=function(n,t){n.set_$4k(t)};_ex._TI.$2p=function(n,t){n.set_$4V(t)};_ex._TI.$62=function(n,t){n.set_$15(t)};_ex._TI.$1Q=function(n,t){n.set_$1O(t)};_ex._TI.$E=function(n,t){n.set_$1O(t)};_ex._TI.$1i=function(n,t){n.set_$4V(t)};_ex._TI.$14=function(n,t){n.set_$2N(t)};_ex._TI.$Kk=function(n,t){n.set_$Bo(t)};_ex._TI.$u=function(n,t){n.set_$BE(t)};_ex._TI.$1Z=function(n,t){n.set_$FB(t)};_ex._TI.$4q=function(n,t){n.set_$WG(t)};_ex._TI.$1V=function(n,t){n.set_$41(t)};_ex._TI.$2o=function(n,t){n.set_$22(t)};_ex._TI.$D1a=function(n,t){n.set_$5BD(t)};_ex._TI.$y1=function(n,t){n.set_$Cy(t)};_ex._TI.$6th=function(n,t){n.set_$4Gw(t)};_ex._TI.$6tj=function(n,t){n.set_$C6(t)};_ex._TI.$6ti=function(n,t){n.set_$1yG(t)};_ex._TI.$99g=function(n,t){n.$3Q5=t};_ex._TI.$xj=function(n,t){n.set_$Rg(t)};_ex._TI.$3s=function(n,t){n.set_$Kg(t)};_ex._TI.$3k=function(n,t){n.set_$1A(t)};_ex._TI.$D1i=function(n,t){n.set_$2fL(t)};_ex._TI.$6A=function(n,t){n.set_$1G(t)};_ex._TI.$D1h=function(n,t){n.$qs=t};_ex._TI.$D1q=function(n,t){n.set_$2Vd(t)};_ex._TI.$D1o=function(n,t){n.$JG=t};_ex._TI.$D1r=function(n,t){n.set_$778(t)};_ex._TI.$D1g=function(n,t){n.set_$5BD(t)};_ex._TI.$D1p=function(n,t){n.$3OO=t};_ex._TI.$D1s=function(n,t){n.$l=t};_ex._TI.get_$2A=function(){_ex._TI.$4P||(_ex._TI.$4P=new _fc.$6o);return _ex._TI.$4P};_ex._TI.get_$K=function(){_ex._TI.$2H||(_ex._TI.$2H=new _fc.$49);return _ex._TI.$2H};_ex._TI.get_$2i=function(){_ex._TI.$4s||(_ex._TI.$4s=new _fc.$7E);return _ex._TI.$4s};ExtensibilityComponent.registerClass("ExtensibilityComponent",null,_a.$1e2);_ex.$uA.registerClass("_ex.$uA",_h.$1HF.$$(_g.$RS));_ex.$uM.registerClass("_ex.$uM",_h.$fu.$$(_g.$Rj,_g.$iX));_ex.$uP.registerClass("_ex.$uP",_h.$fu.$$(_g.$M5,_g.$Sx));_ex.$4b.registerClass("_ex.$4b",_h.$1HF.$$(_g.$Ly));_ex.$iz.registerClass("_ex.$iz",_h.$fu.$$(_g.$Rj,_g.$iX));_ex.$k8.registerClass("_ex.$k8",_h.$1HF.$$(_g.$T6));_ex.$1Ey.registerClass("_ex.$1Ey",_h.$1HF.$$(String));_ex.$x1.registerClass("_ex.$x1",_h.$1HF.$$(_g.$UC));_ex.$x2.registerClass("_ex.$x2",_h.$1HF.$$(_g.$UE));_ex.$5X.registerClass("_ex.$5X");_ex.$5X.$3oj.registerClass("_ex.$5X.$3oj");_ex.$hx.registerClass("_ex.$hx");_ex.$195.registerClass("_ex.$195",null,_ex.$1dG);_ex.$6Q.registerClass("_ex.$6Q",null,_ex.$1dG);_ex.$1gT.registerClass("_ex.$1gT");_ex.$sS.registerClass("_ex.$sS",_ex.$1gT);_ex.$16D.registerClass("_ex.$16D",_ex.$sS);_ex.$16E.registerClass("_ex.$16E",_ex.$sS);_ex.$sX.registerClass("_ex.$sX",_ex.$1gT);_ex.$1hG.registerClass("_ex.$1hG",_ex.$1gT);_ex.$179.registerClass("_ex.$179",_ex.$1hG);_ex.$17A.registerClass("_ex.$17A",_ex.$1hG);_ex.$1gS.registerClass("_ex.$1gS");_ex.$1Z.registerClass("_ex.$1Z");_ex.$1hM.registerClass("_ex.$1hM",_ex.$1Z);_ex.$193.registerClass("_ex.$193",_ex.$1hM);_ex.$4M.registerClass("_ex.$4M",_ex.$1Z);_ex.$194.registerClass("_ex.$194",_ex.$4M);_ex.$hz.registerClass("_ex.$hz");_ex.$199.registerClass("_ex.$199",_ex.$1hM);_ex.$19A.registerClass("_ex.$19A",_ex.$4M);_ex.$19U.registerClass("_ex.$19U",_ex.$1gT);_ex.$19e.registerClass("_ex.$19e",_ex.$1gT);_ex.$iy.registerClass("_ex.$iy",_ex.$1gT);_ex.$19s.registerClass("_ex.$19s",_ex.$1gT);_ex.$19q.registerClass("_ex.$19q",_ex.$1gT);_ex.$19v.registerClass("_ex.$19v",_ex.$1gT);_ex.$1C1.registerClass("_ex.$1C1",_ex.$1gT);_ex.$1Ej.registerClass("_ex.$1Ej",_ex.$1gT);_ex.$Mx.registerClass("_ex.$Mx",_ex.$1gT);_ex.$1FV.registerClass("_ex.$1FV",_ex.$1gT);_ex.$1Fd.registerClass("_ex.$1Fd",_ex.$1gT);_ex.$1Fc.registerClass("_ex.$1Fc",_ex.$1hG);_ex.$1Ff.registerClass("_ex.$1Ff",_ex.$1gT);_ex.$2I.registerClass("_ex.$2I");_ex.$1Gy.registerClass("_ex.$1Gy",null,_y.$vE,_a.$1QG);_ex.$tT.registerClass("_ex.$tT",_y.$1i2,_bc.$ML,_bc.$qY,_bc.$ui,_a.$1f3,_js.$1BC,Sys.IDisposable,_y.$10x);_ex.$2G.registerClass("_ex.$2G",_a.$Ew,_y.$1QF,_a.$1f3,_js.$1BC,Sys.IDisposable);_ex.$Ll.registerClass("_ex.$Ll",_ex.$2G,_y.$1bL,_y.$1QF,_a.$1f3,_js.$1BC,Sys.IDisposable);_ex.$196.registerClass("_ex.$196",_a.$AI);_ex.$Fr.registerClass("_ex.$Fr");_ex.$Bm.registerClass("_ex.$Bm",_a.$Ew);_ex.$OH.registerClass("_ex.$OH",_y.$1i2,_bc.$ML,_bc.$qY,_bc.$ui,_a.$1f3,_js.$1BC,Sys.IDisposable,_y.$10x);_ex.$uB.registerClass("_ex.$uB");_ex.$19B.registerClass("_ex.$19B",null,IExtensibilityStatistics);_ex.$19B.$4XZ.registerClass("_ex.$19B.$4XZ");_ex.$19B.$7kM.registerClass("_ex.$19B.$7kM");_ex.$19B.$4nZ.registerClass("_ex.$19B.$4nZ");_ex.$19B.$82T.registerClass("_ex.$19B.$82T");_ex.$19C.registerClass("_ex.$19C",null,_y.$1dQ);_ex.$105.registerClass("_ex.$105",_ex.$2G);_ex.$106.registerClass("_ex.$106",null,IExtensibilityViewModelFactory);_ex.$19D.registerClass("_ex.$19D",_a.$AI);_ex.$q1.registerClass("_ex.$q1",_js.$DE);_ex.$7t.registerClass("_ex.$7t",_a.$Ew,_y.$1bI);_ex.$1Et.registerClass("_ex.$1Et",_ex.$19C);_ex.$Be.registerClass("_ex.$Be");_ex.$17u.registerClass("_ex.$17u",_ex.$Be);_ex.$u7.registerClass("_ex.$u7");_ex.$3x.registerClass("_ex.$3x");_ex.$1Bg.registerClass("_ex.$1Bg",_ex.$Be);_ex.$3y.registerClass("_ex.$3y",_ex.$Be);_ex.$EW.registerClass("_ex.$EW",_ex.$Be);_ex.$EX.registerClass("_ex.$EX",_ex.$Be);_ex.$Hr.registerClass("_ex.$Hr");_ex.$17z.registerClass("_ex.$17z",_js.$C);_ex.$gh.registerClass("_ex.$gh",_fce.$Y);_ex.$gi.registerClass("_ex.$gi",_js.$3);_ex.$198.registerClass("_ex.$198",_b.$Lz);_ex.$3w.registerClass("_ex.$3w",_fce.$Y);_ex.$2.registerClass("_ex.$2");_ex.$Bw.registerClass("_ex.$Bw",_js.$C);_ex._TI.registerClass("_ex._TI");ExtensibilityComponent.$$cctor();_ex.$4b.$gT=null;_ex.$4b.$2Ub=0;_ex.$5X.$1M=null;_ex.$6Q.$2Y9=null;_ex.$6Q.$1wB=null;_ex.$1Z.$1VJ={wasSuccessful:!1};_ex.$1Z.$20z=new RegExp(" ","g");_ex.$1Z.$2J5=null;_ex.$1Z.$2J6=null;_ex.$1Z.$2J9=null;_ex.$1Z.$2J7=null;_ex.$Mx.$4iR={wasSuccessful:!0};_ex.$Fr.$Ll={};_ex.$Bm.$50y="HideExtensionContextMenu";_ex.$Bm.$3ih="TabSelectedExtension";_ex.$2G.$8be="HighlightedTerms";_ex.$2G.$82J="ExtensionBecomeActiveTestOnly";_ex.$2G.$4Er="NoActiveExtensions";_ex.$2G.$48B="MarketplaceUrl";_ex.$2G.$5Po="OnGetExtensibilityContextCompleted";_ex.$2G.$8b6="HideExtensionContainer";_ex.$2G.$7dL="ActiveExtensionsCount";_ex.$2G.$2T4=!1;_ex.$2G.$15Q=null;_ex.$7t.$52F=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_ex.$3w.$1EU=0;_ex.$3w.$2Jj={};_ex.$3w.$yi=null;_ex.$Bw.$2Z6=0;_ex._TI._hf=_ex._TI.$9P();_ex._TI.$4P=null;_ex._TI.$2H=null;_ex._TI.$4s=null;_ex._TI.$2={};_ex._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.extensibility.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
